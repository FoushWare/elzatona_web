{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/apps/website/src/app/custom-roadmap/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\n\nimport { useRouter } from 'next/navigation';\n\n// import { SignInPopup } from '@elzatona/shared-components'; // Temporarily disabled due to import issues\nimport { useAuth, useUserType } from '@elzatona/shared-contexts';\nimport { useLearningType } from '../../context/LearningTypeContext';\nimport {\n  Plus,\n  Minus,\n  Check,\n  Target,\n  Save,\n  Loader2,\n  AlertCircle,\n  CheckCircle,\n  ChevronDown,\n  ChevronRight,\n  Eye,\n  X,\n  PanelRightOpen,\n  PanelRightClose,\n  Clock,\n  Zap,\n  BookOpen,\n} from 'lucide-react';\n\ninterface Topic {\n  id: string;\n  name: string;\n  description?: string;\n  questions: Question[];\n  isSelected: boolean;\n  selectedQuestions: string[];\n}\n\ninterface Category {\n  id: string;\n  name: string;\n  description?: string;\n  topics: Topic[];\n  isSelected: boolean;\n  selectedTopics: Set<string>;\n}\n\ninterface Card {\n  id: string;\n  title: string;\n  type: string;\n  description?: string;\n  categories: Category[];\n  isSelected: boolean;\n  selectedCategories: Set<string>;\n}\n\ninterface Question {\n  id: string;\n  title: string;\n  difficulty: 'Easy' | 'Medium' | 'Hard';\n  estimatedTime: string | null;\n  points: number;\n}\n\n// Legacy Section interface for backward compatibility with existing code\ninterface Section {\n  id: string;\n  name: string;\n  description: string;\n  category: string;\n  questions: Question[];\n  isSelected: boolean;\n  selectedQuestions: string[];\n}\n\ninterface CustomPlan {\n  id: string;\n  name: string;\n  description: string;\n  duration: number;\n  sections: Section[];\n  totalQuestions: number;\n  dailyQuestions: number;\n  created_at: Date;\n}\n\nexport default function CustomRoadmapPage() {\n  const router = useRouter();\n  const {\n    isAuthenticated: authIsAuthenticated,\n    user,\n    isLoading: authIsLoading,\n  } = useAuth();\n  const { setUserType } = useUserType();\n  const { setLearningType } = useLearningType();\n\n  // Enhanced authentication check - check multiple sources\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [authCheckComplete, setAuthCheckComplete] = useState(false);\n\n  // Check authentication from multiple sources (similar to guided-learning page)\n  useEffect(() => {\n    let authCheckDone = false;\n\n    const checkAuth = () => {\n      if (authCheckDone) return;\n\n      // Check AuthContext first\n      if (authIsAuthenticated && user) {\n        console.log('âœ… [CustomRoadmap] Authenticated via AuthContext');\n        setIsAuthenticated(true);\n        setAuthCheckComplete(true);\n        authCheckDone = true;\n        return;\n      }\n\n      // Check localStorage and sessionStorage for various auth indicators\n      if (typeof window !== 'undefined') {\n        // Check for auth token in localStorage\n        const authToken = localStorage.getItem('auth-token');\n        const frontendUser = localStorage.getItem('frontend-koddev-user');\n\n        if (authToken || frontendUser) {\n          console.log(\n            'âœ… [CustomRoadmap] Authenticated via localStorage (token or user data found)'\n          );\n          setIsAuthenticated(true);\n          setAuthCheckComplete(true);\n          authCheckDone = true;\n          return;\n        }\n\n        // Check sessionStorage for isAuthenticated (could be string or JSON object)\n        try {\n          const commonAuthKeys = [\n            'navbar-auth-state',\n            'auth',\n            'auth-state',\n            'authentication',\n            'isAuthenticated',\n            'authStatus',\n            'authState',\n            'user-auth',\n            'session-auth',\n          ];\n\n          for (const key of commonAuthKeys) {\n            const value = sessionStorage.getItem(key);\n            if (value) {\n              try {\n                const parsed = JSON.parse(value);\n                if (\n                  parsed &&\n                  typeof parsed === 'object' &&\n                  parsed.isAuthenticated === true\n                ) {\n                  console.log(\n                    `âœ… [CustomRoadmap] Authenticated via sessionStorage (${key} with isAuthenticated=true)`\n                  );\n                  setIsAuthenticated(true);\n                  setAuthCheckComplete(true);\n                  authCheckDone = true;\n                  return;\n                }\n              } catch {\n                // Not JSON, check if it's the string \"true\"\n                if (value === 'true') {\n                  console.log(\n                    `âœ… [CustomRoadmap] Authenticated via sessionStorage (${key}=true string)`\n                  );\n                  setIsAuthenticated(true);\n                  setAuthCheckComplete(true);\n                  authCheckDone = true;\n                  return;\n                }\n              }\n            }\n          }\n        } catch (e) {\n          console.warn('Error checking sessionStorage:', e);\n        }\n      }\n\n      // If we've waited for auth to load and still no authentication found\n      if (!authIsLoading) {\n        console.log(\n          'âŒ [CustomRoadmap] No authentication found after checking all sources'\n        );\n        setIsAuthenticated(false);\n        setAuthCheckComplete(true);\n        authCheckDone = true;\n      } else {\n        // If auth is still loading, we haven't found auth yet, but we should still mark check as attempting\n        // This prevents the page from redirecting prematurely\n        console.log(\n          'â³ [CustomRoadmap] Auth context still loading, waiting...'\n        );\n      }\n    };\n\n    checkAuth();\n\n    // Safety timeout: if auth check takes too long, mark as complete anyway (prevents infinite loading)\n    const safetyTimeout = setTimeout(() => {\n      if (!authCheckDone) {\n        console.warn(\n          'â° [CustomRoadmap] Auth check timeout - marking as complete to prevent infinite loading'\n        );\n        setAuthCheckComplete(true);\n        authCheckDone = true;\n      }\n    }, 5000); // 5 second timeout\n\n    // Listen for storage changes (e.g., when user logs in/out in another tab)\n    const handleStorageChange = (e: StorageEvent) => {\n      if (\n        e.key === 'auth-token' ||\n        e.key === 'frontend-koddev-user' ||\n        e.key === 'isAuthenticated' ||\n        e.key === 'navbar-auth-state'\n      ) {\n        console.log(\n          'ðŸ”„ [CustomRoadmap] Storage changed, rechecking auth:',\n          e.key\n        );\n        checkAuth();\n      }\n    };\n\n    window.addEventListener('storage', handleStorageChange);\n\n    // Also listen for custom events (for same-tab auth changes)\n    const handleAuthStateChange = () => {\n      console.log(\n        'ðŸ”„ [CustomRoadmap] Auth state changed event received, rechecking auth'\n      );\n      checkAuth();\n    };\n\n    window.addEventListener('auth-state-changed', handleAuthStateChange);\n\n    return () => {\n      clearTimeout(safetyTimeout);\n      window.removeEventListener('storage', handleStorageChange);\n      window.removeEventListener('auth-state-changed', handleAuthStateChange);\n    };\n  }, [authIsAuthenticated, user, authIsLoading, authCheckComplete]);\n\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSaving, setIsSaving] = useState(false);\n  const [currentStep, setCurrentStep] = useState(1);\n  const [planName, setPlanName] = useState('');\n  const [planDescription, setPlanDescription] = useState('');\n  const [duration, setDuration] = useState(7);\n  const [cards, setCards] = useState<Card[]>([]);\n  const [selectedCards, setSelectedCards] = useState<Set<string>>(new Set());\n  // Legacy sections state for backward compatibility\n  const [sections, setSections] = useState<Section[]>([]);\n  const [selectedSections, setSelectedSections] = useState<Set<string>>(\n    new Set()\n  );\n  const [expandedCard, setExpandedCard] = useState<string | null>(null);\n  const [expandedCategory, setExpandedCategory] = useState<string | null>(null);\n  const [expandedTopic, setExpandedTopic] = useState<string | null>(null);\n  const [hasCheckedAuth, setHasCheckedAuth] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const hasTriedLoadForStep2 = useRef(false); // Track if we've tried loading for step 2\n\n  // Modal state for question details\n  interface QuestionDetails {\n    id: string;\n    question_text?: string;\n    question?: string;\n    title?: string;\n    difficulty?: string;\n    question_type?: string;\n    type?: string;\n    estimated_time?: string;\n    points?: number;\n    point_value?: number;\n    options?: string[];\n    correct_answer?: string;\n    correctAnswer?: string;\n    explanation?: string;\n    tags?: string[];\n    [key: string]: unknown; // Allow additional fields from API\n  }\n\n  const [selectedQuestionId, setSelectedQuestionId] = useState<string | null>(\n    null\n  );\n  const [questionDetails, setQuestionDetails] =\n    useState<QuestionDetails | null>(null);\n  const [isLoadingQuestionDetails, setIsLoadingQuestionDetails] =\n    useState(false);\n  const [isSummaryVisible, setIsSummaryVisible] = useState(true); // Start with summary open\n\n  const loadSections = useCallback(async () => {\n    console.log('ðŸ“¦ [loadSections] ==========================================');\n    console.log('ðŸ“¦ [loadSections] START - Function called!');\n    console.log('ðŸ“¦ [loadSections] Setting isLoading to true');\n    setIsLoading(true);\n    setError(null); // Clear any previous errors\n\n    // Safety timeout: ALWAYS stop loading after 10 seconds\n    const timeoutId = setTimeout(() => {\n      console.warn('â° [TIMEOUT] Forcing isLoading to false after 10 seconds');\n      setIsLoading(false);\n      setError('Loading timeout. Please try again.');\n    }, 10000);\n\n    try {\n      // Step 1: Fetch predefined cards\n      console.log(\n        'ðŸ“¡ [loadSections] =========================================='\n      );\n      console.log(\n        'ðŸ“¡ [loadSections] About to make fetch request to /api/cards...'\n      );\n      console.log('ðŸ“¡ [loadSections] Making fetch request NOW...');\n      console.log(\n        'ðŸ“¡ [loadSections] URL:',\n        window.location.origin + '/api/cards'\n      );\n      console.log(\n        'ðŸ“¡ [loadSections] Current window location:',\n        window.location.href\n      );\n\n      // Force the fetch to execute immediately - use absolute URL to ensure it works\n      const cardsUrl = `${window.location.origin}/api/cards`;\n      console.log('ðŸ“¡ [loadSections] Full URL:', cardsUrl);\n      console.log('ðŸ“¡ [loadSections] Calling fetch() NOW...');\n\n      const fetchPromise = fetch(cardsUrl, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        cache: 'no-store', // Ensure fresh request\n      });\n\n      console.log('ðŸ“¡ [loadSections] Fetch promise created:', fetchPromise);\n      console.log('ðŸ“¡ [loadSections] Fetch promise type:', typeof fetchPromise);\n      console.log(\n        'ðŸ“¡ [loadSections] Is fetch promise?',\n        fetchPromise instanceof Promise\n      );\n      console.log('ðŸ“¡ [loadSections] Awaiting fetch response...');\n\n      const cardsResponse = await fetchPromise;\n      console.log(\n        'ðŸ“¡ [loadSections] =========================================='\n      );\n      console.log(\n        'ðŸ“¡ [loadSections] Fetch completed! Status:',\n        cardsResponse.status,\n        'OK:',\n        cardsResponse.ok\n      );\n      console.log(\n        'ðŸ“¡ [loadSections] Response headers:',\n        Object.fromEntries(cardsResponse.headers.entries())\n      );\n\n      interface ApiCard {\n        id: string;\n        title: string;\n        name?: string;\n        type: string;\n        description?: string;\n        icon?: string;\n        color?: string;\n        order?: number;\n        order_index?: number;\n      }\n\n      let cardsFromAPI: ApiCard[] = [];\n\n      if (cardsResponse.ok) {\n        const cardsData = await cardsResponse.json();\n        console.log('ðŸ“¦ [loadSections] Cards API response:', cardsData);\n\n        // Handle different response formats\n        if (Array.isArray(cardsData)) {\n          cardsFromAPI = cardsData;\n        } else if (cardsData.data && Array.isArray(cardsData.data)) {\n          cardsFromAPI = cardsData.data;\n        } else if (cardsData.cards && Array.isArray(cardsData.cards)) {\n          cardsFromAPI = cardsData.cards;\n        } else {\n          cardsFromAPI = [];\n        }\n\n        console.log(\n          `ðŸ“¦ [loadSections] Parsed ${cardsFromAPI.length} cards from API`\n        );\n\n        // Filter to only the predefined cards we want\n        const predefinedCardTypes = [\n          'core-technologies',\n          'framework-questions',\n          'problem-solving',\n          'system-design',\n        ];\n        const beforeFilter = cardsFromAPI.length;\n        cardsFromAPI = cardsFromAPI.filter((card: ApiCard) => {\n          const matches = predefinedCardTypes.includes(card.type);\n          console.log(\n            `ðŸ” [loadSections] Card \"${card.title}\" (type: ${card.type}, id: ${card.id}) - matches: ${matches}`\n          );\n          return matches;\n        });\n\n        console.log(\n          `ðŸ“¦ [loadSections] After filtering: ${beforeFilter} -> ${cardsFromAPI.length} cards`\n        );\n\n        // Sort by order if available\n        cardsFromAPI.sort((a, b) => {\n          const orderA = a.order_index ?? a.order ?? 0;\n          const orderB = b.order_index ?? b.order ?? 0;\n          return orderA - orderB;\n        });\n\n        console.log(\n          `âœ… [loadSections] Found ${cardsFromAPI.length} predefined cards after filtering and sorting`\n        );\n      } else {\n        const errorText = await cardsResponse\n          .text()\n          .catch(() => 'Unknown error');\n        console.error(\n          'âŒ [loadSections] Cards API failed:',\n          cardsResponse.status,\n          errorText\n        );\n        throw new Error(\n          `Failed to fetch cards: ${cardsResponse.status} ${errorText}`\n        );\n      }\n\n      // If no cards found after filtering, throw an error (don't use mock data)\n      if (cardsFromAPI.length === 0) {\n        console.error('âŒ [loadSections] No cards found after filtering');\n        throw new Error(\n          'No learning cards available. Please ensure cards are configured in the database.'\n        );\n      }\n\n      // Step 2: Fetch categories\n      console.log('ðŸ“¡ [loadSections] Fetching categories...');\n      let categoriesFromAPI: ApiCategory[] = [];\n\n      interface ApiCategory {\n        id: string;\n        name: string;\n        description?: string;\n        learning_card_id?: string;\n        cardType?: string;\n        card_type?: string; // Database field name\n      }\n\n      try {\n        const categoriesResponse = await fetch('/api/categories');\n        if (categoriesResponse.ok) {\n          const categoriesData = await categoriesResponse.json();\n          categoriesFromAPI = Array.isArray(categoriesData)\n            ? categoriesData\n            : categoriesData.data || categoriesData.categories || [];\n          console.log(\n            `âœ… [loadSections] Found ${categoriesFromAPI.length} categories`\n          );\n        } else {\n          const errorText = await categoriesResponse\n            .text()\n            .catch(() => 'Unknown error');\n          console.warn(\n            'âš ï¸ [loadSections] Categories API failed:',\n            categoriesResponse.status,\n            errorText\n          );\n          // Don't throw - continue with empty categories (cards can still be shown)\n        }\n      } catch (categoriesError) {\n        console.warn(\n          'âš ï¸ [loadSections] Categories fetch error:',\n          categoriesError\n        );\n        // Don't throw - continue with empty categories (cards can still be shown)\n      }\n\n      // Step 3: Fetch topics\n      console.log('ðŸ“¡ [loadSections] Fetching topics...');\n\n      interface ApiTopic {\n        id: string;\n        name: string;\n        slug?: string;\n        description?: string;\n        category_id?: string;\n        categoryId?: string;\n      }\n\n      let topicsFromAPI: ApiTopic[] = [];\n\n      try {\n        const topicsResponse = await fetch('/api/topics');\n        if (topicsResponse.ok) {\n          const topicsData = await topicsResponse.json();\n          topicsFromAPI = Array.isArray(topicsData)\n            ? topicsData\n            : topicsData.data || topicsData.topics || [];\n          console.log(`âœ… [loadSections] Found ${topicsFromAPI.length} topics`);\n        }\n      } catch (topicsError) {\n        console.warn('âš ï¸ [loadSections] Topics fetch failed:', topicsError);\n      }\n\n      // Step 4: Fetch questions\n      console.log('ðŸ“¡ [loadSections] Fetching questions...');\n\n      interface ApiQuestion {\n        id: string;\n        title?: string;\n        question?: string;\n        question_text?: string;\n        difficulty?: string;\n        estimated_time?: string;\n        estimatedTime?: string;\n        points?: number;\n        point_value?: number;\n        topic_id?: string;\n        topicId?: string; // camelCase from API transformation\n        learning_topic_id?: string;\n        learningTopicId?: string;\n        category_id?: string;\n        categoryId?: string; // camelCase from API transformation\n        learning_category_id?: string;\n        learningCategoryId?: string;\n        learning_card_id?: string;\n      }\n\n      let allQuestions: ApiQuestion[] = [];\n\n      try {\n        const questionsResponse = await fetch('/api/questions?limit=1000');\n        if (questionsResponse.ok) {\n          const questionsData = await questionsResponse.json();\n          allQuestions = Array.isArray(questionsData)\n            ? questionsData\n            : questionsData.data || questionsData.questions || [];\n          console.log(\n            `âœ… [loadSections] Found ${allQuestions.length} questions`\n          );\n        }\n      } catch (questionsError) {\n        console.warn(\n          'âš ï¸ [loadSections] Questions fetch failed:',\n          questionsError\n        );\n      }\n\n      // Step 5: Build hierarchical structure: Cards -> Categories -> Topics -> Questions\n      console.log(\n        `ðŸ”„ [loadSections] Building hierarchy for ${cardsFromAPI.length} cards...`\n      );\n      console.log(\n        `ðŸ“¦ [loadSections] Available categories: ${categoriesFromAPI.length}`\n      );\n      console.log(\n        `ðŸ“¦ [loadSections] Available topics: ${topicsFromAPI.length}`\n      );\n      console.log(\n        `ðŸ“¦ [loadSections] Available questions: ${allQuestions.length}`\n      );\n\n      // Ensure we have cards to transform\n      if (cardsFromAPI.length === 0) {\n        throw new Error(\n          'No cards available from API. Please check the database configuration.'\n        );\n      }\n\n      const transformedCards: Card[] = cardsFromAPI.map((card: ApiCard) => {\n        console.log(\n          `ðŸ”„ [loadSections] Processing card: ${card.title} (${card.type}, id: ${card.id})`\n        );\n\n        // Find categories for this card (match by learning_card_id, card_type, or cardType)\n        const cardCategories = categoriesFromAPI.filter((cat: ApiCategory) => {\n          // Match by learning_card_id (exact match) - primary matching method\n          if (cat.learning_card_id === card.id) {\n            console.log(\n              `âœ… [loadSections] Category \"${cat.name}\" matches card \"${card.title}\" by learning_card_id`\n            );\n            return true;\n          }\n\n          // Match by card_type or cardType (check both possible field names)\n          const categoryCardType = cat.card_type || cat.cardType || '';\n\n          // Map card types to their display names\n          const cardTypeMapping: Record<string, string[]> = {\n            'core-technologies': ['Core Technologies', 'Core Technologies'],\n            'framework-questions': [\n              'Framework Questions',\n              'Framework Questions',\n            ],\n            'problem-solving': [\n              'Problem Solving',\n              'Problem Solving',\n              'Frontend Tasks',\n            ],\n            'system-design': ['System Design', 'System Design'],\n          };\n\n          const possibleTypeNames = cardTypeMapping[card.type] || [\n            card.title || '',\n          ];\n\n          // Check if category's card_type matches any of the possible type names for this card\n          if (\n            categoryCardType &&\n            possibleTypeNames.some(\n              typeName =>\n                categoryCardType.toLowerCase() === typeName.toLowerCase()\n            )\n          ) {\n            console.log(\n              `âœ… [loadSections] Category \"${cat.name}\" (card_type: \"${categoryCardType}\") matches card \"${card.title}\" (type: \"${card.type}\") by card_type`\n            );\n            return true;\n          }\n\n          // Also try matching by card title or type in category name (fallback)\n          if (card.title && cat.name) {\n            const cardTitleWords = card.title.toLowerCase().split(' ');\n            const categoryNameLower = cat.name.toLowerCase();\n            if (\n              cardTitleWords.some(\n                word => categoryNameLower.includes(word) && word.length > 3\n              )\n            ) {\n              console.log(\n                `âœ… [loadSections] Category \"${cat.name}\" matches card \"${card.title}\" by name similarity`\n              );\n              return true;\n            }\n          }\n\n          return false;\n        });\n\n        console.log(\n          `ðŸ“¦ [loadSections] Card \"${card.title}\" has ${cardCategories.length} matching categories`\n        );\n\n        // Transform categories with their topics and questions\n        // If no categories match, create an empty array (card will still display, just without categories)\n        const transformedCategories: Category[] = cardCategories.map(\n          (category: ApiCategory) => {\n            // Find topics for this category\n            const categoryTopics = topicsFromAPI.filter(\n              (topic: ApiTopic) =>\n                topic.category_id === category.id ||\n                topic.categoryId === category.id\n            );\n\n            // Transform topics with their questions\n            const transformedTopics: Topic[] = categoryTopics.map(\n              (topic: ApiTopic) => {\n                // Find questions for this topic - check multiple possible field names\n                const topicQuestions = allQuestions\n                  .filter((q: ApiQuestion) => {\n                    // Try multiple possible field names for topic_id\n                    const matchesTopicId =\n                      q.topic_id === topic.id ||\n                      q.topicId === topic.id ||\n                      q.learning_topic_id === topic.id ||\n                      q.learningTopicId === topic.id;\n\n                    if (matchesTopicId) {\n                      console.log(\n                        `âœ… [loadSections] Question \"${q.title || q.question || q.id}\" matches topic \"${topic.name}\" (id: ${topic.id})`\n                      );\n                    }\n\n                    return matchesTopicId;\n                  })\n                  .map((q: ApiQuestion) => ({\n                    id: q.id,\n                    title:\n                      q.title ||\n                      q.question ||\n                      q.question_text ||\n                      'Untitled Question',\n                    difficulty: (q.difficulty === 'beginner'\n                      ? 'Easy'\n                      : q.difficulty === 'advanced'\n                        ? 'Hard'\n                        : 'Medium') as 'Easy' | 'Medium' | 'Hard',\n                    estimatedTime: (q.estimated_time || q.estimatedTime) as\n                      | string\n                      | null,\n                    points: q.points || q.point_value || 0,\n                  }));\n\n                console.log(\n                  `ðŸ“¦ [loadSections] Topic \"${topic.name}\" (id: ${topic.id}) has ${topicQuestions.length} questions`\n                );\n\n                return {\n                  id: topic.id,\n                  name: topic.name,\n                  description: topic.description,\n                  questions: topicQuestions,\n                  isSelected: false,\n                  selectedQuestions: [],\n                };\n              }\n            );\n\n            // Also find questions directly linked to category (without a topic) - check multiple field names\n            const directCategoryQuestions = allQuestions\n              .filter((q: ApiQuestion) => {\n                const matchesCategory =\n                  q.category_id === category.id ||\n                  q.categoryId === category.id ||\n                  q.learning_category_id === category.id ||\n                  q.learningCategoryId === category.id;\n\n                const hasNoTopic =\n                  !q.topic_id &&\n                  !q.topicId &&\n                  !q.learning_topic_id &&\n                  !q.learningTopicId;\n\n                return matchesCategory && hasNoTopic;\n              })\n              .map((q: ApiQuestion) => ({\n                id: q.id,\n                title:\n                  q.title ||\n                  q.question ||\n                  q.question_text ||\n                  'Untitled Question',\n                difficulty: (q.difficulty === 'beginner'\n                  ? 'Easy'\n                  : q.difficulty === 'advanced'\n                    ? 'Hard'\n                    : 'Medium') as 'Easy' | 'Medium' | 'Hard',\n                estimatedTime: (q.estimated_time || q.estimatedTime) as\n                  | string\n                  | null,\n                points: q.points || q.point_value || 0,\n              }));\n\n            // If there are direct category questions (not linked to a specific topic),\n            // add them to a \"General\" topic for organization\n            // This is a UI grouping mechanism, not hardcoded data\n            if (directCategoryQuestions.length > 0) {\n              transformedTopics.push({\n                id: `category-${category.id}-general`,\n                name: 'General',\n                description: 'Questions without a specific topic',\n                questions: directCategoryQuestions,\n                isSelected: false,\n                selectedQuestions: [],\n              });\n            }\n\n            return {\n              id: category.id,\n              name: category.name,\n              description: category.description,\n              topics: transformedTopics,\n              isSelected: false,\n              selectedTopics: new Set(),\n            };\n          }\n        );\n\n        const transformedCard: Card = {\n          id: card.id,\n          title: card.title || card.name || 'Untitled Card',\n          type: card.type,\n          description: card.description,\n          categories: transformedCategories,\n          isSelected: false,\n          selectedCategories: new Set<string>(),\n        };\n\n        const totalTopics = transformedCategories.reduce(\n          (sum, cat) => sum + cat.topics.length,\n          0\n        );\n        const totalQuestions = transformedCategories.reduce(\n          (sum, cat) =>\n            sum +\n            cat.topics.reduce(\n              (topicSum, topic) => topicSum + topic.questions.length,\n              0\n            ),\n          0\n        );\n\n        console.log(\n          `âœ… [loadSections] Card \"${card.title}\" transformed: ${transformedCategories.length} categories, ${totalTopics} topics, ${totalQuestions} questions`\n        );\n\n        return transformedCard;\n      });\n\n      // Clear timeout\n      clearTimeout(timeoutId);\n\n      // Set cards and stop loading\n      console.log(`âœ… [loadSections] Setting ${transformedCards.length} cards`);\n      console.log(\n        'ðŸ“¦ [loadSections] Transformed cards:',\n        transformedCards.map(c => ({\n          id: c.id,\n          title: c.title,\n          categoriesCount: c.categories.length,\n          totalTopics: c.categories.reduce(\n            (sum, cat) => sum + cat.topics.length,\n            0\n          ),\n          totalQuestions: c.categories.reduce(\n            (sum, cat) =>\n              sum +\n              cat.topics.reduce(\n                (topicSum, topic) => topicSum + topic.questions.length,\n                0\n              ),\n            0\n          ),\n        }))\n      );\n\n      // Always set cards, even if empty (so UI can show empty state)\n      if (transformedCards.length > 0) {\n        setCards(transformedCards);\n        setError(null); // Clear any previous errors if we successfully loaded cards\n        setIsLoading(false);\n        console.log(\n          `âœ… [loadSections] DONE - Set ${transformedCards.length} cards, isLoading set to false`\n        );\n      } else {\n        // This shouldn't happen if the check above worked, but handle it anyway\n        console.error(\n          'âŒ [loadSections] No transformed cards despite having cards from API'\n        );\n        throw new Error(\n          'Failed to transform cards data. Please check the console for details.'\n        );\n      }\n    } catch (error) {\n      // Clear timeout\n      clearTimeout(timeoutId);\n\n      const errorMessage =\n        error instanceof Error ? error.message : String(error);\n      console.error('âŒ [loadSections] ERROR:', error);\n      console.error('âŒ Error message:', errorMessage);\n\n      // ALWAYS set loading to false on error and show error message\n      setCards([]);\n      setIsLoading(false);\n      setError(\n        errorMessage ||\n          'Failed to load data from the database. Please try again.'\n      );\n      console.log('âœ… [loadSections] ERROR HANDLED - isLoading set to false');\n    }\n  }, []); // Empty deps - loadSections is stable and doesn't need to change\n\n  const checkAuthAndRedirect = useCallback(() => {\n    // Clear any pending intent flags when user reaches this page (authenticated)\n    if (isAuthenticated) {\n      try {\n        // Clear localStorage intent flags\n        localStorage.removeItem('pending_browse_practice_questions_intent');\n        localStorage.removeItem('pending_custom_roadmap_intent');\n        console.log('âœ… Cleared pending intent flags on custom-roadmap page');\n\n        // Set navbar to Free Style mode\n        setUserType('self-directed');\n        setLearningType('free-style');\n        console.log('âœ… Set navbar to Free Style mode');\n      } catch (e) {\n        console.warn(\n          'Error clearing localStorage flags or setting user type:',\n          e\n        );\n      }\n\n      // ALWAYS load cards proactively when authenticated (regardless of current step)\n      // This prepares the data while user fills in step 1, so it's ready for step 2\n      if (cards.length === 0) {\n        console.log(\n          'ðŸ“¦ [Page Load] Proactively loading cards immediately (authenticated, no cards yet)...'\n        );\n        console.log(\n          'ðŸ“¦ [Page Load] This will prepare data while user fills step 1 form'\n        );\n        console.log('ðŸ“¦ [Page Load] About to call loadSections()...');\n        console.log('ðŸ“¦ [Page Load] loadSections type:', typeof loadSections);\n        setIsLoading(true);\n\n        // Call loadSections and ensure it executes\n        try {\n          const loadPromise = loadSections();\n          console.log(\n            'ðŸ“¦ [Page Load] loadSections() called, returned promise:',\n            loadPromise\n          );\n\n          if (loadPromise && typeof loadPromise.then === 'function') {\n            loadPromise\n              .then(() => {\n                console.log(\n                  'âœ… [Page Load] Cards loaded successfully and ready for step 2!'\n                );\n                setIsLoading(false);\n              })\n              .catch(error => {\n                console.error('âŒ [Page Load] Error loading cards:', error);\n                setIsLoading(false);\n                setError(\n                  error instanceof Error\n                    ? error.message\n                    : 'Failed to load cards'\n                );\n              });\n          } else {\n            console.error(\n              'âŒ [Page Load] loadSections() did not return a promise!',\n              loadPromise\n            );\n            setIsLoading(false);\n            setError('loadSections did not return a promise');\n          }\n        } catch (syncError) {\n          console.error(\n            'âŒ [Page Load] Synchronous error calling loadSections:',\n            syncError\n          );\n          setIsLoading(false);\n          setError(\n            syncError instanceof Error\n              ? syncError.message\n              : 'Failed to call loadSections'\n          );\n        }\n      } else {\n        // If cards are already loaded, just ensure loading is false\n        console.log(\n          'âœ… [Page Load] Cards already loaded, setting isLoading to false'\n        );\n        setIsLoading(false);\n      }\n      return;\n    }\n\n    // If not authenticated, store intent and redirect to auth immediately\n    try {\n      localStorage.setItem('pending_browse_practice_questions_intent', 'true');\n      localStorage.setItem('pending_custom_roadmap_intent', 'true');\n      console.log('âœ… Set pending intent flags before redirecting to auth');\n      // Use window.location.href for immediate redirect (doesn't wait for React router)\n      window.location.href = '/auth?redirect=/dashboard';\n    } catch (e) {\n      console.warn('Error setting localStorage flag:', e);\n      // Fallback to router if window.location fails\n      router.push('/auth?redirect=/dashboard');\n    }\n  }, [\n    isAuthenticated,\n    router,\n    loadSections,\n    setUserType,\n    setLearningType,\n    cards.length,\n  ]);\n\n  useEffect(() => {\n    console.log('ðŸ”„ [useEffect] Running auth check...', {\n      authIsLoading,\n      isAuthenticated,\n      hasCheckedAuth,\n      authCheckComplete,\n      cardsCount: cards.length,\n    });\n\n    // Wait for auth check to complete before proceeding\n    if (!authCheckComplete) {\n      console.log('â³ [useEffect] Waiting for auth check to complete...');\n      setIsLoading(true); // Keep loading state while waiting for auth\n      return;\n    }\n\n    // Wait for auth context to finish loading before checking\n    if (authIsLoading) {\n      console.log('â³ [useEffect] Waiting for auth context to load...');\n      setIsLoading(true); // Keep loading state while waiting for auth\n      return;\n    }\n\n    // Mark that we've checked auth (prevent multiple redirects)\n    if (hasCheckedAuth) {\n      console.log('âœ… [useEffect] Auth already checked');\n      // If already checked and authenticated but no cards, try loading again as fallback\n      if (cards.length === 0 && isAuthenticated && !isLoading) {\n        console.log(\n          'ðŸ”„ [useEffect] Fallback: Loading cards (already checked auth, no cards)...'\n        );\n        setIsLoading(true);\n        loadSections()\n          .then(() => {\n            console.log('âœ… [useEffect] Fallback load successful');\n            setIsLoading(false);\n          })\n          .catch((error: Error) => {\n            console.error('âŒ [useEffect] Fallback load error:', error);\n            setIsLoading(false);\n            setError(error.message || 'Failed to load cards');\n          });\n      } else if (isLoading && !isAuthenticated) {\n        // If not authenticated and loading, stop loading\n        console.log('âš ï¸ [useEffect] Not authenticated, stopping load');\n        setIsLoading(false);\n      }\n      return;\n    }\n\n    console.log(\n      'âœ… [useEffect] First time checking auth, setting hasCheckedAuth to true'\n    );\n    setHasCheckedAuth(true);\n\n    // Check if we have pending intent flags (meaning we were redirected here from dashboard)\n    const hasPendingIntent =\n      localStorage.getItem('pending_browse_practice_questions_intent') ===\n        'true' ||\n      localStorage.getItem('pending_custom_roadmap_intent') === 'true';\n\n    // If we have pending flags and auth is still loading, wait a bit more\n    if (hasPendingIntent && !isAuthenticated && authCheckComplete) {\n      console.log(\n        'â³ [useEffect] Has pending intent, waiting a bit more for auth to propagate...'\n      );\n      const timeout = setTimeout(() => {\n        checkAuthAndRedirect();\n      }, 500);\n      return () => clearTimeout(timeout);\n    }\n\n    // Only call checkAuthAndRedirect after auth check is complete\n    if (authCheckComplete) {\n      console.log(\n        'âœ… [useEffect] Auth check complete, calling checkAuthAndRedirect'\n      );\n      checkAuthAndRedirect();\n    }\n  }, [\n    authIsLoading,\n    isAuthenticated,\n    hasCheckedAuth,\n    authCheckComplete,\n    checkAuthAndRedirect,\n    isLoading,\n    cards.length,\n    loadSections,\n    sections.length,\n  ]);\n\n  // Load cards automatically when step 2 is reached (fallback - cards should already be loaded from page load)\n  useEffect(() => {\n    console.log('ðŸ” [useEffect Step 2] Effect triggered with:', {\n      currentStep,\n      isAuthenticated,\n      cardsLength: cards.length,\n      error,\n      isLoading,\n      hasTriedLoad: hasTriedLoadForStep2.current,\n      loadSectionsDefined: typeof loadSections === 'function',\n    });\n\n    // Reset the ref when leaving step 2\n    if (currentStep !== 2) {\n      hasTriedLoadForStep2.current = false;\n      return;\n    }\n\n    // FORCE load when on step 2, authenticated, and no cards - regardless of other conditions\n    if (currentStep === 2 && isAuthenticated && cards.length === 0) {\n      // Only try once per step 2 visit to avoid infinite loops\n      if (!hasTriedLoadForStep2.current) {\n        console.log('ðŸš€ [useEffect Step 2] FORCING LOAD - All conditions met!');\n        console.log(\n          'ðŸš€ [useEffect Step 2] Step 2 âœ…, Authenticated âœ…, No cards âœ…'\n        );\n\n        hasTriedLoadForStep2.current = true; // Mark that we've tried\n\n        // Set loading state immediately\n        setIsLoading(true);\n        setError(null);\n\n        // Call loadSections immediately - don't wait for anything\n        console.log('ðŸ“ž [useEffect Step 2] Calling loadSections() NOW...');\n        console.log(\n          'ðŸ“ž [useEffect Step 2] loadSections type:',\n          typeof loadSections\n        );\n        console.log('ðŸ“ž [useEffect Step 2] loadSections value:', loadSections);\n\n        try {\n          const loadPromise = loadSections();\n          console.log(\n            'ðŸ“ž [useEffect Step 2] loadSections() returned:',\n            loadPromise\n          );\n          console.log(\n            'ðŸ“ž [useEffect Step 2] Is promise?',\n            loadPromise && typeof loadPromise.then === 'function'\n          );\n\n          if (loadPromise && typeof loadPromise.then === 'function') {\n            loadPromise\n              .then(() => {\n                console.log('âœ… [useEffect Step 2] Cards loaded successfully');\n              })\n              .catch((error: Error) => {\n                console.error(\n                  'âŒ [useEffect Step 2] Error loading cards:',\n                  error\n                );\n                setIsLoading(false);\n                setError(error.message || 'Failed to load cards');\n                // Reset on error so user can retry manually\n                hasTriedLoadForStep2.current = false;\n              });\n          } else {\n            console.error(\n              'âŒ [useEffect Step 2] loadSections() did not return a promise!',\n              loadPromise\n            );\n            setIsLoading(false);\n            setError('loadSections did not return a promise');\n            hasTriedLoadForStep2.current = false;\n          }\n        } catch (syncError) {\n          console.error(\n            'âŒ [useEffect Step 2] Synchronous error calling loadSections:',\n            syncError\n          );\n          setIsLoading(false);\n          setError(\n            syncError instanceof Error\n              ? syncError.message\n              : 'Failed to call loadSections'\n          );\n          hasTriedLoadForStep2.current = false;\n        }\n      } else {\n        console.log(\n          'â¸ï¸ [useEffect Step 2] Already tried loading for this step 2 visit'\n        );\n      }\n    } else {\n      console.log('â¸ï¸ [useEffect Step 2] Conditions not met:', {\n        currentStepNot2: currentStep !== 2,\n        notAuthenticated: !isAuthenticated,\n        hasCards: cards.length > 0,\n      });\n    }\n  }, [\n    currentStep,\n    isAuthenticated,\n    cards.length,\n    loadSections,\n    error,\n    isLoading,\n  ]);\n\n  // Card selection handlers - select all children when card is selected\n  const handleCardToggle = (cardId: string) => {\n    setCards(prev =>\n      prev.map(card => {\n        if (card.id === cardId) {\n          const newIsSelected = !card.isSelected;\n\n          // If selecting the card, select all categories, topics, and questions\n          if (newIsSelected) {\n            const updatedCategories = card.categories.map(category => {\n              // Select all topics in this category\n              const updatedTopics = category.topics.map(topic => {\n                // Select all questions in this topic\n                const allQuestionIds = topic.questions.map(q => q.id);\n                return {\n                  ...topic,\n                  isSelected: true,\n                  selectedQuestions: allQuestionIds,\n                };\n              });\n              // Select all topics\n              const allTopicIds = new Set(updatedTopics.map(t => t.id));\n              return {\n                ...category,\n                isSelected: true,\n                topics: updatedTopics,\n                selectedTopics: allTopicIds,\n              };\n            });\n            return {\n              ...card,\n              isSelected: true,\n              categories: updatedCategories,\n            };\n          } else {\n            // If deselecting, deselect all children\n            const updatedCategories = card.categories.map(category => {\n              const updatedTopics = category.topics.map(topic => ({\n                ...topic,\n                isSelected: false,\n                selectedQuestions: [],\n              }));\n              return {\n                ...category,\n                isSelected: false,\n                topics: updatedTopics,\n                selectedTopics: new Set<string>(),\n              };\n            });\n            return {\n              ...card,\n              isSelected: false,\n              categories: updatedCategories,\n            };\n          }\n        }\n        return card;\n      })\n    );\n\n    const newSelectedCards = new Set(selectedCards);\n    if (newSelectedCards.has(cardId)) {\n      newSelectedCards.delete(cardId);\n    } else {\n      newSelectedCards.add(cardId);\n    }\n    setSelectedCards(newSelectedCards);\n\n    // When a card is clicked, collapse the full summary\n    // The compact version or collapsed badge will show based on question count\n    // This allows users to see the count while keeping the summary collapsed\n    setIsSummaryVisible(false);\n  };\n\n  // Category selection handlers - select all topics and questions when category is selected\n  const handleCategoryToggle = (cardId: string, categoryId: string) => {\n    setCards(prev =>\n      prev.map(card => {\n        if (card.id === cardId) {\n          const updatedCategories = card.categories.map(category => {\n            if (category.id === categoryId) {\n              const newIsSelected = !category.isSelected;\n\n              if (newIsSelected) {\n                // Select all topics and questions in this category\n                const updatedTopics = category.topics.map(topic => {\n                  // Select all questions in this topic\n                  const allQuestionIds = topic.questions.map(q => q.id);\n                  return {\n                    ...topic,\n                    isSelected: true,\n                    selectedQuestions: allQuestionIds,\n                  };\n                });\n                const allTopicIds = new Set(updatedTopics.map(t => t.id));\n                return {\n                  ...category,\n                  isSelected: true,\n                  topics: updatedTopics,\n                  selectedTopics: allTopicIds,\n                };\n              } else {\n                // Deselect all topics and questions\n                const updatedTopics = category.topics.map(topic => ({\n                  ...topic,\n                  isSelected: false,\n                  selectedQuestions: [],\n                }));\n                return {\n                  ...category,\n                  isSelected: false,\n                  topics: updatedTopics,\n                  selectedTopics: new Set<string>(),\n                };\n              }\n            }\n            return category;\n          });\n          return { ...card, categories: updatedCategories };\n        }\n        return card;\n      })\n    );\n  };\n\n  // Topic selection handlers - select all questions when topic is selected\n  const handleTopicToggle = (\n    cardId: string,\n    categoryId: string,\n    topicId: string\n  ) => {\n    setCards(prev =>\n      prev.map(card => {\n        if (card.id === cardId) {\n          const updatedCategories = card.categories.map(category => {\n            if (category.id === categoryId) {\n              const updatedTopics = category.topics.map(topic => {\n                if (topic.id === topicId) {\n                  const newIsSelected = !topic.isSelected;\n\n                  if (newIsSelected) {\n                    // Select all questions in this topic\n                    const allQuestionIds = topic.questions.map(q => q.id);\n                    return {\n                      ...topic,\n                      isSelected: true,\n                      selectedQuestions: allQuestionIds,\n                    };\n                  } else {\n                    // Deselect all questions\n                    return {\n                      ...topic,\n                      isSelected: false,\n                      selectedQuestions: [],\n                    };\n                  }\n                }\n                return topic;\n              });\n              const newSelectedTopics = new Set(category.selectedTopics);\n              const topic = updatedTopics.find(t => t.id === topicId);\n              if (topic?.isSelected) {\n                newSelectedTopics.add(topicId);\n              } else {\n                newSelectedTopics.delete(topicId);\n              }\n              return {\n                ...category,\n                topics: updatedTopics,\n                selectedTopics: newSelectedTopics,\n              };\n            }\n            return category;\n          });\n          return { ...card, categories: updatedCategories };\n        }\n        return card;\n      })\n    );\n  };\n\n  // Question selection handlers (for cards structure)\n  const handleQuestionToggleCard = (\n    cardId: string,\n    categoryId: string,\n    topicId: string,\n    questionId: string\n  ) => {\n    setCards(prev =>\n      prev.map(card => {\n        if (card.id === cardId) {\n          const updatedCategories = card.categories.map(category => {\n            if (category.id === categoryId) {\n              const updatedTopics = category.topics.map(topic => {\n                if (topic.id === topicId) {\n                  const newSelectedQuestions = topic.selectedQuestions.includes(\n                    questionId\n                  )\n                    ? topic.selectedQuestions.filter(id => id !== questionId)\n                    : [...topic.selectedQuestions, questionId];\n                  return {\n                    ...topic,\n                    selectedQuestions: newSelectedQuestions,\n                    isSelected: newSelectedQuestions.length > 0,\n                  };\n                }\n                return topic;\n              });\n              return { ...category, topics: updatedTopics };\n            }\n            return category;\n          });\n          return { ...card, categories: updatedCategories };\n        }\n        return card;\n      })\n    );\n  };\n\n  // Question selection handler (legacy for Step 3 sections)\n  const handleQuestionToggle = (sectionId: string, question_id: string) => {\n    setSections(prev =>\n      prev.map(section => {\n        if (section.id === sectionId) {\n          const newSelectedQuestions = section.selectedQuestions.includes(\n            question_id\n          )\n            ? section.selectedQuestions.filter(id => id !== question_id)\n            : [...section.selectedQuestions, question_id];\n          return { ...section, selectedQuestions: newSelectedQuestions };\n        }\n        return section;\n      })\n    );\n  };\n\n  // Legacy handlers for backward compatibility (not used in new UI but kept for Step 3)\n  // Section selection handlers - select all questions when section is selected\n  const handleSectionToggle = (sectionId: string) => {\n    const newSelectedSections = new Set(selectedSections);\n    if (newSelectedSections.has(sectionId)) {\n      newSelectedSections.delete(sectionId);\n      // Deselect all questions in this section\n      setSections(prev =>\n        prev.map(section =>\n          section.id === sectionId\n            ? { ...section, isSelected: false, selectedQuestions: [] }\n            : section\n        )\n      );\n    } else {\n      newSelectedSections.add(sectionId);\n      // Select all questions in this section\n      setSections(prev =>\n        prev.map(section => {\n          if (section.id === sectionId) {\n            const allQuestionIds = section.questions.map(q => q.id);\n            return {\n              ...section,\n              isSelected: true,\n              selectedQuestions: allQuestionIds,\n            };\n          }\n          return section;\n        })\n      );\n    }\n    setSelectedSections(newSelectedSections);\n  };\n\n  const handleSelectAllQuestions = (sectionId: string) => {\n    setSections(prev =>\n      prev.map(section => {\n        if (section.id === sectionId) {\n          const allQuestionIds = section.questions.map(q => q.id);\n          return { ...section, selectedQuestions: allQuestionIds };\n        }\n        return section;\n      })\n    );\n  };\n\n  const handleClearAllQuestions = (sectionId: string) => {\n    setSections(prev =>\n      prev.map(section => {\n        if (section.id === sectionId) {\n          return { ...section, selectedQuestions: [] };\n        }\n        return section;\n      })\n    );\n  };\n\n  // Fetch question details asynchronously - doesn't block UI\n  const fetchQuestionDetails = useCallback(async (questionId: string) => {\n    // Don't set loading here - it's already set when modal opens\n    // This allows the modal to render immediately while fetching\n\n    try {\n      const response = await fetch(`/api/questions/${questionId}`);\n      if (response.ok) {\n        const data = await response.json();\n        const questionData = data.data || data;\n\n        // Parse options if they're stored as a JSON string\n        if (questionData.options) {\n          if (typeof questionData.options === 'string') {\n            try {\n              questionData.options = JSON.parse(questionData.options);\n            } catch (e) {\n              console.warn('Failed to parse options JSON:', e);\n              // Keep as string if parsing fails\n            }\n          }\n        }\n\n        // Parse tags if they're stored as a JSON string\n        if (questionData.tags) {\n          if (typeof questionData.tags === 'string') {\n            try {\n              questionData.tags = JSON.parse(questionData.tags);\n            } catch (e) {\n              console.warn('Failed to parse tags JSON:', e);\n              // Keep as string if parsing fails\n            }\n          }\n        }\n\n        setQuestionDetails(questionData);\n      } else {\n        throw new Error('Failed to fetch question details');\n      }\n    } catch (error) {\n      console.error('Error fetching question details:', error);\n      setError(\n        error instanceof Error\n          ? error.message\n          : 'Failed to load question details'\n      );\n    } finally {\n      setIsLoadingQuestionDetails(false);\n    }\n  }, []);\n\n  // Handle opening question details modal - open immediately, fetch in background\n  const handleViewQuestion = useCallback(\n    (questionId: string, e: React.MouseEvent) => {\n      e.stopPropagation(); // Prevent checkbox toggle\n      setSelectedQuestionId(questionId);\n      setQuestionDetails(null); // Clear previous details\n      setIsLoadingQuestionDetails(true);\n      // Fetch in background - don't await, let it update when ready\n      fetchQuestionDetails(questionId).catch(error => {\n        console.error('Error fetching question details:', error);\n        // Error is already handled in fetchQuestionDetails\n      });\n    },\n    [fetchQuestionDetails]\n  );\n\n  // Handle closing modal\n  const handleCloseModal = useCallback(() => {\n    setSelectedQuestionId(null);\n    setQuestionDetails(null);\n  }, []);\n\n  const calculatePlanStats = () => {\n    // Calculate from cards structure - count ALL selected questions from ALL cards\n    // (not just from selected cards, because questions can be selected individually)\n    let totalQuestions = 0;\n\n    cards.forEach(card => {\n      // Count questions from all cards, regardless of card selection status\n      // This allows users to select individual questions without selecting entire cards\n      card.categories.forEach(category => {\n        category.topics.forEach(topic => {\n          totalQuestions += topic.selectedQuestions.length;\n        });\n      });\n    });\n\n    // Also calculate from legacy sections for backward compatibility\n    const selectedSectionsData = sections.filter(section =>\n      selectedSections.has(section.id)\n    );\n    const legacyTotalQuestions = selectedSectionsData.reduce(\n      (sum, section) => sum + section.selectedQuestions.length,\n      0\n    );\n\n    // Use whichever is greater (cards or legacy sections)\n    totalQuestions = Math.max(totalQuestions, legacyTotalQuestions);\n    const dailyQuestions = Math.ceil(totalQuestions / duration);\n\n    return { totalQuestions, dailyQuestions };\n  };\n\n  const handleSavePlan = async () => {\n    if (!planName.trim()) {\n      alert('Please enter a plan name');\n      return;\n    }\n\n    // Check if any questions are selected from cards\n    const hasSelectedQuestions = cards.some(card =>\n      card.categories.some(category =>\n        category.topics.some(topic => topic.selectedQuestions.length > 0)\n      )\n    );\n\n    if (!hasSelectedQuestions && totalQuestions === 0) {\n      alert('Please select at least one question');\n      return;\n    }\n\n    // Legacy sections check (for backward compatibility)\n    const selectedSectionsData = sections.filter(section =>\n      selectedSections.has(section.id)\n    );\n    const totalSelectedQuestions = selectedSectionsData.reduce(\n      (sum, section) => sum + section.selectedQuestions.length,\n      0\n    );\n\n    setIsSaving(true);\n    setError(null);\n\n    try {\n      // Build plan data from selected cards structure\n      const selectedCardsForPlan: Card[] = [];\n\n      cards.forEach(card => {\n        if (card.isSelected || selectedCards.has(card.id)) {\n          const selectedCategoriesForCard: Category[] = [];\n          card.categories.forEach(category => {\n            if (category.isSelected || category.selectedTopics.size > 0) {\n              const selectedTopicsForCategory: Topic[] = [];\n              category.topics.forEach(topic => {\n                if (topic.isSelected || topic.selectedQuestions.length > 0) {\n                  selectedTopicsForCategory.push({\n                    ...topic,\n                    questions: topic.questions.filter(q =>\n                      topic.selectedQuestions.includes(q.id)\n                    ),\n                  });\n                }\n              });\n              if (selectedTopicsForCategory.length > 0) {\n                selectedCategoriesForCard.push({\n                  ...category,\n                  topics: selectedTopicsForCategory,\n                });\n              }\n            }\n          });\n          if (selectedCategoriesForCard.length > 0) {\n            selectedCardsForPlan.push({\n              ...card,\n              categories: selectedCategoriesForCard,\n            });\n          }\n        }\n      });\n\n      // Calculate total questions from cards structure\n      let totalSelectedQuestionsFromCards = 0;\n      selectedCardsForPlan.forEach(card => {\n        card.categories.forEach(category => {\n          category.topics.forEach(topic => {\n            totalSelectedQuestionsFromCards += topic.selectedQuestions.length;\n          });\n        });\n      });\n\n      // Use cards structure if available, otherwise fall back to legacy sections\n      const totalQuestions =\n        totalSelectedQuestionsFromCards > 0\n          ? totalSelectedQuestionsFromCards\n          : totalSelectedQuestions;\n\n      // Create plan object\n      const plan: CustomPlan = {\n        id: `plan_${Date.now()}`,\n        name: planName,\n        description: planDescription,\n        duration,\n        sections: selectedSectionsData, // Legacy format for compatibility\n        totalQuestions,\n        dailyQuestions: Math.ceil(totalQuestions / duration),\n        created_at: new Date(),\n      };\n\n      // TODO: Replace with API call to save plan to database\n      // For now, save to localStorage as a temporary solution\n      // In production, this should be: await fetch('/api/plans', { method: 'POST', body: JSON.stringify(plan) })\n      const existingPlans = JSON.parse(\n        localStorage.getItem('userPlans') || '[]'\n      );\n      existingPlans.push(plan);\n      localStorage.setItem('userPlans', JSON.stringify(existingPlans));\n\n      setIsSaving(false);\n      router.push('/my-plans');\n    } catch (err) {\n      setIsSaving(false);\n      const errorMessage =\n        err instanceof Error ? err.message : 'Failed to save plan';\n      setError(errorMessage);\n      console.error('Error saving plan:', err);\n    }\n  };\n\n  const { totalQuestions, dailyQuestions } = calculatePlanStats();\n\n  // Show loading/redirecting state if waiting for auth check or auth context to load\n  if (\n    authIsLoading ||\n    !authCheckComplete ||\n    (!isAuthenticated && !hasCheckedAuth)\n  ) {\n    return (\n      <div className='min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center'>\n        <div className='text-center'>\n          <Loader2 className='w-12 h-12 animate-spin mx-auto mb-4 text-indigo-600' />\n          <p className='text-gray-600 dark:text-gray-300 text-lg'>\n            Checking authentication...\n          </p>\n          <p className='text-gray-500 dark:text-gray-400 text-sm mt-2'>\n            Please wait\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Show redirecting state if not authenticated (after auth check is complete)\n  if (!isAuthenticated && hasCheckedAuth && authCheckComplete) {\n    return (\n      <div className='min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center'>\n        <div className='text-center'>\n          <Loader2 className='w-12 h-12 animate-spin mx-auto mb-4 text-indigo-600' />\n          <p className='text-gray-600 dark:text-gray-300 text-lg'>\n            Redirecting to login...\n          </p>\n          <p className='text-gray-500 dark:text-gray-400 text-sm mt-2'>\n            Please sign in to continue\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Don't block the UI - always show the form, even while loading\n  // Loading states will be shown within specific sections (Step 2) instead\n\n  return (\n    <div className='min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900'>\n      <div className='container mx-auto px-4 pt-24 pb-12'>\n        {/* Header */}\n        <div className='text-center mb-12'>\n          <div className='relative mb-8'>\n            <div className='absolute inset-0 bg-gradient-to-r from-indigo-400 via-purple-500 to-pink-500 rounded-3xl blur-3xl opacity-20 scale-110' />\n            <div className='relative w-24 h-24 bg-gradient-to-r from-indigo-500 via-purple-600 to-pink-500 rounded-3xl flex items-center justify-center mx-auto shadow-2xl'>\n              <Target className='w-12 h-12 text-white' />\n              <div\n                className='absolute inset-0 rounded-3xl border-4 border-white/20 animate-spin'\n                style={{ animationDuration: '8s' }}\n              />\n            </div>\n          </div>\n\n          <h1 className='text-5xl font-bold bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-6'>\n            Create Your Custom Roadmap\n          </h1>\n\n          <p className='text-xl text-gray-600 dark:text-gray-400 max-w-4xl mx-auto leading-relaxed mb-8'>\n            Build a personalized learning path tailored to your goals, schedule,\n            and interests. Choose from all available sections and select\n            specific questions to create your perfect study plan.\n          </p>\n        </div>\n\n        {/* Progress Steps */}\n        <div className='flex items-center justify-center mb-12'>\n          <div className='flex items-center space-x-4'>\n            {[1, 2, 3].map(step => (\n              <div key={step} className='flex items-center'>\n                <div\n                  className={`w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold ${\n                    currentStep >= step\n                      ? 'bg-indigo-600 text-white'\n                      : 'bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400'\n                  }`}\n                >\n                  {currentStep > step ? <Check className='w-5 h-5' /> : step}\n                </div>\n                {step < 3 && (\n                  <div\n                    className={`w-16 h-1 mx-2 ${\n                      currentStep > step\n                        ? 'bg-indigo-600'\n                        : 'bg-gray-200 dark:bg-gray-700'\n                    }`}\n                  />\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Step 1: Plan Details */}\n        {currentStep === 1 && (\n          <div className='max-w-2xl mx-auto'>\n            <div className='bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-200 dark:border-gray-700 transition-all duration-300 hover:shadow-2xl'>\n              <div className='flex items-center space-x-3 mb-6 pb-4 border-b border-gray-200 dark:border-gray-700'>\n                <div className='w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center'>\n                  <Target className='w-5 h-5 text-white' />\n                </div>\n                <h2 className='text-2xl font-bold text-gray-900 dark:text-white'>\n                  Plan Details\n                </h2>\n              </div>\n\n              <div className='space-y-6'>\n                <div>\n                  <label className='block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2'>\n                    Plan Name *\n                  </label>\n                  <input\n                    type='text'\n                    value={planName}\n                    onChange={e => setPlanName(e.target.value)}\n                    placeholder='e.g., Frontend Mastery Plan'\n                    className='w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500'\n                  />\n                </div>\n\n                <div>\n                  <label className='block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2'>\n                    Description\n                  </label>\n                  <textarea\n                    value={planDescription}\n                    onChange={e => setPlanDescription(e.target.value)}\n                    placeholder='Describe your learning goals and what you want to achieve...'\n                    rows={4}\n                    className='w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500 resize-none'\n                  />\n                </div>\n\n                <div>\n                  <label className='block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2'>\n                    Duration (days)\n                  </label>\n                  <div className='flex items-center space-x-4'>\n                    <button\n                      onClick={() => setDuration(Math.max(1, duration - 1))}\n                      className='w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600'\n                    >\n                      <Minus className='w-4 h-4' />\n                    </button>\n                    <input\n                      type='number'\n                      value={duration}\n                      onChange={e =>\n                        setDuration(Math.max(1, parseInt(e.target.value) || 1))\n                      }\n                      min='1'\n                      max='365'\n                      className='w-20 text-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent dark:bg-gray-700 dark:text-white'\n                    />\n                    <button\n                      onClick={() => setDuration(Math.min(365, duration + 1))}\n                      className='w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600'\n                    >\n                      <Plus className='w-4 h-4' />\n                    </button>\n                  </div>\n                </div>\n              </div>\n\n              <div className='mt-8 text-right'>\n                <button\n                  onClick={() => {\n                    console.log(\n                      'ðŸ–±ï¸ [Button Click] Moving to step 2, cards.length:',\n                      cards.length\n                    );\n                    setCurrentStep(2);\n                    // Reset the ref so useEffect can trigger load\n                    hasTriedLoadForStep2.current = false;\n                    // Always try to load cards when moving to step 2 if we don't have them\n                    if (cards.length === 0 && isAuthenticated) {\n                      console.log(\n                        'ðŸ”„ [Button Click] Starting to load cards immediately when moving to step 2...'\n                      );\n                      hasTriedLoadForStep2.current = true; // Prevent duplicate calls\n                      setIsLoading(true);\n                      setError(null);\n                      loadSections()\n                        .then(() => {\n                          console.log(\n                            'âœ… [Button Click] loadSections completed successfully'\n                          );\n                        })\n                        .catch((error: Error) => {\n                          console.error(\n                            'âŒ [Button Click] Error loading cards:',\n                            error\n                          );\n                          setIsLoading(false);\n                          setError(error.message || 'Failed to load cards');\n                          hasTriedLoadForStep2.current = false; // Allow retry\n                        });\n                    }\n                  }}\n                  disabled={!planName.trim()}\n                  className='px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed text-white rounded-xl font-semibold transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none disabled:shadow-none'\n                >\n                  Next: Select Sections\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 2: Select Cards and Content */}\n        {currentStep === 2 && (\n          <div className='max-w-6xl mx-auto'>\n            <div className='bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-200 dark:border-gray-700 transition-all duration-300 hover:shadow-2xl'>\n              <div className='flex items-center space-x-3 mb-6 pb-4 border-b border-gray-200 dark:border-gray-700'>\n                <div className='w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center'>\n                  <Target className='w-5 h-5 text-white' />\n                </div>\n                <h2 className='text-2xl font-bold text-gray-900 dark:text-white'>\n                  Select Learning Content\n                </h2>\n              </div>\n\n              {/* Show loading indicator at top if loading, but don't block the UI */}\n              {isLoading && cards.length === 0 && (\n                <div className='mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg'>\n                  <div className='flex items-center space-x-3'>\n                    <Loader2 className='w-5 h-5 animate-spin text-blue-600 dark:text-blue-400' />\n                    <p className='text-blue-700 dark:text-blue-300 text-sm'>\n                      Loading cards in the background... You can continue with\n                      other steps.\n                    </p>\n                  </div>\n                </div>\n              )}\n\n              {/* Show error banner at top if error, but don't block the UI */}\n              {error && cards.length === 0 && (\n                <div className='mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg'>\n                  <div className='flex items-center justify-between'>\n                    <div className='flex items-center space-x-3'>\n                      <AlertCircle className='w-5 h-5 text-red-600 dark:text-red-400' />\n                      <p className='text-red-700 dark:text-red-300 text-sm'>\n                        {error}\n                      </p>\n                    </div>\n                    <button\n                      onClick={() => {\n                        setError(null);\n                        setIsLoading(true);\n                        loadSections();\n                      }}\n                      className='px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-semibold transition-colors'\n                    >\n                      Retry\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* Show cards if available, or empty state if not loading and no error */}\n              {cards.length === 0 && !isLoading && !error ? (\n                <div className='text-center py-12'>\n                  <p className='text-gray-600 dark:text-gray-300 text-lg mb-4'>\n                    No cards available yet\n                  </p>\n                  <p className='text-gray-500 dark:text-gray-400 text-sm mb-6'>\n                    Cards will appear here once they&apos;re loaded from the\n                    database.\n                  </p>\n                  <button\n                    onClick={() => {\n                      setIsLoading(true);\n                      setError(null);\n                      loadSections();\n                    }}\n                    className='px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-semibold transition-colors'\n                  >\n                    Load Cards\n                  </button>\n                </div>\n              ) : (\n                cards.length > 0 && (\n                  <div className='space-y-4'>\n                    {cards.map(card => (\n                      <div\n                        key={card.id}\n                        className={`border-2 rounded-xl overflow-hidden transition-all ${\n                          selectedCards.has(card.id)\n                            ? 'border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20'\n                            : 'border-gray-200 dark:border-gray-700'\n                        }`}\n                      >\n                        {/* Card Header */}\n                        <div\n                          className='p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors'\n                          onClick={() => {\n                            handleCardToggle(card.id);\n                            setExpandedCard(\n                              expandedCard === card.id ? null : card.id\n                            );\n                          }}\n                        >\n                          <div className='flex items-center justify-between'>\n                            <div className='flex items-center space-x-3'>\n                              <button\n                                onClick={e => {\n                                  e.stopPropagation();\n                                  setExpandedCard(\n                                    expandedCard === card.id ? null : card.id\n                                  );\n                                }}\n                                className='p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded'\n                              >\n                                {expandedCard === card.id ? (\n                                  <ChevronDown className='w-5 h-5 text-gray-600 dark:text-gray-400' />\n                                ) : (\n                                  <ChevronRight className='w-5 h-5 text-gray-600 dark:text-gray-400' />\n                                )}\n                              </button>\n                              <div\n                                className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${\n                                  selectedCards.has(card.id)\n                                    ? 'border-indigo-500 bg-indigo-500'\n                                    : 'border-gray-300 dark:border-gray-600'\n                                }`}\n                              >\n                                {selectedCards.has(card.id) && (\n                                  <Check className='w-4 h-4 text-white' />\n                                )}\n                              </div>\n                              <h3 className='text-lg font-semibold text-gray-900 dark:text-white'>\n                                {card.title}\n                              </h3>\n                            </div>\n                            <p className='text-sm text-gray-500 dark:text-gray-400'>\n                              {card.description}\n                            </p>\n                          </div>\n                        </div>\n\n                        {/* Card Content - Categories */}\n                        {expandedCard === card.id && (\n                          <div className='px-4 pb-4 space-y-3'>\n                            {card.categories.length === 0 ? (\n                              <p className='text-sm text-gray-500 dark:text-gray-400 py-4 text-center'>\n                                No categories available for this card\n                              </p>\n                            ) : (\n                              card.categories.map(category => (\n                                <div\n                                  key={category.id}\n                                  className={`border rounded-lg overflow-hidden ${\n                                    category.isSelected\n                                      ? 'border-indigo-400 bg-indigo-50/50 dark:bg-indigo-900/10'\n                                      : 'border-gray-200 dark:border-gray-700'\n                                  }`}\n                                >\n                                  {/* Category Header */}\n                                  <div\n                                    className='p-3 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors'\n                                    onClick={() => {\n                                      handleCategoryToggle(\n                                        card.id,\n                                        category.id\n                                      );\n                                      setExpandedCategory(\n                                        expandedCategory === category.id\n                                          ? null\n                                          : category.id\n                                      );\n                                    }}\n                                  >\n                                    <div className='flex items-center justify-between'>\n                                      <div className='flex items-center space-x-2'>\n                                        <button\n                                          onClick={e => {\n                                            e.stopPropagation();\n                                            setExpandedCategory(\n                                              expandedCategory === category.id\n                                                ? null\n                                                : category.id\n                                            );\n                                          }}\n                                          className='p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded'\n                                        >\n                                          {expandedCategory === category.id ? (\n                                            <ChevronDown className='w-4 h-4 text-gray-600 dark:text-gray-400' />\n                                          ) : (\n                                            <ChevronRight className='w-4 h-4 text-gray-600 dark:text-gray-400' />\n                                          )}\n                                        </button>\n                                        <div\n                                          className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${\n                                            category.isSelected\n                                              ? 'border-indigo-500 bg-indigo-500'\n                                              : 'border-gray-300 dark:border-gray-600'\n                                          }`}\n                                        >\n                                          {category.isSelected && (\n                                            <Check className='w-3 h-3 text-white' />\n                                          )}\n                                        </div>\n                                        <h4 className='font-medium text-gray-800 dark:text-gray-200'>\n                                          {category.name}\n                                        </h4>\n                                      </div>\n                                      <span className='text-xs text-gray-500 dark:text-gray-400'>\n                                        {category.topics.reduce(\n                                          (sum, t) => sum + t.questions.length,\n                                          0\n                                        )}{' '}\n                                        questions\n                                      </span>\n                                    </div>\n                                  </div>\n\n                                  {/* Category Content - Topics */}\n                                  {expandedCategory === category.id && (\n                                    <div className='px-3 pb-3 space-y-2'>\n                                      {category.topics.length === 0 ? (\n                                        <p className='text-xs text-gray-500 dark:text-gray-400 py-2 text-center'>\n                                          No topics available\n                                        </p>\n                                      ) : (\n                                        category.topics.map(topic => (\n                                          <div\n                                            key={topic.id}\n                                            className={`border rounded-md overflow-hidden ${\n                                              topic.isSelected\n                                                ? 'border-indigo-300 bg-indigo-50/30 dark:bg-indigo-900/5'\n                                                : 'border-gray-200 dark:border-gray-700'\n                                            }`}\n                                          >\n                                            {/* Topic Header */}\n                                            <div\n                                              className='p-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors'\n                                              onClick={() => {\n                                                handleTopicToggle(\n                                                  card.id,\n                                                  category.id,\n                                                  topic.id\n                                                );\n                                                setExpandedTopic(\n                                                  expandedTopic === topic.id\n                                                    ? null\n                                                    : topic.id\n                                                );\n                                              }}\n                                            >\n                                              <div className='flex items-center justify-between'>\n                                                <div className='flex items-center space-x-2'>\n                                                  <button\n                                                    onClick={e => {\n                                                      e.stopPropagation();\n                                                      setExpandedTopic(\n                                                        expandedTopic ===\n                                                          topic.id\n                                                          ? null\n                                                          : topic.id\n                                                      );\n                                                    }}\n                                                    className='p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded'\n                                                  >\n                                                    {expandedTopic ===\n                                                    topic.id ? (\n                                                      <ChevronDown className='w-3 h-3 text-gray-600 dark:text-gray-400' />\n                                                    ) : (\n                                                      <ChevronRight className='w-3 h-3 text-gray-600 dark:text-gray-400' />\n                                                    )}\n                                                  </button>\n                                                  <div\n                                                    className={`w-4 h-4 rounded-full border-2 flex items-center justify-center ${\n                                                      topic.isSelected\n                                                        ? 'border-indigo-500 bg-indigo-500'\n                                                        : 'border-gray-300 dark:border-gray-600'\n                                                    }`}\n                                                  >\n                                                    {topic.isSelected && (\n                                                      <Check className='w-2 h-2 text-white' />\n                                                    )}\n                                                  </div>\n                                                  <span className='text-sm text-gray-700 dark:text-gray-300'>\n                                                    {topic.name}\n                                                  </span>\n                                                </div>\n                                                <span className='text-xs text-gray-500 dark:text-gray-400'>\n                                                  {topic.questions.length}{' '}\n                                                  questions\n                                                </span>\n                                              </div>\n                                            </div>\n\n                                            {/* Topic Content - Questions */}\n                                            {expandedTopic === topic.id &&\n                                              topic.questions.length > 0 && (\n                                                <div className='px-2 pb-2 space-y-1 max-h-60 overflow-y-auto'>\n                                                  {topic.questions.map(\n                                                    question => (\n                                                      <label\n                                                        key={question.id}\n                                                        className='flex items-center space-x-2 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded cursor-pointer'\n                                                        onClick={e =>\n                                                          e.stopPropagation()\n                                                        }\n                                                      >\n                                                        <input\n                                                          type='checkbox'\n                                                          checked={topic.selectedQuestions.includes(\n                                                            question.id\n                                                          )}\n                                                          onChange={() =>\n                                                            handleQuestionToggleCard(\n                                                              card.id,\n                                                              category.id,\n                                                              topic.id,\n                                                              question.id\n                                                            )\n                                                          }\n                                                          className='w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500'\n                                                        />\n                                                        <span className='text-xs text-gray-700 dark:text-gray-300 flex-1'>\n                                                          {question.title}\n                                                        </span>\n                                                        <button\n                                                          onClick={e =>\n                                                            handleViewQuestion(\n                                                              question.id,\n                                                              e\n                                                            )\n                                                          }\n                                                          className='p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors'\n                                                          title='View question details'\n                                                        >\n                                                          <Eye className='w-4 h-4 text-gray-600 dark:text-gray-400' />\n                                                        </button>\n                                                        <span\n                                                          className={`text-xs px-1.5 py-0.5 rounded ${\n                                                            question.difficulty ===\n                                                            'Easy'\n                                                              ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400'\n                                                              : question.difficulty ===\n                                                                  'Medium'\n                                                                ? 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400'\n                                                                : 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'\n                                                          }`}\n                                                        >\n                                                          {question.difficulty}\n                                                        </span>\n                                                      </label>\n                                                    )\n                                                  )}\n                                                </div>\n                                              )}\n                                          </div>\n                                        ))\n                                      )}\n                                    </div>\n                                  )}\n                                </div>\n                              ))\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                )\n              )}\n\n              <div className='mt-8 flex justify-between'>\n                <button\n                  onClick={() => setCurrentStep(1)}\n                  className='px-6 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-400 dark:hover:border-gray-500 transition-all duration-200'\n                >\n                  Back\n                </button>\n                <button\n                  onClick={() => setCurrentStep(3)}\n                  disabled={totalQuestions === 0}\n                  className='px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed text-white rounded-xl font-semibold transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none disabled:shadow-none'\n                >\n                  Next: Review Plan\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Step 3: Review Selected Questions */}\n        {currentStep === 3 && (\n          <div className='max-w-6xl mx-auto'>\n            <div className='bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 border border-gray-200 dark:border-gray-700 transition-all duration-300 hover:shadow-2xl'>\n              <div className='flex items-center space-x-3 mb-6 pb-4 border-b border-gray-200 dark:border-gray-700'>\n                <div className='w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center'>\n                  <Target className='w-5 h-5 text-white' />\n                </div>\n                <div className='flex-1'>\n                  <h2 className='text-2xl font-bold text-gray-900 dark:text-white'>\n                    Review Your Selected Questions\n                  </h2>\n                  <p className='text-sm text-gray-500 dark:text-gray-400 mt-1'>\n                    {totalQuestions}{' '}\n                    {totalQuestions === 1 ? 'question' : 'questions'} selected\n                    across {selectedCards.size}{' '}\n                    {selectedCards.size === 1 ? 'card' : 'cards'}\n                  </p>\n                </div>\n              </div>\n\n              {/* Summary Stats */}\n              <div className='grid grid-cols-2 md:grid-cols-4 gap-4 mb-8'>\n                <div className='bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-900/20 dark:to-indigo-800/20 rounded-xl p-4 border border-indigo-200 dark:border-indigo-800'>\n                  <div className='text-sm text-indigo-600 dark:text-indigo-400 font-medium mb-1'>\n                    Total Questions\n                  </div>\n                  <div className='text-2xl font-bold text-indigo-900 dark:text-indigo-100'>\n                    {totalQuestions}\n                  </div>\n                </div>\n                <div className='bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-xl p-4 border border-purple-200 dark:border-purple-800'>\n                  <div className='text-sm text-purple-600 dark:text-purple-400 font-medium mb-1'>\n                    Duration\n                  </div>\n                  <div className='text-2xl font-bold text-purple-900 dark:text-purple-100'>\n                    {duration} days\n                  </div>\n                </div>\n                <div className='bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-900/20 dark:to-pink-800/20 rounded-xl p-4 border border-pink-200 dark:border-pink-800'>\n                  <div className='text-sm text-pink-600 dark:text-pink-400 font-medium mb-1'>\n                    Daily Goal\n                  </div>\n                  <div className='text-2xl font-bold text-pink-900 dark:text-pink-100'>\n                    {dailyQuestions}/day\n                  </div>\n                </div>\n                <div className='bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-900/20 dark:to-emerald-800/20 rounded-xl p-4 border border-emerald-200 dark:border-emerald-800'>\n                  <div className='text-sm text-emerald-600 dark:text-emerald-400 font-medium mb-1'>\n                    Progress\n                  </div>\n                  <div className='text-2xl font-bold text-emerald-900 dark:text-emerald-100'>\n                    {Math.round(\n                      (totalQuestions /\n                        Math.max(dailyQuestions * duration, 1)) *\n                        100\n                    )}\n                    %\n                  </div>\n                </div>\n              </div>\n\n              {/* Selected Questions by Card */}\n              <div className='space-y-6'>\n                {cards\n                  .filter(card => {\n                    // Show card if it has any selected questions\n                    return card.categories.some(category =>\n                      category.topics.some(\n                        topic => topic.selectedQuestions.length > 0\n                      )\n                    );\n                  })\n                  .map(card => (\n                    <div\n                      key={card.id}\n                      className='border border-gray-200 dark:border-gray-700 rounded-xl p-6 bg-gradient-to-br from-gray-50/50 to-white dark:from-gray-800/50 dark:to-gray-800'\n                    >\n                      <div className='flex items-center justify-between mb-4'>\n                        <div>\n                          <h3 className='text-lg font-semibold text-gray-900 dark:text-white mb-1'>\n                            {card.title}\n                          </h3>\n                          <p className='text-sm text-gray-500 dark:text-gray-400'>\n                            {card.categories.reduce(\n                              (total, cat) =>\n                                total +\n                                cat.topics.reduce(\n                                  (sum, topic) =>\n                                    sum + topic.selectedQuestions.length,\n                                  0\n                                ),\n                              0\n                            )}{' '}\n                            {card.categories.reduce(\n                              (total, cat) =>\n                                total +\n                                cat.topics.reduce(\n                                  (sum, topic) =>\n                                    sum + topic.selectedQuestions.length,\n                                  0\n                                ),\n                              0\n                            ) === 1\n                              ? 'question'\n                              : 'questions'}{' '}\n                            selected\n                          </p>\n                        </div>\n                      </div>\n\n                      {/* Categories and Topics */}\n                      <div className='space-y-4'>\n                        {card.categories\n                          .filter(category =>\n                            category.topics.some(\n                              topic => topic.selectedQuestions.length > 0\n                            )\n                          )\n                          .map(category => (\n                            <div\n                              key={category.id}\n                              className='ml-4 border-l-2 border-indigo-200 dark:border-indigo-800 pl-4'\n                            >\n                              <h4 className='text-md font-medium text-gray-800 dark:text-gray-200 mb-2'>\n                                {category.name}\n                              </h4>\n                              {category.topics\n                                .filter(\n                                  topic => topic.selectedQuestions.length > 0\n                                )\n                                .map(topic => (\n                                  <div key={topic.id} className='ml-4 mb-3'>\n                                    <h5 className='text-sm font-medium text-gray-700 dark:text-gray-300 mb-2'>\n                                      {topic.name} (\n                                      {topic.selectedQuestions.length}{' '}\n                                      {topic.selectedQuestions.length === 1\n                                        ? 'question'\n                                        : 'questions'}\n                                      )\n                                    </h5>\n                                    <div className='grid md:grid-cols-2 gap-3'>\n                                      {topic.questions\n                                        .filter(q =>\n                                          topic.selectedQuestions.includes(q.id)\n                                        )\n                                        .map(question => (\n                                          <div\n                                            key={question.id}\n                                            className='p-3 rounded-lg border-2 border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 flex items-start justify-between group hover:shadow-md transition-all duration-200'\n                                          >\n                                            <div className='flex-1 min-w-0'>\n                                              <div className='flex items-start justify-between mb-2'>\n                                                <h6 className='font-medium text-gray-900 dark:text-white text-sm flex-1 pr-2'>\n                                                  {question.title}\n                                                </h6>\n                                                <button\n                                                  onClick={e => {\n                                                    e.stopPropagation();\n                                                    handleViewQuestion(\n                                                      question.id,\n                                                      e\n                                                    );\n                                                  }}\n                                                  className='p-1 hover:bg-indigo-200 dark:hover:bg-indigo-800 rounded transition-colors flex-shrink-0'\n                                                  title='View question details'\n                                                >\n                                                  <Eye className='w-4 h-4 text-indigo-600 dark:text-indigo-400' />\n                                                </button>\n                                              </div>\n                                              <div className='flex items-center space-x-2 flex-wrap gap-1'>\n                                                <span\n                                                  className={`px-2 py-0.5 rounded text-xs ${\n                                                    question.difficulty ===\n                                                    'Easy'\n                                                      ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400'\n                                                      : question.difficulty ===\n                                                          'Medium'\n                                                        ? 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400'\n                                                        : 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'\n                                                  }`}\n                                                >\n                                                  {question.difficulty}\n                                                </span>\n                                                {question.estimatedTime && (\n                                                  <span className='text-xs text-gray-500 dark:text-gray-400'>\n                                                    {question.estimatedTime}\n                                                  </span>\n                                                )}\n                                                {question.points && (\n                                                  <span className='text-xs text-gray-500 dark:text-gray-400'>\n                                                    {question.points} pts\n                                                  </span>\n                                                )}\n                                              </div>\n                                            </div>\n                                            <button\n                                              onClick={() => {\n                                                // Find the card, category, and topic to remove this question\n                                                const cardIndex =\n                                                  cards.findIndex(\n                                                    c => c.id === card.id\n                                                  );\n                                                if (cardIndex !== -1) {\n                                                  const categoryIndex = cards[\n                                                    cardIndex\n                                                  ].categories.findIndex(\n                                                    c => c.id === category.id\n                                                  );\n                                                  if (categoryIndex !== -1) {\n                                                    const topicIndex = cards[\n                                                      cardIndex\n                                                    ].categories[\n                                                      categoryIndex\n                                                    ].topics.findIndex(\n                                                      t => t.id === topic.id\n                                                    );\n                                                    if (topicIndex !== -1) {\n                                                      handleQuestionToggleCard(\n                                                        card.id,\n                                                        category.id,\n                                                        topic.id,\n                                                        question.id\n                                                      );\n                                                    }\n                                                  }\n                                                }\n                                              }}\n                                              className='p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded transition-colors ml-2 flex-shrink-0'\n                                              title='Remove question'\n                                            >\n                                              <X className='w-4 h-4 text-red-600 dark:text-red-400' />\n                                            </button>\n                                          </div>\n                                        ))}\n                                    </div>\n                                  </div>\n                                ))}\n                            </div>\n                          ))}\n                      </div>\n                    </div>\n                  ))}\n              </div>\n\n              {totalQuestions === 0 && (\n                <div className='text-center py-12'>\n                  <Target className='w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4' />\n                  <p className='text-gray-500 dark:text-gray-400 text-lg'>\n                    No questions selected yet\n                  </p>\n                  <p className='text-gray-400 dark:text-gray-500 text-sm mt-2'>\n                    Go back to select questions from your cards\n                  </p>\n                </div>\n              )}\n\n              <div className='mt-8 flex justify-between'>\n                <button\n                  onClick={() => setCurrentStep(2)}\n                  className='px-6 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-400 dark:hover:border-gray-500 transition-all duration-200'\n                >\n                  Back\n                </button>\n                <button\n                  onClick={handleSavePlan}\n                  disabled={totalQuestions === 0 || isSaving}\n                  className='px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed text-white rounded-xl font-semibold transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:transform-none disabled:shadow-none flex items-center space-x-2'\n                >\n                  {isSaving ? (\n                    <>\n                      <Loader2 className='w-4 h-4 animate-spin' />\n                      <span>Saving...</span>\n                    </>\n                  ) : (\n                    <>\n                      <Save className='w-4 h-4' />\n                      <span>Create Plan</span>\n                    </>\n                  )}\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Plan Summary Toggle Button Container - Fixed positioning with relative toggle button and absolute badge */}\n      {currentStep > 1 && (\n        <div\n          className={`fixed top-1/2 transform -translate-y-1/2 z-20 ${\n            isSummaryVisible\n              ? totalQuestions > 0\n                ? 'right-[19rem]'\n                : 'right-[22rem]'\n              : totalQuestions > 0\n                ? 'right-[10rem]'\n                : 'right-8'\n          }`}\n        >\n          {/* Toggle Button - Relative positioned */}\n          <button\n            onClick={() => setIsSummaryVisible(!isSummaryVisible)}\n            className='relative w-14 h-14 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 hover:scale-110 hover:shadow-3xl'\n            aria-label={isSummaryVisible ? 'Hide summary' : 'Show summary'}\n            title={isSummaryVisible ? 'Hide Plan Summary' : 'Show Plan Summary'}\n          >\n            {isSummaryVisible ? (\n              <PanelRightClose className='w-6 h-6' />\n            ) : (\n              <PanelRightOpen className='w-6 h-6' />\n            )}\n          </button>\n\n          {/* Premium Collapsed Count Badge - Absolute positioned under toggle button */}\n          {!isSummaryVisible && totalQuestions > 0 && (\n            <button\n              onClick={() => setIsSummaryVisible(true)}\n              className='absolute top-full mt-4 left-1/2 transform -translate-x-1/2 w-32 bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 rounded-3xl shadow-2xl border-2 border-white/30 dark:border-white/20 p-4 z-10 transition-all duration-300 hover:shadow-3xl hover:scale-105 hover:from-indigo-600 hover:via-purple-700 hover:to-pink-600 cursor-pointer group relative overflow-hidden'\n              title='Click to expand plan summary'\n            >\n              {/* Animated background gradient */}\n              <div className='absolute inset-0 bg-gradient-to-br from-white/10 via-transparent to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300' />\n\n              {/* Glow effect */}\n              <div className='absolute inset-0 bg-gradient-to-br from-indigo-400/50 via-purple-400/50 to-pink-400/50 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 -z-10' />\n\n              <div className='flex flex-col items-center space-y-2.5 relative z-10'>\n                {/* Icon with animated pulse */}\n                <div className='relative'>\n                  <div className='absolute inset-0 bg-white/30 rounded-xl blur-md opacity-0 group-hover:opacity-100 animate-pulse' />\n                  <div className='w-10 h-10 bg-white/25 dark:bg-white/15 rounded-xl flex items-center justify-center shadow-xl backdrop-blur-md border border-white/30 group-hover:bg-white/35 group-hover:scale-110 transition-all duration-300'>\n                    <Target className='w-5 h-5 text-white drop-shadow-lg' />\n                  </div>\n                </div>\n\n                {/* Count with gradient text - better alignment */}\n                <div className='text-center w-full'>\n                  <div className='text-2xl font-black text-white drop-shadow-2xl mb-0.5 leading-tight'>\n                    {totalQuestions}\n                  </div>\n                  <div className='text-[10px] text-white/95 dark:text-white/90 font-bold uppercase tracking-wider leading-tight'>\n                    {totalQuestions === 1 ? 'Question' : 'Questions'}\n                  </div>\n                </div>\n\n                {/* Progress bar with percentage */}\n                <div className='w-full space-y-1'>\n                  <div className='flex items-center justify-between px-1'>\n                    <span className='text-[8px] text-white/80 font-medium'>\n                      Progress\n                    </span>\n                    <span className='text-[8px] text-white font-bold'>\n                      {Math.round(\n                        (totalQuestions /\n                          Math.max(dailyQuestions * duration, 1)) *\n                          100\n                      )}\n                      %\n                    </span>\n                  </div>\n                  <div className='w-full h-1.5 bg-white/20 rounded-full overflow-hidden backdrop-blur-sm'>\n                    <div\n                      className='h-full bg-gradient-to-r from-white via-white/90 to-white rounded-full transition-all duration-700 ease-out shadow-lg relative'\n                      style={{\n                        width: `${Math.min(100, (totalQuestions / Math.max(dailyQuestions * duration, 1)) * 100)}%`,\n                      }}\n                    >\n                      {/* Shimmer effect */}\n                      <div\n                        className='absolute inset-0 opacity-60'\n                        style={{\n                          background:\n                            'linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent)',\n                          backgroundSize: '200% 100%',\n                          animation: 'shimmer 2s linear infinite',\n                        }}\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                {/* Quick stats indicator */}\n                <div className='flex items-center gap-2 pt-0.5'>\n                  <div className='flex items-center gap-1'>\n                    <Clock className='w-3 h-3 text-white/80' />\n                    <span className='text-[8px] text-white/80 font-medium'>\n                      {duration}d\n                    </span>\n                  </div>\n                  <div className='w-px h-2.5 bg-white/30' />\n                  <div className='flex items-center gap-1'>\n                    <Zap className='w-3 h-3 text-white/80' />\n                    <span className='text-[8px] text-white/80 font-medium'>\n                      {dailyQuestions}/day\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Expand hint - positioned at top */}\n              <div className='absolute -top-6 left-1/2 transform -translate-x-1/2 opacity-60 group-hover:opacity-100 transition-opacity'>\n                <div className='flex items-center gap-1 text-white/70 bg-indigo-500/80 dark:bg-indigo-600/80 px-2 py-1 rounded-full backdrop-blur-sm'>\n                  <PanelRightOpen className='w-3 h-3' />\n                  <span className='text-[8px] font-medium uppercase tracking-wider'>\n                    Expand\n                  </span>\n                </div>\n              </div>\n            </button>\n          )}\n        </div>\n      )}\n\n      {/* Enhanced Plan Summary Sidebar - Full Summary (shown when no questions selected) */}\n      {currentStep > 1 && isSummaryVisible && totalQuestions === 0 && (\n        <div className='fixed right-8 top-1/2 transform -translate-y-1/2 w-80 bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl rounded-2xl shadow-2xl border-2 border-indigo-200/60 dark:border-indigo-700/60 p-6 z-10 transition-all duration-300 hover:shadow-3xl hover:scale-[1.02] animate-in fade-in slide-in-from-right-4'>\n          {/* Header with Icon */}\n          <div className='flex items-center space-x-3 mb-6 pb-4 border-b border-gray-200 dark:border-gray-700'>\n            <div className='w-12 h-12 bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 rounded-xl flex items-center justify-center shadow-lg transform transition-transform duration-300 hover:scale-110 hover:rotate-3'>\n              <Target className='w-6 h-6 text-white' />\n            </div>\n            <div>\n              <h3 className='text-xl font-bold text-gray-900 dark:text-white'>\n                Plan Summary\n              </h3>\n              <p className='text-xs text-gray-500 dark:text-gray-400'>\n                Overview of your roadmap\n              </p>\n            </div>\n          </div>\n\n          {/* Stats Grid with Enhanced Design */}\n          <div className='space-y-3'>\n            <div className='group flex items-center justify-between p-4 bg-gradient-to-r from-indigo-50/50 via-purple-50/50 to-pink-50/50 dark:from-indigo-900/20 dark:via-purple-900/20 dark:to-pink-900/20 rounded-xl border border-indigo-100 dark:border-indigo-800/50 transition-all duration-200 hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-md hover:scale-[1.02]'>\n              <div className='flex items-center space-x-3'>\n                <div className='w-10 h-10 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-md'>\n                  <Clock className='w-5 h-5 text-white' />\n                </div>\n                <div>\n                  <span className='text-xs text-gray-500 dark:text-gray-400 font-medium block'>\n                    Duration\n                  </span>\n                  <span className='text-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent dark:from-indigo-400 dark:to-purple-400'>\n                    {duration} days\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <div className='group flex items-center justify-between p-4 bg-gradient-to-r from-purple-50/50 via-pink-50/50 to-rose-50/50 dark:from-purple-900/20 dark:via-pink-900/20 dark:to-rose-900/20 rounded-xl border border-purple-100 dark:border-purple-800/50 transition-all duration-200 hover:border-purple-300 dark:hover:border-purple-600 hover:shadow-md hover:scale-[1.02]'>\n              <div className='flex items-center space-x-3'>\n                <div className='w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center shadow-md'>\n                  <Target className='w-5 h-5 text-white' />\n                </div>\n                <div>\n                  <span className='text-xs text-gray-500 dark:text-gray-400 font-medium block'>\n                    Selected Cards\n                  </span>\n                  <span className='text-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent dark:from-purple-400 dark:to-pink-400'>\n                    {selectedCards.size}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <div className='group flex items-center justify-between p-4 bg-gradient-to-r from-blue-50/50 via-cyan-50/50 to-teal-50/50 dark:from-blue-900/20 dark:via-cyan-900/20 dark:to-teal-900/20 rounded-xl border border-blue-100 dark:border-blue-800/50 transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-md hover:scale-[1.02]'>\n              <div className='flex items-center space-x-3'>\n                <div className='w-10 h-10 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center shadow-md'>\n                  <BookOpen className='w-5 h-5 text-white' />\n                </div>\n                <div>\n                  <span className='text-xs text-gray-500 dark:text-gray-400 font-medium block'>\n                    Total Questions\n                  </span>\n                  <span className='text-xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent dark:from-blue-400 dark:to-cyan-400'>\n                    {totalQuestions}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <div className='group flex items-center justify-between p-4 bg-gradient-to-r from-emerald-50/50 via-green-50/50 to-lime-50/50 dark:from-emerald-900/20 dark:via-green-900/20 dark:to-lime-900/20 rounded-xl border border-emerald-100 dark:border-emerald-800/50 transition-all duration-200 hover:border-emerald-300 dark:hover:border-emerald-600 hover:shadow-md hover:scale-[1.02]'>\n              <div className='flex items-center space-x-3'>\n                <div className='w-10 h-10 bg-gradient-to-br from-emerald-500 to-green-500 rounded-lg flex items-center justify-center shadow-md'>\n                  <Zap className='w-5 h-5 text-white' />\n                </div>\n                <div>\n                  <span className='text-xs text-gray-500 dark:text-gray-400 font-medium block'>\n                    Daily Goal\n                  </span>\n                  <span className='text-xl font-bold bg-gradient-to-r from-emerald-600 to-green-600 bg-clip-text text-transparent dark:from-emerald-400 dark:to-green-400'>\n                    {dailyQuestions} {dailyQuestions === 1 ? 'Q' : 'Qs'}/day\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Helpful Hint */}\n          <div className='mt-6 p-3 bg-gradient-to-r from-indigo-50/50 to-purple-50/50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-lg border border-indigo-100 dark:border-indigo-800/50'>\n            <p className='text-xs text-gray-600 dark:text-gray-400 text-center'>\n              ðŸ’¡ Select questions from cards to build your custom plan\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Enhanced Compact Question Count Indicator with Header (shown when questions are selected) */}\n      {currentStep > 1 && isSummaryVisible && totalQuestions > 0 && (\n        <div className='fixed right-8 top-1/2 transform -translate-y-1/2 w-72 bg-white/95 dark:bg-gray-800/95 backdrop-blur-xl rounded-2xl shadow-2xl border-2 border-indigo-200/60 dark:border-indigo-700/60 p-5 z-10 transition-all duration-300 hover:shadow-3xl hover:scale-[1.02] animate-in fade-in slide-in-from-right-4'>\n          {/* Header with Icon and Count */}\n          <div className='flex items-center space-x-3 mb-5 pb-4 border-b border-gray-200 dark:border-gray-700'>\n            <div className='w-12 h-12 bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 rounded-xl flex items-center justify-center shadow-lg transform transition-transform duration-300 hover:scale-110 hover:rotate-3'>\n              <Target className='w-6 h-6 text-white' />\n            </div>\n            <div className='flex-1'>\n              <h3 className='text-lg font-bold text-gray-900 dark:text-white mb-0.5'>\n                Plan Summary\n              </h3>\n              <p className='text-sm font-semibold text-indigo-600 dark:text-indigo-400'>\n                {totalQuestions}{' '}\n                {totalQuestions === 1 ? 'Question' : 'Questions'} Selected\n              </p>\n            </div>\n          </div>\n\n          {/* Progress Bar */}\n          <div className='mb-4'>\n            <div className='flex items-center justify-between mb-2'>\n              <span className='text-xs font-medium text-gray-600 dark:text-gray-400'>\n                Progress\n              </span>\n              <span className='text-xs font-bold text-indigo-600 dark:text-indigo-400'>\n                {Math.round(\n                  (totalQuestions / Math.max(dailyQuestions * duration, 1)) *\n                    100\n                )}\n                %\n              </span>\n            </div>\n            <div className='w-full h-2.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden'>\n              <div\n                className='h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-full transition-all duration-500 ease-out shadow-lg'\n                style={{\n                  width: `${Math.min(100, (totalQuestions / Math.max(dailyQuestions * duration, 1)) * 100)}%`,\n                }}\n              />\n            </div>\n          </div>\n\n          {/* Quick Stats with Icons */}\n          <div className='space-y-2.5'>\n            <div className='flex items-center justify-between p-3 bg-gradient-to-r from-indigo-50/50 to-purple-50/50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-xl border border-indigo-100 dark:border-indigo-800/50 transition-all duration-200 hover:border-indigo-300 dark:hover:border-indigo-600 hover:shadow-md'>\n              <div className='flex items-center space-x-2'>\n                <Clock className='w-4 h-4 text-indigo-600 dark:text-indigo-400' />\n                <span className='text-xs text-gray-600 dark:text-gray-400 font-medium'>\n                  Duration:\n                </span>\n              </div>\n              <span className='text-sm font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent dark:from-indigo-400 dark:to-purple-400'>\n                {duration} days\n              </span>\n            </div>\n            <div className='flex items-center justify-between p-3 bg-gradient-to-r from-purple-50/50 to-pink-50/50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl border border-purple-100 dark:border-purple-800/50 transition-all duration-200 hover:border-purple-300 dark:hover:border-purple-600 hover:shadow-md'>\n              <div className='flex items-center space-x-2'>\n                <Target className='w-4 h-4 text-purple-600 dark:text-purple-400' />\n                <span className='text-xs text-gray-600 dark:text-gray-400 font-medium'>\n                  Daily Goal:\n                </span>\n              </div>\n              <span className='text-sm font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent dark:from-purple-400 dark:to-pink-400'>\n                {dailyQuestions} {dailyQuestions === 1 ? 'Q' : 'Qs'}/day\n              </span>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Question Details Modal */}\n      {selectedQuestionId && (\n        <div className='fixed inset-0 bg-black/50 dark:bg-black/70 z-50 flex items-center justify-center p-4'>\n          <div className='bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col'>\n            {/* Modal Header */}\n            <div className='flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700'>\n              <h2 className='text-2xl font-bold text-gray-900 dark:text-white'>\n                Question Details\n              </h2>\n              <button\n                onClick={handleCloseModal}\n                className='p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors'\n                aria-label='Close modal'\n              >\n                <X className='w-5 h-5 text-gray-600 dark:text-gray-400' />\n              </button>\n            </div>\n\n            {/* Modal Content */}\n            <div className='flex-1 overflow-y-auto p-6'>\n              {isLoadingQuestionDetails ? (\n                <div className='flex items-center justify-center py-12'>\n                  <Loader2 className='w-8 h-8 animate-spin text-indigo-600' />\n                  <span className='ml-3 text-gray-600 dark:text-gray-400'>\n                    Loading question details...\n                  </span>\n                </div>\n              ) : questionDetails ? (\n                <div className='space-y-6'>\n                  {/* Question Text */}\n                  <div>\n                    <h3 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-2'>\n                      Question\n                    </h3>\n                    <p className='text-lg text-gray-900 dark:text-white'>\n                      {questionDetails.question_text ||\n                        questionDetails.question ||\n                        questionDetails.title ||\n                        'No question text available'}\n                    </p>\n                  </div>\n\n                  {/* Question Metadata */}\n                  <div className='grid grid-cols-2 md:grid-cols-4 gap-4'>\n                    <div>\n                      <h4 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-1'>\n                        Difficulty\n                      </h4>\n                      <span\n                        className={`inline-block px-3 py-1 rounded-lg text-sm font-medium ${\n                          questionDetails.difficulty === 'easy' ||\n                          questionDetails.difficulty === 'Easy'\n                            ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400'\n                            : questionDetails.difficulty === 'medium' ||\n                                questionDetails.difficulty === 'Medium'\n                              ? 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400'\n                              : 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'\n                        }`}\n                      >\n                        {questionDetails.difficulty || 'N/A'}\n                      </span>\n                    </div>\n                    <div>\n                      <h4 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-1'>\n                        Type\n                      </h4>\n                      <p className='text-sm text-gray-900 dark:text-white'>\n                        {questionDetails.question_type ||\n                          questionDetails.type ||\n                          'N/A'}\n                      </p>\n                    </div>\n                    {questionDetails.estimated_time && (\n                      <div>\n                        <h4 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-1'>\n                          Time\n                        </h4>\n                        <p className='text-sm text-gray-900 dark:text-white'>\n                          {questionDetails.estimated_time}\n                        </p>\n                      </div>\n                    )}\n                    {(questionDetails.points ||\n                      questionDetails.point_value) && (\n                      <div>\n                        <h4 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-1'>\n                          Points\n                        </h4>\n                        <p className='text-sm text-gray-900 dark:text-white'>\n                          {questionDetails.points ||\n                            questionDetails.point_value ||\n                            0}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Options (if multiple choice) */}\n                  {questionDetails.options &&\n                    Array.isArray(questionDetails.options) &&\n                    questionDetails.options.length > 0 && (\n                      <div>\n                        <h3 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-3'>\n                          Options\n                        </h3>\n                        <div className='space-y-2'>\n                          {}\n                          {questionDetails.options.map(\n                            (option: any, index: number) => {\n                              // Handle both string options and object options (with id, text, isCorrect)\n                              const optionText =\n                                typeof option === 'string'\n                                  ? option\n                                  : option?.text ||\n                                    option?.label ||\n                                    option?.option ||\n                                    JSON.stringify(option);\n                              const optionId =\n                                typeof option === 'object'\n                                  ? option?.id\n                                  : undefined;\n                              const isCorrect =\n                                typeof option === 'object'\n                                  ? option?.isCorrect === true ||\n                                    option?.is_correct === true\n                                  : option === questionDetails.correct_answer ||\n                                    option === questionDetails.correctAnswer;\n\n                              return (\n                                <div\n                                  key={optionId || index}\n                                  className={`p-3 rounded-lg border-2 ${\n                                    isCorrect\n                                      ? 'border-green-500 bg-green-50 dark:bg-green-900/20'\n                                      : 'border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50'\n                                  }`}\n                                >\n                                  <div className='flex items-start space-x-2'>\n                                    <span className='font-medium text-gray-600 dark:text-gray-400'>\n                                      {String.fromCharCode(65 + index)}.\n                                    </span>\n                                    <span className='text-gray-900 dark:text-white flex-1'>\n                                      {optionText}\n                                    </span>\n                                    {isCorrect && (\n                                      <Check className='w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0' />\n                                    )}\n                                  </div>\n                                </div>\n                              );\n                            }\n                          )}\n                        </div>\n                      </div>\n                    )}\n\n                  {/* Correct Answer */}\n                  {(questionDetails.correct_answer ||\n                    questionDetails.correctAnswer) && (\n                    <div>\n                      <h3 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-2'>\n                        Correct Answer\n                      </h3>\n                      <div className='p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg'>\n                        <p className='text-green-900 dark:text-green-100 font-medium'>\n                          {questionDetails.correct_answer ||\n                            questionDetails.correctAnswer}\n                        </p>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Explanation */}\n                  {questionDetails.explanation && (\n                    <div>\n                      <h3 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-2'>\n                        Explanation\n                      </h3>\n                      <div className='p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg'>\n                        <p className='text-gray-900 dark:text-white'>\n                          {questionDetails.explanation}\n                        </p>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Tags */}\n                  {questionDetails.tags &&\n                    Array.isArray(questionDetails.tags) &&\n                    questionDetails.tags.length > 0 && (\n                      <div>\n                        <h3 className='text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase mb-2'>\n                          Tags\n                        </h3>\n                        <div className='flex flex-wrap gap-2'>\n                          {questionDetails.tags.map(\n                            (tag: string, index: number) => (\n                              <span\n                                key={index}\n                                className='px-3 py-1 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded-full text-sm'\n                              >\n                                {tag}\n                              </span>\n                            )\n                          )}\n                        </div>\n                      </div>\n                    )}\n                </div>\n              ) : (\n                <div className='text-center py-12'>\n                  <AlertCircle className='w-12 h-12 text-red-500 mx-auto mb-4' />\n                  <p className='text-gray-600 dark:text-gray-400'>\n                    Failed to load question details\n                  </p>\n                </div>\n              )}\n            </div>\n\n            {/* Modal Footer */}\n            <div className='border-t border-gray-200 dark:border-gray-700 p-6 flex justify-end'>\n              <button\n                onClick={handleCloseModal}\n                className='px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold transition-colors'\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Sign-in Popup */}\n      {/* Sign-in Popup - Redirected to /auth page instead */}\n    </div>\n  );\n}\n"],"names":["CustomRoadmapPage","router","useRouter","isAuthenticated","authIsAuthenticated","user","isLoading","authIsLoading","useAuth","setUserType","useUserType","setLearningType","useLearningType","setIsAuthenticated","useState","authCheckComplete","setAuthCheckComplete","useEffect","authCheckDone","checkAuth","console","log","window","authToken","localStorage","getItem","frontendUser","commonAuthKeys","key","value","sessionStorage","parsed","JSON","parse","e","warn","safetyTimeout","setTimeout","handleStorageChange","addEventListener","handleAuthStateChange","clearTimeout","removeEventListener","setIsLoading","isSaving","setIsSaving","currentStep","setCurrentStep","planName","setPlanName","planDescription","setPlanDescription","duration","setDuration","cards","setCards","selectedCards","setSelectedCards","Set","sections","setSections","selectedSections","setSelectedSections","expandedCard","setExpandedCard","expandedCategory","setExpandedCategory","expandedTopic","setExpandedTopic","hasCheckedAuth","setHasCheckedAuth","error","setError","hasTriedLoadForStep2","useRef","selectedQuestionId","setSelectedQuestionId","questionDetails","setQuestionDetails","isLoadingQuestionDetails","setIsLoadingQuestionDetails","isSummaryVisible","setIsSummaryVisible","loadSections","useCallback","timeoutId","location","origin","href","cardsUrl","fetchPromise","fetch","method","headers","cache","Promise","cardsResponse","status","ok","Object","fromEntries","entries","cardsFromAPI","cardsData","json","Array","isArray","data","length","predefinedCardTypes","beforeFilter","filter","card","matches","includes","type","title","id","sort","a","b","orderA","order_index","order","orderB","errorText","text","catch","Error","categoriesFromAPI","categoriesResponse","categoriesData","categories","categoriesError","topicsFromAPI","topicsResponse","topicsData","topics","topicsError","allQuestions","questionsResponse","questionsData","questions","questionsError","transformedCards","map","cardCategories","cat","learning_card_id","name","categoryCardType","card_type","cardType","cardTypeMapping","possibleTypeNames","some","typeName","toLowerCase","cardTitleWords","split","categoryNameLower","word","transformedCategories","category","categoryTopics","topic","category_id","categoryId","transformedTopics","topicQuestions","q","matchesTopicId","topic_id","topicId","learning_topic_id","learningTopicId","question","question_text","difficulty","estimatedTime","estimated_time","points","point_value","description","isSelected","selectedQuestions","directCategoryQuestions","matchesCategory","learning_category_id","learningCategoryId","hasNoTopic","push","selectedTopics","transformedCard","selectedCategories","totalTopics","reduce","sum","totalQuestions","topicSum","c","categoriesCount","errorMessage","message","String","checkAuthAndRedirect","removeItem","loadPromise","then","syncError","setItem","cardsCount","hasPendingIntent","timeout","cardsLength","hasTriedLoad","current","loadSectionsDefined","currentStepNot2","notAuthenticated","hasCards","handleCardToggle","cardId","prev","newIsSelected","updatedCategories","updatedTopics","allQuestionIds","allTopicIds","t","newSelectedCards","has","delete","add","handleCategoryToggle","handleTopicToggle","newSelectedTopics","find","handleQuestionToggleCard","questionId","newSelectedQuestions","handleQuestionToggle","sectionId","question_id","section","handleSectionToggle","newSelectedSections","handleSelectAllQuestions","handleClearAllQuestions","fetchQuestionDetails","response","questionData","options","tags","handleViewQuestion","stopPropagation","handleCloseModal","calculatePlanStats","forEach","selectedSectionsData","legacyTotalQuestions","Math","max","dailyQuestions","ceil","handleSavePlan","trim","alert","hasSelectedQuestions","totalSelectedQuestions","selectedCardsForPlan","selectedCategoriesForCard","size","selectedTopicsForCategory","totalSelectedQuestionsFromCards","plan","Date","now","created_at","existingPlans","stringify","err","div","className","Loader2","p","Target","style","animationDuration","h1","step","Check","h2","label","input","onChange","target","placeholder","textarea","rows","button","onClick","Minus","parseInt","min","Plus","disabled","AlertCircle","ChevronDown","ChevronRight","h3","h4","span","checked","Eye","round","total","h5","h6","cardIndex","findIndex","categoryIndex","topicIndex","X","Save","aria-label","PanelRightClose","PanelRightOpen","width","background","backgroundSize","animation","Clock","Zap","BookOpen","question_type","option","index","optionText","optionId","undefined","isCorrect","is_correct","correct_answer","correctAnswer","fromCharCode","explanation","tag"],"mappings":"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"}