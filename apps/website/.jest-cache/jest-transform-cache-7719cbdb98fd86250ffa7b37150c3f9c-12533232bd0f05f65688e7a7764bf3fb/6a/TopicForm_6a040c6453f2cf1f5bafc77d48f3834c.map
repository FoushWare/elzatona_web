{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/libs/shared-components/src/lib/forms/TopicForm.tsx"],"sourcesContent":["// Topic Form Component\n// v1.0 - Form for creating and editing topics\n\n'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env['NEXT_PUBLIC_SUPABASE_URL']!;\nconst supabaseServiceRoleKey = process.env['SUPABASE_SERVICE_ROLE_KEY']!;\nconst supabase = createClient(supabaseUrl, supabaseServiceRoleKey);\n\nimport { Button } from '@elzatona/shared-components';\nimport { Input } from '@elzatona/shared-components';\nimport { Label } from '@elzatona/shared-components';\nimport { Textarea } from '@elzatona/shared-components';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@elzatona/shared-components';\n\ninterface TopicFormProps {\n  topic?: {\n    id: string;\n    name: string;\n    description?: string;\n    categoryId?: string;\n    difficulty?: string;\n    estimatedQuestions?: number;\n    slug?: string;\n    order?: number;\n  };\n  categories: Array<{ id: string; name: string }>;\n  onSubmit: (data: TopicFormData) => Promise<void>;\n  onCancel: () => void;\n  isLoading?: boolean;\n}\n\nexport interface TopicFormData {\n  name: string;\n  description: string;\n  categoryId: string;\n  difficulty: string;\n  estimatedQuestions: number;\n  slug: string;\n  order: number;\n}\n\nconst DIFFICULTIES = [\n  { value: 'beginner', label: 'Beginner' },\n  { value: 'intermediate', label: 'Intermediate' },\n  { value: 'advanced', label: 'Advanced' },\n];\n\nexport const TopicForm: React.FC<TopicFormProps> = ({\n  topic,\n  categories,\n  onSubmit,\n  onCancel,\n  isLoading = false,\n}) => {\n  const [formData, setFormData] = useState<TopicFormData>({\n    name: topic?.name || '',\n    description: topic?.description || '',\n    categoryId: topic?.categoryId || categories[0]?.id || '',\n    difficulty: topic?.difficulty || 'beginner',\n    estimatedQuestions: topic?.estimatedQuestions || 10,\n    slug: topic?.slug || '',\n    order: topic?.order || 1,\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Auto-generate slug from name\n  useEffect(() => {\n    if (!topic && formData.name) {\n      const slug = formData.name\n        .toLowerCase()\n        .replace(/[^a-z0-9]+/g, '-')\n        .replace(/(^-|-$)/g, '');\n      setFormData(prev => ({ ...prev, slug }));\n    }\n  }, [formData.name, topic]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData['name'].trim()) {\n      newErrors['name'] = 'Topic name is required';\n    }\n\n    if (!formData['description'].trim()) {\n      newErrors['description'] = 'Description is required';\n    }\n\n    if (!formData['categoryId']) {\n      newErrors['categoryId'] = 'Category is required';\n    }\n\n    if (!formData['slug'].trim()) {\n      newErrors['slug'] = 'Slug is required';\n    }\n\n    if (formData['estimatedQuestions'] < 1) {\n      newErrors['estimatedQuestions'] =\n        'Estimated questions must be at least 1';\n    }\n\n    if (formData['order'] < 1) {\n      newErrors['order'] = 'Order must be at least 1';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!validateForm()) {\n      return;\n    }\n\n    try {\n      await onSubmit(formData);\n    } catch (error) {\n      console.error('Error submitting topic:', error);\n    }\n  };\n\n  const handleChange = (field: keyof TopicFormData, value: string | number) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => ({ ...prev, [field]: '' }));\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className='space-y-6'>\n      <div className='grid grid-cols-1 md:grid-cols-2 gap-4'>\n        {/* Name */}\n        <div className='space-y-2'>\n          <Label htmlFor='name'>Topic Name *</Label>\n          <Input\n            id='name'\n            value={formData['name']}\n            onChange={e => handleChange('name', e.target.value)}\n            placeholder='e.g., React Hooks'\n            className={errors['name'] ? 'border-red-500' : ''}\n          />\n          {errors['name'] && (\n            <p className='text-sm text-red-500'>{errors['name']}</p>\n          )}\n        </div>\n\n        {/* Slug */}\n        <div className='space-y-2'>\n          <Label htmlFor='slug'>Slug *</Label>\n          <Input\n            id='slug'\n            value={formData['slug']}\n            onChange={e => handleChange('slug', e.target.value)}\n            placeholder='e.g., react-hooks'\n            className={errors['slug'] ? 'border-red-500' : ''}\n          />\n          {errors['slug'] && (\n            <p className='text-sm text-red-500'>{errors['slug']}</p>\n          )}\n        </div>\n\n        {/* Category */}\n        <div className='space-y-2'>\n          <Label htmlFor='categoryId'>Category *</Label>\n          <Select\n            value={formData['categoryId']}\n            onValueChange={value => handleChange('categoryId', value)}\n          >\n            <SelectTrigger\n              className={errors['categoryId'] ? 'border-red-500' : ''}\n            >\n              <SelectValue placeholder='Select category' />\n            </SelectTrigger>\n            <SelectContent>\n              {categories.map(category => (\n                <SelectItem key={category.id} value={category.id}>\n                  {category.name}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n          {errors['categoryId'] && (\n            <p className='text-sm text-red-500'>{errors['categoryId']}</p>\n          )}\n        </div>\n\n        {/* Difficulty */}\n        <div className='space-y-2'>\n          <Label htmlFor='difficulty'>Difficulty</Label>\n          <Select\n            value={formData['difficulty']}\n            onValueChange={value => handleChange('difficulty', value)}\n          >\n            <SelectTrigger>\n              <SelectValue placeholder='Select difficulty' />\n            </SelectTrigger>\n            <SelectContent>\n              {DIFFICULTIES.map(difficulty => (\n                <SelectItem key={difficulty.value} value={difficulty.value}>\n                  {difficulty.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        {/* Estimated Questions */}\n        <div className='space-y-2'>\n          <Label htmlFor='estimatedQuestions'>Estimated Questions</Label>\n          <Input\n            id='estimatedQuestions'\n            type='number'\n            min='1'\n            value={formData['estimatedQuestions']}\n            onChange={e =>\n              handleChange('estimatedQuestions', parseInt(e.target.value) || 1)\n            }\n            className={errors['estimatedQuestions'] ? 'border-red-500' : ''}\n          />\n          {errors['estimatedQuestions'] && (\n            <p className='text-sm text-red-500'>\n              {errors['estimatedQuestions']}\n            </p>\n          )}\n        </div>\n\n        {/* Order */}\n        <div className='space-y-2'>\n          <Label htmlFor='order'>Order</Label>\n          <Input\n            id='order'\n            type='number'\n            min='1'\n            value={formData['order']}\n            onChange={e => handleChange('order', parseInt(e.target.value) || 1)}\n            className={errors['order'] ? 'border-red-500' : ''}\n          />\n          {errors['order'] && (\n            <p className='text-sm text-red-500'>{errors['order']}</p>\n          )}\n        </div>\n      </div>\n\n      {/* Description */}\n      <div className='space-y-2'>\n        <Label htmlFor='description'>Description *</Label>\n        <Textarea\n          id='description'\n          value={formData['description']}\n          onChange={e => handleChange('description', e.target.value)}\n          placeholder='Describe what this topic covers...'\n          rows={3}\n          className={errors['description'] ? 'border-red-500' : ''}\n        />\n        {errors['description'] && (\n          <p className='text-sm text-red-500'>{errors['description']}</p>\n        )}\n      </div>\n\n      {/* Actions */}\n      <div className='flex justify-end gap-3 pt-4'>\n        <Button type='button' variant='outline' onClick={onCancel}>\n          Cancel\n        </Button>\n        <Button type='submit' disabled={isLoading}>\n          {isLoading ? 'Saving...' : topic ? 'Update Topic' : 'Create Topic'}\n        </Button>\n      </div>\n    </form>\n  );\n};\n"],"names":["TopicForm","supabaseUrl","process","env","supabaseServiceRoleKey","supabase","createClient","DIFFICULTIES","value","label","topic","categories","onSubmit","onCancel","isLoading","formData","setFormData","useState","name","description","categoryId","id","difficulty","estimatedQuestions","slug","order","errors","setErrors","useEffect","toLowerCase","replace","prev","validateForm","newErrors","trim","Object","keys","length","handleSubmit","e","preventDefault","error","console","handleChange","field","form","className","div","Label","htmlFor","Input","onChange","target","placeholder","p","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","map","category","SelectItem","type","min","parseInt","Textarea","rows","Button","variant","onClick","disabled"],"mappings":"AAAA,uBAAuB;AACvB,8CAA8C;AAE9C;;;;;+BAsDaA;;;eAAAA;;;;+DApD8B;4BACd;kCAMN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAJvB,MAAMC,cAAcC,QAAQC,GAAG,CAAC,2BAA2B;AAC3D,MAAMC,yBAAyBF,QAAQC,GAAG,CAAC,4BAA4B;AACvE,MAAME,WAAWC,IAAAA,wBAAY,EAACL,aAAaG;AAyC3C,MAAMG,eAAe;IACnB;QAAEC,OAAO;QAAYC,OAAO;IAAW;IACvC;QAAED,OAAO;QAAgBC,OAAO;IAAe;IAC/C;QAAED,OAAO;QAAYC,OAAO;IAAW;CACxC;AAEM,MAAMT,YAAsC,CAAC,EAClDU,KAAK,EACLC,UAAU,EACVC,QAAQ,EACRC,QAAQ,EACRC,YAAY,KAAK,EAClB;IACC,MAAM,CAACC,UAAUC,YAAY,GAAGC,IAAAA,eAAQ,EAAgB;QACtDC,MAAMR,OAAOQ,QAAQ;QACrBC,aAAaT,OAAOS,eAAe;QACnCC,YAAYV,OAAOU,cAAcT,UAAU,CAAC,EAAE,EAAEU,MAAM;QACtDC,YAAYZ,OAAOY,cAAc;QACjCC,oBAAoBb,OAAOa,sBAAsB;QACjDC,MAAMd,OAAOc,QAAQ;QACrBC,OAAOf,OAAOe,SAAS;IACzB;IAEA,MAAM,CAACC,QAAQC,UAAU,GAAGV,IAAAA,eAAQ,EAAyB,CAAC;IAE9D,+BAA+B;IAC/BW,IAAAA,gBAAS,EAAC;QACR,IAAI,CAAClB,SAASK,SAASG,IAAI,EAAE;YAC3B,MAAMM,OAAOT,SAASG,IAAI,CACvBW,WAAW,GACXC,OAAO,CAAC,eAAe,KACvBA,OAAO,CAAC,YAAY;YACvBd,YAAYe,CAAAA,OAAS,CAAA;oBAAE,GAAGA,IAAI;oBAAEP;gBAAK,CAAA;QACvC;IACF,GAAG;QAACT,SAASG,IAAI;QAAER;KAAM;IAEzB,MAAMsB,eAAe;QACnB,MAAMC,YAAoC,CAAC;QAE3C,IAAI,CAAClB,QAAQ,CAAC,OAAO,CAACmB,IAAI,IAAI;YAC5BD,SAAS,CAAC,OAAO,GAAG;QACtB;QAEA,IAAI,CAAClB,QAAQ,CAAC,cAAc,CAACmB,IAAI,IAAI;YACnCD,SAAS,CAAC,cAAc,GAAG;QAC7B;QAEA,IAAI,CAAClB,QAAQ,CAAC,aAAa,EAAE;YAC3BkB,SAAS,CAAC,aAAa,GAAG;QAC5B;QAEA,IAAI,CAAClB,QAAQ,CAAC,OAAO,CAACmB,IAAI,IAAI;YAC5BD,SAAS,CAAC,OAAO,GAAG;QACtB;QAEA,IAAIlB,QAAQ,CAAC,qBAAqB,GAAG,GAAG;YACtCkB,SAAS,CAAC,qBAAqB,GAC7B;QACJ;QAEA,IAAIlB,QAAQ,CAAC,QAAQ,GAAG,GAAG;YACzBkB,SAAS,CAAC,QAAQ,GAAG;QACvB;QAEAN,UAAUM;QACV,OAAOE,OAAOC,IAAI,CAACH,WAAWI,MAAM,KAAK;IAC3C;IAEA,MAAMC,eAAe,OAAOC;QAC1BA,EAAEC,cAAc;QAEhB,IAAI,CAACR,gBAAgB;YACnB;QACF;QAEA,IAAI;YACF,MAAMpB,SAASG;QACjB,EAAE,OAAO0B,OAAO;YACdC,QAAQD,KAAK,CAAC,2BAA2BA;QAC3C;IACF;IAEA,MAAME,eAAe,CAACC,OAA4BpC;QAChDQ,YAAYe,CAAAA,OAAS,CAAA;gBAAE,GAAGA,IAAI;gBAAE,CAACa,MAAM,EAAEpC;YAAM,CAAA;QAC/C,sCAAsC;QACtC,IAAIkB,MAAM,CAACkB,MAAM,EAAE;YACjBjB,UAAUI,CAAAA,OAAS,CAAA;oBAAE,GAAGA,IAAI;oBAAE,CAACa,MAAM,EAAE;gBAAG,CAAA;QAC5C;IACF;IAEA,qBACE,sBAACC;QAAKjC,UAAU0B;QAAcQ,WAAU;;0BACtC,sBAACC;gBAAID,WAAU;;kCAEb,sBAACC;wBAAID,WAAU;;0CACb,qBAACE,uBAAK;gCAACC,SAAQ;0CAAO;;0CACtB,qBAACC,uBAAK;gCACJ7B,IAAG;gCACHb,OAAOO,QAAQ,CAAC,OAAO;gCACvBoC,UAAUZ,CAAAA,IAAKI,aAAa,QAAQJ,EAAEa,MAAM,CAAC5C,KAAK;gCAClD6C,aAAY;gCACZP,WAAWpB,MAAM,CAAC,OAAO,GAAG,mBAAmB;;4BAEhDA,MAAM,CAAC,OAAO,kBACb,qBAAC4B;gCAAER,WAAU;0CAAwBpB,MAAM,CAAC,OAAO;;;;kCAKvD,sBAACqB;wBAAID,WAAU;;0CACb,qBAACE,uBAAK;gCAACC,SAAQ;0CAAO;;0CACtB,qBAACC,uBAAK;gCACJ7B,IAAG;gCACHb,OAAOO,QAAQ,CAAC,OAAO;gCACvBoC,UAAUZ,CAAAA,IAAKI,aAAa,QAAQJ,EAAEa,MAAM,CAAC5C,KAAK;gCAClD6C,aAAY;gCACZP,WAAWpB,MAAM,CAAC,OAAO,GAAG,mBAAmB;;4BAEhDA,MAAM,CAAC,OAAO,kBACb,qBAAC4B;gCAAER,WAAU;0CAAwBpB,MAAM,CAAC,OAAO;;;;kCAKvD,sBAACqB;wBAAID,WAAU;;0CACb,qBAACE,uBAAK;gCAACC,SAAQ;0CAAa;;0CAC5B,sBAACM,wBAAM;gCACL/C,OAAOO,QAAQ,CAAC,aAAa;gCAC7ByC,eAAehD,CAAAA,QAASmC,aAAa,cAAcnC;;kDAEnD,qBAACiD,+BAAa;wCACZX,WAAWpB,MAAM,CAAC,aAAa,GAAG,mBAAmB;kDAErD,cAAA,qBAACgC,6BAAW;4CAACL,aAAY;;;kDAE3B,qBAACM,+BAAa;kDACXhD,WAAWiD,GAAG,CAACC,CAAAA,yBACd,qBAACC,4BAAU;gDAAmBtD,OAAOqD,SAASxC,EAAE;0DAC7CwC,SAAS3C,IAAI;+CADC2C,SAASxC,EAAE;;;;4BAMjCK,MAAM,CAAC,aAAa,kBACnB,qBAAC4B;gCAAER,WAAU;0CAAwBpB,MAAM,CAAC,aAAa;;;;kCAK7D,sBAACqB;wBAAID,WAAU;;0CACb,qBAACE,uBAAK;gCAACC,SAAQ;0CAAa;;0CAC5B,sBAACM,wBAAM;gCACL/C,OAAOO,QAAQ,CAAC,aAAa;gCAC7ByC,eAAehD,CAAAA,QAASmC,aAAa,cAAcnC;;kDAEnD,qBAACiD,+BAAa;kDACZ,cAAA,qBAACC,6BAAW;4CAACL,aAAY;;;kDAE3B,qBAACM,+BAAa;kDACXpD,aAAaqD,GAAG,CAACtC,CAAAA,2BAChB,qBAACwC,4BAAU;gDAAwBtD,OAAOc,WAAWd,KAAK;0DACvDc,WAAWb,KAAK;+CADFa,WAAWd,KAAK;;;;;;kCASzC,sBAACuC;wBAAID,WAAU;;0CACb,qBAACE,uBAAK;gCAACC,SAAQ;0CAAqB;;0CACpC,qBAACC,uBAAK;gCACJ7B,IAAG;gCACH0C,MAAK;gCACLC,KAAI;gCACJxD,OAAOO,QAAQ,CAAC,qBAAqB;gCACrCoC,UAAUZ,CAAAA,IACRI,aAAa,sBAAsBsB,SAAS1B,EAAEa,MAAM,CAAC5C,KAAK,KAAK;gCAEjEsC,WAAWpB,MAAM,CAAC,qBAAqB,GAAG,mBAAmB;;4BAE9DA,MAAM,CAAC,qBAAqB,kBAC3B,qBAAC4B;gCAAER,WAAU;0CACVpB,MAAM,CAAC,qBAAqB;;;;kCAMnC,sBAACqB;wBAAID,WAAU;;0CACb,qBAACE,uBAAK;gCAACC,SAAQ;0CAAQ;;0CACvB,qBAACC,uBAAK;gCACJ7B,IAAG;gCACH0C,MAAK;gCACLC,KAAI;gCACJxD,OAAOO,QAAQ,CAAC,QAAQ;gCACxBoC,UAAUZ,CAAAA,IAAKI,aAAa,SAASsB,SAAS1B,EAAEa,MAAM,CAAC5C,KAAK,KAAK;gCACjEsC,WAAWpB,MAAM,CAAC,QAAQ,GAAG,mBAAmB;;4BAEjDA,MAAM,CAAC,QAAQ,kBACd,qBAAC4B;gCAAER,WAAU;0CAAwBpB,MAAM,CAAC,QAAQ;;;;;;0BAM1D,sBAACqB;gBAAID,WAAU;;kCACb,qBAACE,uBAAK;wBAACC,SAAQ;kCAAc;;kCAC7B,qBAACiB,0BAAQ;wBACP7C,IAAG;wBACHb,OAAOO,QAAQ,CAAC,cAAc;wBAC9BoC,UAAUZ,CAAAA,IAAKI,aAAa,eAAeJ,EAAEa,MAAM,CAAC5C,KAAK;wBACzD6C,aAAY;wBACZc,MAAM;wBACNrB,WAAWpB,MAAM,CAAC,cAAc,GAAG,mBAAmB;;oBAEvDA,MAAM,CAAC,cAAc,kBACpB,qBAAC4B;wBAAER,WAAU;kCAAwBpB,MAAM,CAAC,cAAc;;;;0BAK9D,sBAACqB;gBAAID,WAAU;;kCACb,qBAACsB,wBAAM;wBAACL,MAAK;wBAASM,SAAQ;wBAAUC,SAASzD;kCAAU;;kCAG3D,qBAACuD,wBAAM;wBAACL,MAAK;wBAASQ,UAAUzD;kCAC7BA,YAAY,cAAcJ,QAAQ,iBAAiB;;;;;;AAK9D"}