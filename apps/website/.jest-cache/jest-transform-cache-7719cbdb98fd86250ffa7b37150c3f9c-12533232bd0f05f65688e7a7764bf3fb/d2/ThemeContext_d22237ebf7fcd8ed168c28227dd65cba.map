{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/libs/shared-contexts/src/lib/ThemeContext.tsx"],"sourcesContent":["'use client';\n\nimport React, {\n  useState,\n  useEffect,\n  ReactNode,\n  createContext,\n  useContext,\n} from 'react';\n\n// Only create Supabase client if environment variables are available\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nlet supabase: any = null;\nif (\n  process.env['NEXT_PUBLIC_SUPABASE_URL'] &&\n  process.env['SUPABASE_SERVICE_ROLE_KEY']\n) {\n  // eslint-disable-next-line @typescript-eslint/no-require-imports\n  const { createClient } = require('@supabase/supabase-js');\n  const supabaseUrl = process.env['NEXT_PUBLIC_SUPABASE_URL'];\n  const supabaseServiceRoleKey = process.env['SUPABASE_SERVICE_ROLE_KEY'];\n  supabase = createClient(supabaseUrl, supabaseServiceRoleKey);\n}\n\ninterface ThemeContextType {\n  isDarkMode: boolean;\n  toggleDarkMode: () => void;\n  setDarkMode: (dark: boolean) => void;\n  isLoaded: boolean;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  // Always start with dark mode to prevent hydration mismatch\n  // This matches the default theme preference\n  const [isDarkMode, setIsDarkMode] = useState(true);\n  const [isLoaded, setIsLoaded] = useState(false);\n\n  useEffect(() => {\n    // Load theme preference from localStorage on mount (client-side only)\n    let theme = true; // default to dark to prevent hydration mismatch\n\n    if (typeof window !== 'undefined') {\n      const savedTheme = localStorage.getItem('theme');\n      if (savedTheme) {\n        theme = savedTheme === 'dark';\n      } else {\n        // Default to dark mode if no preference saved\n        theme = true;\n        localStorage.setItem('theme', 'dark');\n      }\n\n      // Debug logging\n      console.log(\n        'ThemeContext: Initial theme loaded:',\n        savedTheme || 'dark (default)'\n      );\n    }\n\n    // Only update if different from initial state to prevent flashing\n    if (theme !== isDarkMode) {\n      setIsDarkMode(theme);\n    }\n    setIsLoaded(true);\n  }, []); // Remove isDarkMode dependency to prevent infinite loop\n\n  useEffect(() => {\n    // Only run after initial load to prevent hydration mismatch\n    if (!isLoaded) return;\n\n    // Save theme preference to localStorage whenever it changes (client-side only)\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');\n    }\n\n    // Apply theme class to document root with proper cleanup (client-side only)\n    if (typeof document !== 'undefined') {\n      const root = document.documentElement;\n\n      if (isDarkMode) {\n        root.classList.remove('light');\n        root.classList.add('dark');\n        // Also set data attribute for additional CSS targeting\n        root.setAttribute('data-theme', 'dark');\n      } else {\n        root.classList.remove('dark');\n        root.classList.add('light');\n        // Also set data attribute for additional CSS targeting\n        root.setAttribute('data-theme', 'light');\n      }\n\n      // Debug logging\n      console.log(\n        'ThemeContext: Theme applied:',\n        isDarkMode ? 'dark' : 'light'\n      );\n      console.log('ThemeContext: Root classes:', root.className);\n    }\n  }, [isDarkMode, isLoaded]);\n\n  const toggleDarkMode = () => {\n    const newMode = !isDarkMode;\n    setIsDarkMode(newMode);\n    console.log('ThemeContext: Theme toggled to:', newMode ? 'dark' : 'light');\n  };\n\n  const setDarkMode = (dark: boolean) => {\n    setIsDarkMode(dark);\n  };\n\n  const value = { isDarkMode, toggleDarkMode, setDarkMode, isLoaded };\n\n  return React.createElement(ThemeContext.Provider, { value }, children);\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (context === undefined) {\n    throw new Error('useTheme must be used within a ThemeProvider');\n  }\n  return context;\n}\n\n// Export the context for direct usage if needed\nexport { ThemeContext };\n"],"names":["ThemeContext","ThemeProvider","useTheme","supabase","process","env","createClient","require","supabaseUrl","supabaseServiceRoleKey","createContext","undefined","children","isDarkMode","setIsDarkMode","useState","isLoaded","setIsLoaded","useEffect","theme","window","savedTheme","localStorage","getItem","setItem","console","log","document","root","documentElement","classList","remove","add","setAttribute","className","toggleDarkMode","newMode","setDarkMode","dark","value","React","createElement","Provider","context","useContext","Error"],"mappings":"AAAA;;;;;;;;;;;;QA6HSA;eAAAA;;QA5FOC;eAAAA;;QAmFAC;eAAAA;;;+DA5GT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEP,qEAAqE;AACrE,8DAA8D;AAC9D,IAAIC,WAAgB;AACpB,IACEC,QAAQC,GAAG,CAAC,2BAA2B,IACvCD,QAAQC,GAAG,CAAC,4BAA4B,EACxC;IACA,iEAAiE;IACjE,MAAM,EAAEC,YAAY,EAAE,GAAGC,QAAQ;IACjC,MAAMC,cAAcJ,QAAQC,GAAG,CAAC,2BAA2B;IAC3D,MAAMI,yBAAyBL,QAAQC,GAAG,CAAC,4BAA4B;IACvEF,WAAWG,aAAaE,aAAaC;AACvC;AASA,MAAMT,6BAAeU,IAAAA,oBAAa,EAA+BC;AAE1D,SAASV,cAAc,EAAEW,QAAQ,EAAiC;IACvE,4DAA4D;IAC5D,4CAA4C;IAC5C,MAAM,CAACC,YAAYC,cAAc,GAAGC,IAAAA,eAAQ,EAAC;IAC7C,MAAM,CAACC,UAAUC,YAAY,GAAGF,IAAAA,eAAQ,EAAC;IAEzCG,IAAAA,gBAAS,EAAC;QACR,sEAAsE;QACtE,IAAIC,QAAQ,MAAM,gDAAgD;QAElE,IAAI,OAAOC,WAAW,aAAa;YACjC,MAAMC,aAAaC,aAAaC,OAAO,CAAC;YACxC,IAAIF,YAAY;gBACdF,QAAQE,eAAe;YACzB,OAAO;gBACL,8CAA8C;gBAC9CF,QAAQ;gBACRG,aAAaE,OAAO,CAAC,SAAS;YAChC;YAEA,gBAAgB;YAChBC,QAAQC,GAAG,CACT,uCACAL,cAAc;QAElB;QAEA,kEAAkE;QAClE,IAAIF,UAAUN,YAAY;YACxBC,cAAcK;QAChB;QACAF,YAAY;IACd,GAAG,EAAE,GAAG,wDAAwD;IAEhEC,IAAAA,gBAAS,EAAC;QACR,4DAA4D;QAC5D,IAAI,CAACF,UAAU;QAEf,+EAA+E;QAC/E,IAAI,OAAOI,WAAW,aAAa;YACjCE,aAAaE,OAAO,CAAC,SAASX,aAAa,SAAS;QACtD;QAEA,4EAA4E;QAC5E,IAAI,OAAOc,aAAa,aAAa;YACnC,MAAMC,OAAOD,SAASE,eAAe;YAErC,IAAIhB,YAAY;gBACde,KAAKE,SAAS,CAACC,MAAM,CAAC;gBACtBH,KAAKE,SAAS,CAACE,GAAG,CAAC;gBACnB,uDAAuD;gBACvDJ,KAAKK,YAAY,CAAC,cAAc;YAClC,OAAO;gBACLL,KAAKE,SAAS,CAACC,MAAM,CAAC;gBACtBH,KAAKE,SAAS,CAACE,GAAG,CAAC;gBACnB,uDAAuD;gBACvDJ,KAAKK,YAAY,CAAC,cAAc;YAClC;YAEA,gBAAgB;YAChBR,QAAQC,GAAG,CACT,gCACAb,aAAa,SAAS;YAExBY,QAAQC,GAAG,CAAC,+BAA+BE,KAAKM,SAAS;QAC3D;IACF,GAAG;QAACrB;QAAYG;KAAS;IAEzB,MAAMmB,iBAAiB;QACrB,MAAMC,UAAU,CAACvB;QACjBC,cAAcsB;QACdX,QAAQC,GAAG,CAAC,mCAAmCU,UAAU,SAAS;IACpE;IAEA,MAAMC,cAAc,CAACC;QACnBxB,cAAcwB;IAChB;IAEA,MAAMC,QAAQ;QAAE1B;QAAYsB;QAAgBE;QAAarB;IAAS;IAElE,qBAAOwB,cAAK,CAACC,aAAa,CAACzC,aAAa0C,QAAQ,EAAE;QAAEH;IAAM,GAAG3B;AAC/D;AAEO,SAASV;IACd,MAAMyC,UAAUC,IAAAA,iBAAU,EAAC5C;IAC3B,IAAI2C,YAAYhC,WAAW;QACzB,MAAM,IAAIkC,MAAM;IAClB;IACA,OAAOF;AACT"}