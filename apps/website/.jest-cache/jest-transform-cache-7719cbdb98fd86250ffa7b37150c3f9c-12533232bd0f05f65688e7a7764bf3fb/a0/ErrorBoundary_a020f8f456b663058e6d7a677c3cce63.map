{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/libs/shared-components/src/lib/common/ErrorBoundary.tsx"],"sourcesContent":["'use client';\n\nimport React, { Component, ReactNode, ErrorInfo } from 'react';\n\n// Conditional Supabase client creation with fallback values\nlet supabase = null;\ntry {\n  const { createClient } = require('@supabase/supabase-js');\n  const supabaseUrl =\n    process.env['NEXT_PUBLIC_SUPABASE_URL'] ||\n    'https://placeholder.supabase.co';\n  const supabaseServiceRoleKey =\n    process.env['SUPABASE_SERVICE_ROLE_KEY'] || 'placeholder_key';\n\n  if (\n    supabaseUrl !== 'https://placeholder.supabase.co' &&\n    supabaseServiceRoleKey !== 'placeholder_key'\n  ) {\n    supabase = createClient(supabaseUrl, supabaseServiceRoleKey);\n  }\n} catch (error) {\n  console.warn('Supabase client creation failed in ErrorBoundary:', error);\n}\n\nimport { AlertTriangle, RefreshCw, Home, Bug } from 'lucide-react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n  errorId: string | null;\n}\n\nexport class ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null,\n      errorId: null,\n    };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return {\n      hasError: true,\n      error,\n      errorId: null,\n    };\n  }\n\n  override componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // Log the error\n    this.logError(error, errorInfo);\n\n    // Call custom error handler if provided\n    if (this.props.onError) {\n      this.props.onError(error, errorInfo);\n    }\n  }\n\n  private async logError(error: Error, errorInfo: ErrorInfo) {\n    try {\n      // Simple error logging without external service dependency\n      console.error('ErrorBoundary caught an error:', error);\n      console.error('Error info:', errorInfo);\n\n      // Generate a simple error ID\n      const errorId = `error_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n      this.setState({ errorId });\n    } catch (logError) {\n      console.error('Failed to log error:', logError);\n    }\n  }\n\n  private handleRetry = () => {\n    this.setState({\n      hasError: false,\n      error: null,\n      errorId: null,\n    });\n  };\n\n  private handleGoHome = () => {\n    if (typeof window !== 'undefined') {\n      window.location.href = '/';\n    }\n  };\n\n  override render() {\n    if (this.state.hasError) {\n      // Use custom fallback if provided\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      // Default error UI\n      return (\n        <div className='min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4'>\n          <div className='max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center'>\n            <div className='mb-6'>\n              <div className='mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/20 mb-4'>\n                <AlertTriangle className='h-6 w-6 text-red-600 dark:text-red-400' />\n              </div>\n              <h1 className='text-xl font-semibold text-gray-900 dark:text-white mb-2'>\n                Something went wrong\n              </h1>\n              <p className='text-gray-600 dark:text-gray-400 mb-4'>\n                We're sorry, but something unexpected happened. Our team has\n                been notified.\n              </p>\n              {this.state.errorId && (\n                <p className='text-sm text-gray-500 dark:text-gray-500 mb-4'>\n                  Error ID: {this.state.errorId}\n                </p>\n              )}\n            </div>\n\n            <div className='space-y-3'>\n              <button\n                onClick={this.handleRetry}\n                className='w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors'\n              >\n                <RefreshCw className='h-4 w-4 mr-2' />\n                Try Again\n              </button>\n              <button\n                onClick={this.handleGoHome}\n                className='w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors'\n              >\n                <Home className='h-4 w-4 mr-2' />\n                Go Home\n              </button>\n            </div>\n\n            {process.env['NODE_ENV'] === 'development' && this.state.error && (\n              <details className='mt-6 text-left'>\n                <summary className='cursor-pointer text-sm text-gray-500 dark:text-gray-400 mb-2'>\n                  <Bug className='h-4 w-4 inline mr-1' />\n                  Error Details (Development)\n                </summary>\n                <div className='bg-gray-100 dark:bg-gray-700 rounded p-3 text-xs font-mono text-gray-800 dark:text-gray-200 overflow-auto'>\n                  <div className='mb-2'>\n                    <strong>Error:</strong> {this.state.error.message}\n                  </div>\n                  <div>\n                    <strong>Stack:</strong>\n                    <pre className='whitespace-pre-wrap mt-1'>\n                      {this.state.error.stack}\n                    </pre>\n                  </div>\n                </div>\n              </details>\n            )}\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n// Higher-order component for easier usage\nexport function withErrorBoundary<P extends object>(\n  Component: React.ComponentType<P>,\n  errorBoundaryProps?: Omit<Props, 'children'>\n) {\n  const WrappedComponent = (props: P) => (\n    <ErrorBoundary {...errorBoundaryProps}>\n      <Component {...props} />\n    </ErrorBoundary>\n  );\n\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`;\n\n  return WrappedComponent;\n}\n"],"names":["ErrorBoundary","withErrorBoundary","supabase","createClient","require","supabaseUrl","process","env","supabaseServiceRoleKey","error","console","warn","Component","props","handleRetry","setState","hasError","errorId","handleGoHome","window","location","href","state","getDerivedStateFromError","componentDidCatch","errorInfo","logError","onError","Date","now","Math","random","toString","substr","render","fallback","div","className","AlertTriangle","h1","p","button","onClick","RefreshCw","Home","details","summary","Bug","strong","message","pre","stack","children","errorBoundaryProps","WrappedComponent","displayName","name"],"mappings":"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"}