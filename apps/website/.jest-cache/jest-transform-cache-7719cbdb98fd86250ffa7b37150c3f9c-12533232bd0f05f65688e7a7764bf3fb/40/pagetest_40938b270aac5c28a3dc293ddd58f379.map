{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/apps/website/src/app/admin/users/page.test.tsx"],"sourcesContent":["/**\n * Unit Tests for Admin User Management (A-UT-018)\n * Task: A-007 - Admin User Management\n */\n\nimport React from 'react';\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport '@testing-library/jest-dom';\nimport UserManagementPage from './page';\nimport * as sharedContexts from '@elzatona/shared-contexts';\n\n// Mock shared contexts\njest.mock('@elzatona/shared-contexts', () => {\n  const actual = jest.requireActual('../../../../test-utils/mocks/shared-contexts');\n  return {\n    ...actual,\n    useAuth: jest.fn(),\n    useAdminAuth: jest.fn(),\n  };\n});\n\n// Mock fetch\nglobal.fetch = jest.fn();\n\njest.mock('lucide-react', () => ({\n  Users: () => <span>üë•</span>,\n  UserPlus: () => <span>‚ûï</span>,\n  Shield: () => <span>üõ°Ô∏è</span>,\n  Crown: () => <span>üëë</span>,\n  Star: () => <span>‚≠ê</span>,\n  Mail: () => <span>üìß</span>,\n  Calendar: () => <span>üìÖ</span>,\n  Activity: () => <span>üìä</span>,\n  Search: () => <span>üîç</span>,\n  Filter: () => <span>üîΩ</span>,\n  MoreVertical: () => <span>‚ãÆ</span>,\n  Edit: () => <span>‚úèÔ∏è</span>,\n  Trash2: () => <span>üóëÔ∏è</span>,\n  Eye: () => <span>üëÅÔ∏è</span>,\n  RefreshCw: () => <span>üîÑ</span>,\n}));\n\ndescribe('A-UT-018: Component Renders', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    (sharedContexts.useAuth as jest.Mock).mockReturnValue({\n      user: { id: '1', email: 'admin@example.com' },\n    });\n    \n    (sharedContexts.useAdminAuth as jest.Mock).mockReturnValue({\n      isAuthenticated: true,\n    });\n    \n    (global.fetch as jest.Mock).mockResolvedValue({\n      ok: true,\n      json: async () => ({\n        success: true,\n        users: [],\n      }),\n    });\n  });\n\n  it('should render without errors', async () => {\n    const { container } = render(<UserManagementPage />);\n    await waitFor(() => {\n      expect(container).toBeInTheDocument();\n    });\n  });\n\n  it('should display access denied for non-admin users', () => {\n    (sharedContexts.useAdminAuth as jest.Mock).mockReturnValue({\n      isAuthenticated: false,\n    });\n    \n    render(<UserManagementPage />);\n    expect(screen.getByText(/Access Denied/i)).toBeInTheDocument();\n  });\n\n  it('should fetch users on mount', async () => {\n    render(<UserManagementPage />);\n    await waitFor(() => {\n      expect(global.fetch).toHaveBeenCalledWith('/api/users');\n    });\n  });\n});\n\ndescribe('A-UT-SNAPSHOT: Admin User Management Snapshot Tests', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    (sharedContexts.useAuth as jest.Mock).mockReturnValue({\n      user: { id: '1', email: 'admin@example.com' },\n    });\n    \n    (sharedContexts.useAdminAuth as jest.Mock).mockReturnValue({\n      isAuthenticated: true,\n    });\n    \n    (global.fetch as jest.Mock).mockResolvedValue({\n      ok: true,\n      json: async () => ({\n        success: true,\n        users: [],\n      }),\n    });\n  });\n\n  it('should match admin user management page snapshot', async () => {\n    const { container } = render(<UserManagementPage />);\n    await waitFor(() => {\n      expect(container.firstChild).toMatchSnapshot();\n    });\n  });\n\n  it('should match admin user management page snapshot (with users)', async () => {\n    (global.fetch as jest.Mock).mockResolvedValue({\n      ok: true,\n      json: async () => ({\n        success: true,\n        users: [\n          { id: '1', email: 'user1@example.com', role: 'user' },\n          { id: '2', email: 'user2@example.com', role: 'admin' },\n        ],\n      }),\n    });\n    \n    const { container } = render(<UserManagementPage />);\n    await waitFor(() => {\n      expect(container.firstChild).toMatchSnapshot();\n    });\n  });\n});\n"],"names":["jest","mock","actual","requireActual","useAuth","fn","useAdminAuth","Users","span","UserPlus","Shield","Crown","Star","Mail","Calendar","Activity","Search","Filter","MoreVertical","Edit","Trash2","Eye","RefreshCw","global","fetch","describe","beforeEach","clearAllMocks","sharedContexts","mockReturnValue","user","id","email","isAuthenticated","mockResolvedValue","ok","json","success","users","it","container","render","UserManagementPage","waitFor","expect","toBeInTheDocument","screen","getByText","toHaveBeenCalledWith","firstChild","toMatchSnapshot","role"],"mappings":"AAAA;;;CAGC;AAQD,uBAAuB;AACvBA,KAAKC,IAAI,CAAC,6BAA6B;IACrC,MAAMC,SAASF,KAAKG,aAAa,CAAC;IAClC,OAAO;QACL,GAAGD,MAAM;QACTE,SAASJ,KAAKK,EAAE;QAChBC,cAAcN,KAAKK,EAAE;IACvB;AACF;AAKAL,KAAKC,IAAI,CAAC,gBAAgB,IAAO,CAAA;QAC/BM,OAAO,kBAAM,qBAACC;0BAAK;;QACnBC,UAAU,kBAAM,qBAACD;0BAAK;;QACtBE,QAAQ,kBAAM,qBAACF;0BAAK;;QACpBG,OAAO,kBAAM,qBAACH;0BAAK;;QACnBI,MAAM,kBAAM,qBAACJ;0BAAK;;QAClBK,MAAM,kBAAM,qBAACL;0BAAK;;QAClBM,UAAU,kBAAM,qBAACN;0BAAK;;QACtBO,UAAU,kBAAM,qBAACP;0BAAK;;QACtBQ,QAAQ,kBAAM,qBAACR;0BAAK;;QACpBS,QAAQ,kBAAM,qBAACT;0BAAK;;QACpBU,cAAc,kBAAM,qBAACV;0BAAK;;QAC1BW,MAAM,kBAAM,qBAACX;0BAAK;;QAClBY,QAAQ,kBAAM,qBAACZ;0BAAK;;QACpBa,KAAK,kBAAM,qBAACb;0BAAK;;QACjBc,WAAW,kBAAM,qBAACd;0BAAK;;IACzB,CAAA;;;;;8DAnCkB;wBACiC;QAC5C;6DACwB;wEACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYhC,aAAa;AACbe,OAAOC,KAAK,GAAGxB,KAAKK,EAAE;AAoBtBoB,SAAS,+BAA+B;IACtCC,WAAW;QACT1B,KAAK2B,aAAa;QAEjBC,gBAAexB,OAAO,CAAeyB,eAAe,CAAC;YACpDC,MAAM;gBAAEC,IAAI;gBAAKC,OAAO;YAAoB;QAC9C;QAECJ,gBAAetB,YAAY,CAAeuB,eAAe,CAAC;YACzDI,iBAAiB;QACnB;QAECV,OAAOC,KAAK,CAAeU,iBAAiB,CAAC;YAC5CC,IAAI;YACJC,MAAM,UAAa,CAAA;oBACjBC,SAAS;oBACTC,OAAO,EAAE;gBACX,CAAA;QACF;IACF;IAEAC,GAAG,gCAAgC;QACjC,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAAC,qBAACC,aAAkB;QAChD,MAAMC,IAAAA,eAAO,EAAC;YACZC,OAAOJ,WAAWK,iBAAiB;QACrC;IACF;IAEAN,GAAG,oDAAoD;QACpDX,gBAAetB,YAAY,CAAeuB,eAAe,CAAC;YACzDI,iBAAiB;QACnB;QAEAQ,IAAAA,cAAM,gBAAC,qBAACC,aAAkB;QAC1BE,OAAOE,cAAM,CAACC,SAAS,CAAC,mBAAmBF,iBAAiB;IAC9D;IAEAN,GAAG,+BAA+B;QAChCE,IAAAA,cAAM,gBAAC,qBAACC,aAAkB;QAC1B,MAAMC,IAAAA,eAAO,EAAC;YACZC,OAAOrB,OAAOC,KAAK,EAAEwB,oBAAoB,CAAC;QAC5C;IACF;AACF;AAEAvB,SAAS,uDAAuD;IAC9DC,WAAW;QACT1B,KAAK2B,aAAa;QAEjBC,gBAAexB,OAAO,CAAeyB,eAAe,CAAC;YACpDC,MAAM;gBAAEC,IAAI;gBAAKC,OAAO;YAAoB;QAC9C;QAECJ,gBAAetB,YAAY,CAAeuB,eAAe,CAAC;YACzDI,iBAAiB;QACnB;QAECV,OAAOC,KAAK,CAAeU,iBAAiB,CAAC;YAC5CC,IAAI;YACJC,MAAM,UAAa,CAAA;oBACjBC,SAAS;oBACTC,OAAO,EAAE;gBACX,CAAA;QACF;IACF;IAEAC,GAAG,oDAAoD;QACrD,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAAC,qBAACC,aAAkB;QAChD,MAAMC,IAAAA,eAAO,EAAC;YACZC,OAAOJ,UAAUS,UAAU,EAAEC,eAAe;QAC9C;IACF;IAEAX,GAAG,iEAAiE;QACjEhB,OAAOC,KAAK,CAAeU,iBAAiB,CAAC;YAC5CC,IAAI;YACJC,MAAM,UAAa,CAAA;oBACjBC,SAAS;oBACTC,OAAO;wBACL;4BAAEP,IAAI;4BAAKC,OAAO;4BAAqBmB,MAAM;wBAAO;wBACpD;4BAAEpB,IAAI;4BAAKC,OAAO;4BAAqBmB,MAAM;wBAAQ;qBACtD;gBACH,CAAA;QACF;QAEA,MAAM,EAAEX,SAAS,EAAE,GAAGC,IAAAA,cAAM,gBAAC,qBAACC,aAAkB;QAChD,MAAMC,IAAAA,eAAO,EAAC;YACZC,OAAOJ,UAAUS,UAAU,EAAEC,eAAe;QAC9C;IACF;AACF"}