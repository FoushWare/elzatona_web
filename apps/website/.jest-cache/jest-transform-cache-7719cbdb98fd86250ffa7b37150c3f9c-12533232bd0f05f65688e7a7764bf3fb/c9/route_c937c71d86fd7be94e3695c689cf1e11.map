{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/apps/website/src/app/api/admin/frontend-tasks/[id]/route.ts"],"sourcesContent":["// v1.0 - API routes for individual frontend task CRUD operations\n\nimport { NextRequest, NextResponse } from 'next/server';\nimport { FrontendTask, FrontendTaskFormData, ApiResponse } from '@/types/admin';\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\nconst supabase = createClient(supabaseUrl, supabaseServiceRoleKey);\n\n// GET /api/admin/frontend-tasks/[id] - Get a specific frontend task\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    console.log('üîÑ API: Fetching frontend task by ID...');\n\n    const { id } = await params;\n\n    if (!id) {\n      return NextResponse.json(\n        { success: false, error: 'Task ID is required' },\n        { status: 400 }\n      );\n    }\n\n    // Fetch task from Supabase\n    const { data: taskDoc, error } = await supabase\n      .from('frontend_tasks')\n      .select('*')\n      .eq('id', id)\n      .single();\n\n    if (error || !taskDoc) {\n      return NextResponse.json(\n        { success: false, error: 'Task not found' },\n        { status: 404 }\n      );\n    }\n\n    const taskData = {\n      id: taskDoc.id,\n      ...taskDoc,\n    } as FrontendTask;\n\n    console.log(`‚úÖ API: Frontend task fetched: ${taskData.title}`);\n\n    const response: ApiResponse<FrontendTask> = {\n      success: true,\n      data: taskData,\n    };\n\n    return NextResponse.json(response);\n  } catch (error) {\n    console.error('‚ùå API: Error fetching frontend task:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to fetch frontend task' },\n      { status: 500 }\n    );\n  }\n}\n\n// PUT /api/admin/frontend-tasks/[id] - Update a specific frontend task\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    console.log('üîÑ API: Updating frontend task...');\n\n    const { id } = await params;\n    const body: FrontendTaskFormData = await request.json();\n\n    if (!id) {\n      return NextResponse.json(\n        { success: false, error: 'Task ID is required' },\n        { status: 400 }\n      );\n    }\n\n    // Validate required fields\n    if (!body.title || !body.description || !body.category) {\n      return NextResponse.json(\n        { success: false, error: 'Missing required fields' },\n        { status: 400 }\n      );\n    }\n\n    // Check if task exists\n    const { data: taskDoc, error: fetchError } = await supabase\n      .from('frontend_tasks')\n      .select('*')\n      .eq('id', id)\n      .single();\n\n    if (fetchError || !taskDoc) {\n      return NextResponse.json(\n        { success: false, error: 'Task not found' },\n        { status: 404 }\n      );\n    }\n\n    // Update task in Supabase\n    const { error: updateError } = await supabase\n      .from('frontend_tasks')\n      .update({\n        ...body,\n        updated_at: new Date().toISOString(),\n      })\n      .eq('id', id);\n\n    console.log(`‚úÖ API: Frontend task updated: ${id}`);\n\n    const response: ApiResponse<{ id: string }> = {\n      success: true,\n      data: { id },\n    };\n\n    return NextResponse.json(response);\n  } catch (error) {\n    console.error('‚ùå API: Error updating frontend task:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to update frontend task' },\n      { status: 500 }\n    );\n  }\n}\n\n// DELETE /api/admin/frontend-tasks/[id] - Delete a specific frontend task\nexport async function DELETE(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    console.log('üîÑ API: Deleting frontend task...');\n\n    const { id } = await params;\n\n    if (!id) {\n      return NextResponse.json(\n        { success: false, error: 'Task ID is required' },\n        { status: 400 }\n      );\n    }\n\n    // Check if task exists\n    const { data: taskDoc, error: fetchError } = await supabase\n      .from('frontend_tasks')\n      .select('*')\n      .eq('id', id)\n      .single();\n\n    if (fetchError || !taskDoc) {\n      return NextResponse.json(\n        { success: false, error: 'Task not found' },\n        { status: 404 }\n      );\n    }\n\n    // Delete task from Supabase\n    const { error: deleteError } = await supabase\n      .from('frontend_tasks')\n      .delete()\n      .eq('id', id);\n\n    if (deleteError) {\n      throw deleteError;\n    }\n\n    console.log(`‚úÖ API: Frontend task deleted: ${id}`);\n\n    const response: ApiResponse<{ id: string }> = {\n      success: true,\n      data: { id },\n    };\n\n    return NextResponse.json(response);\n  } catch (error) {\n    console.error('‚ùå API: Error deleting frontend task:', error);\n    return NextResponse.json(\n      { success: false, error: 'Failed to delete frontend task' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":["DELETE","GET","PUT","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseServiceRoleKey","SUPABASE_SERVICE_ROLE_KEY","supabase","createClient","request","params","console","log","id","NextResponse","json","success","error","status","data","taskDoc","from","select","eq","single","taskData","title","response","body","description","category","fetchError","updateError","update","updated_at","Date","toISOString","deleteError","delete"],"mappings":"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"}