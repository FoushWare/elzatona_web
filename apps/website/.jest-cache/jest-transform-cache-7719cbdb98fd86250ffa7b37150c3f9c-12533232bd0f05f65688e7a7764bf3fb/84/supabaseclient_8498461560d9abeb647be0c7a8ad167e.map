{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/apps/website/src/lib/supabase-client.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\n// Get Supabase credentials from environment variables\nconst supabaseUrl = process.env['NEXT_PUBLIC_SUPABASE_URL'] || '';\nconst supabaseAnonKey = process.env['NEXT_PUBLIC_SUPABASE_ANON_KEY'] || '';\n\n// Validate that we have the required credentials\nconst isValidConfig =\n  supabaseUrl &&\n  supabaseUrl !== '' &&\n  supabaseUrl !== 'https://placeholder.supabase.co' &&\n  supabaseAnonKey &&\n  supabaseAnonKey !== '' &&\n  supabaseAnonKey !== 'placeholder_key';\n\n// Log configuration status\nif (!isValidConfig) {\n  console.error('❌ Supabase configuration is missing or invalid!');\n  console.error('Please check your .env.local file has:');\n  console.error('- NEXT_PUBLIC_SUPABASE_URL');\n  console.error('- NEXT_PUBLIC_SUPABASE_ANON_KEY');\n} else {\n  console.log('✅ Supabase client configured successfully');\n  console.log('URL:', supabaseUrl);\n}\n\n// Create Supabase client\nexport const supabaseClient = isValidConfig\n  ? createClient(supabaseUrl, supabaseAnonKey, {\n      auth: {\n        autoRefreshToken: true,\n        persistSession: true,\n        detectSessionInUrl: true,\n      },\n    })\n  : null;\n\n// Export a helper to check if Supabase is available\nexport const isSupabaseAvailable = () => supabaseClient !== null;\n\n// Mirror auth session to cookie for simple client persistence across reloads\n// Only set up on client side to avoid SSR issues\nif (supabaseClient && typeof window !== 'undefined' && supabaseClient.auth) {\n  supabaseClient.auth.onAuthStateChange((event, session) => {\n    try {\n      if (typeof document === 'undefined') return;\n      if (session?.access_token) {\n        const expires = new Date(\n          Date.now() +\n            (session.expires_in ? session.expires_in * 1000 : 7 * 86400000)\n        ).toUTCString();\n        document.cookie = `sb_session=1; path=/; expires=${expires}`;\n      } else {\n        document.cookie =\n          'sb_session=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';\n      }\n    } catch (e) {\n      // no-op\n    }\n  });\n}\n"],"names":["isSupabaseAvailable","supabaseClient","supabaseUrl","process","env","supabaseAnonKey","isValidConfig","console","error","log","createClient","auth","autoRefreshToken","persistSession","detectSessionInUrl","window","onAuthStateChange","event","session","document","access_token","expires","Date","now","expires_in","toUTCString","cookie","e"],"mappings":";;;;;;;;;;;QAsCaA;eAAAA;;QAXAC;eAAAA;;;4BA3BgB;AAE7B,sDAAsD;AACtD,MAAMC,cAAcC,QAAQC,GAAG,CAAC,2BAA2B,IAAI;AAC/D,MAAMC,kBAAkBF,QAAQC,GAAG,CAAC,gCAAgC,IAAI;AAExE,iDAAiD;AACjD,MAAME,gBACJJ,eACAA,gBAAgB,MAChBA,gBAAgB,qCAChBG,mBACAA,oBAAoB,MACpBA,oBAAoB;AAEtB,2BAA2B;AAC3B,IAAI,CAACC,eAAe;IAClBC,QAAQC,KAAK,CAAC;IACdD,QAAQC,KAAK,CAAC;IACdD,QAAQC,KAAK,CAAC;IACdD,QAAQC,KAAK,CAAC;AAChB,OAAO;IACLD,QAAQE,GAAG,CAAC;IACZF,QAAQE,GAAG,CAAC,QAAQP;AACtB;AAGO,MAAMD,iBAAiBK,gBAC1BI,IAAAA,wBAAY,EAACR,aAAaG,iBAAiB;IACzCM,MAAM;QACJC,kBAAkB;QAClBC,gBAAgB;QAChBC,oBAAoB;IACtB;AACF,KACA;AAGG,MAAMd,sBAAsB,IAAMC,mBAAmB;AAE5D,6EAA6E;AAC7E,iDAAiD;AACjD,IAAIA,kBAAkB,OAAOc,WAAW,eAAed,eAAeU,IAAI,EAAE;IAC1EV,eAAeU,IAAI,CAACK,iBAAiB,CAAC,CAACC,OAAOC;QAC5C,IAAI;YACF,IAAI,OAAOC,aAAa,aAAa;YACrC,IAAID,SAASE,cAAc;gBACzB,MAAMC,UAAU,IAAIC,KAClBA,KAAKC,GAAG,KACLL,CAAAA,QAAQM,UAAU,GAAGN,QAAQM,UAAU,GAAG,OAAO,IAAI,QAAO,GAC/DC,WAAW;gBACbN,SAASO,MAAM,GAAG,CAAC,8BAA8B,EAAEL,SAAS;YAC9D,OAAO;gBACLF,SAASO,MAAM,GACb;YACJ;QACF,EAAE,OAAOC,GAAG;QACV,QAAQ;QACV;IACF;AACF"}