85fa0b4990240388884876a38e7144aa
/**
 * Integration Tests for Admin User Management (A-IT-019)
 * Task: A-007 - Admin User Management
 */ "use strict";
jest.mock('@elzatona/shared-contexts', ()=>{
    const actual = jest.requireActual('../../../../test-utils/mocks/shared-contexts');
    return {
        ...actual,
        useAuth: jest.fn(),
        useAdminAuth: jest.fn()
    };
});
jest.mock('lucide-react', ()=>({
        Users: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDC65"
            }),
        UserPlus: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "➕"
            }),
        Shield: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDEE1️"
            }),
        Crown: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDC51"
            }),
        Star: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "⭐"
            }),
        Mail: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDCE7"
            }),
        Calendar: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDCC5"
            }),
        Activity: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDCCA"
            }),
        Search: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDD0D"
            }),
        Filter: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDD3D"
            }),
        MoreVertical: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "⋮"
            }),
        Edit: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "✏️"
            }),
        Trash2: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDDD1️"
            }),
        Eye: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDC41️"
            }),
        RefreshCw: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                children: "\uD83D\uDD04"
            })
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _react1 = require("@testing-library/react");
require("@testing-library/jest-dom");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _sharedcontexts = /*#__PURE__*/ _interop_require_wildcard(require("../../../../../../libs/shared-contexts/src"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
global.fetch = jest.fn();
describe('A-IT-019: User Management API Integration', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        _sharedcontexts.useAuth.mockReturnValue({
            user: {
                id: '1',
                email: 'admin@example.com'
            }
        });
        _sharedcontexts.useAdminAuth.mockReturnValue({
            isAuthenticated: true
        });
        global.fetch.mockResolvedValue({
            ok: true,
            json: async ()=>({
                    success: true,
                    users: [
                        {
                            id: '1',
                            email: 'user@example.com',
                            name: 'Test User',
                            role: 'user',
                            is_active: true,
                            created_at: '2024-01-01'
                        }
                    ]
                })
        });
    });
    it('should fetch users from API', async ()=>{
        (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
        await (0, _react1.waitFor)(()=>{
            expect(global.fetch).toHaveBeenCalledWith('/api/users');
        });
    });
    it('should handle API errors', async ()=>{
        global.fetch.mockRejectedValue(new Error('API Error'));
        (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
        await (0, _react1.waitFor)(()=>{
            // Should handle error gracefully
            expect(_react1.screen.getByText(/.*/)).toBeTruthy();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hLmZvdWFkL1NpZGVQcm9qZWN0cy9FbHphdG9uYS1hbGwvRWx6YXRvbmEtd2ViL2FwcHMvd2Vic2l0ZS9zcmMvYXBwL2FkbWluL3VzZXJzL3BhZ2UuaW50ZWdyYXRpb24udGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJbnRlZ3JhdGlvbiBUZXN0cyBmb3IgQWRtaW4gVXNlciBNYW5hZ2VtZW50IChBLUlULTAxOSlcbiAqIFRhc2s6IEEtMDA3IC0gQWRtaW4gVXNlciBNYW5hZ2VtZW50XG4gKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQgVXNlck1hbmFnZW1lbnRQYWdlIGZyb20gJy4vcGFnZSc7XG5pbXBvcnQgKiBhcyBzaGFyZWRDb250ZXh0cyBmcm9tICdAZWx6YXRvbmEvc2hhcmVkLWNvbnRleHRzJztcblxuamVzdC5tb2NrKCdAZWx6YXRvbmEvc2hhcmVkLWNvbnRleHRzJywgKCkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSBqZXN0LnJlcXVpcmVBY3R1YWwoJy4uLy4uLy4uLy4uL3Rlc3QtdXRpbHMvbW9ja3Mvc2hhcmVkLWNvbnRleHRzJyk7XG4gIHJldHVybiB7XG4gICAgLi4uYWN0dWFsLFxuICAgIHVzZUF1dGg6IGplc3QuZm4oKSxcbiAgICB1c2VBZG1pbkF1dGg6IGplc3QuZm4oKSxcbiAgfTtcbn0pO1xuXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmplc3QubW9jaygnbHVjaWRlLXJlYWN0JywgKCkgPT4gKHtcbiAgVXNlcnM6ICgpID0+IDxzcGFuPvCfkaU8L3NwYW4+LFxuICBVc2VyUGx1czogKCkgPT4gPHNwYW4+4p6VPC9zcGFuPixcbiAgU2hpZWxkOiAoKSA9PiA8c3Bhbj7wn5uh77iPPC9zcGFuPixcbiAgQ3Jvd246ICgpID0+IDxzcGFuPvCfkZE8L3NwYW4+LFxuICBTdGFyOiAoKSA9PiA8c3Bhbj7irZA8L3NwYW4+LFxuICBNYWlsOiAoKSA9PiA8c3Bhbj7wn5OnPC9zcGFuPixcbiAgQ2FsZW5kYXI6ICgpID0+IDxzcGFuPvCfk4U8L3NwYW4+LFxuICBBY3Rpdml0eTogKCkgPT4gPHNwYW4+8J+Tijwvc3Bhbj4sXG4gIFNlYXJjaDogKCkgPT4gPHNwYW4+8J+UjTwvc3Bhbj4sXG4gIEZpbHRlcjogKCkgPT4gPHNwYW4+8J+UvTwvc3Bhbj4sXG4gIE1vcmVWZXJ0aWNhbDogKCkgPT4gPHNwYW4+4ouuPC9zcGFuPixcbiAgRWRpdDogKCkgPT4gPHNwYW4+4pyP77iPPC9zcGFuPixcbiAgVHJhc2gyOiAoKSA9PiA8c3Bhbj7wn5eR77iPPC9zcGFuPixcbiAgRXllOiAoKSA9PiA8c3Bhbj7wn5GB77iPPC9zcGFuPixcbiAgUmVmcmVzaEN3OiAoKSA9PiA8c3Bhbj7wn5SEPC9zcGFuPixcbn0pKTtcblxuZGVzY3JpYmUoJ0EtSVQtMDE5OiBVc2VyIE1hbmFnZW1lbnQgQVBJIEludGVncmF0aW9uJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICBcbiAgICAoc2hhcmVkQ29udGV4dHMudXNlQXV0aCBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICB1c2VyOiB7IGlkOiAnMScsIGVtYWlsOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0sXG4gICAgfSk7XG4gICAgXG4gICAgKHNoYXJlZENvbnRleHRzLnVzZUFkbWluQXV0aCBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXG4gICAgfSk7XG4gICAgXG4gICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIG9rOiB0cnVlLFxuICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgdXNlcnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogJzEnLFxuICAgICAgICAgICAgZW1haWw6ICd1c2VyQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgaXNfYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgY3JlYXRlZF9hdDogJzIwMjQtMDEtMDEnLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBmZXRjaCB1c2VycyBmcm9tIEFQSScsIGFzeW5jICgpID0+IHtcbiAgICByZW5kZXIoPFVzZXJNYW5hZ2VtZW50UGFnZSAvPik7XG4gICAgXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3QoZ2xvYmFsLmZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS91c2VycycpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhbmRsZSBBUEkgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0FQSSBFcnJvcicpKTtcbiAgICBcbiAgICByZW5kZXIoPFVzZXJNYW5hZ2VtZW50UGFnZSAvPik7XG4gICAgXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAvLyBTaG91bGQgaGFuZGxlIGVycm9yIGdyYWNlZnVsbHlcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC8uKi8pKS50b0JlVHJ1dGh5KCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJhY3R1YWwiLCJyZXF1aXJlQWN0dWFsIiwidXNlQXV0aCIsImZuIiwidXNlQWRtaW5BdXRoIiwiVXNlcnMiLCJzcGFuIiwiVXNlclBsdXMiLCJTaGllbGQiLCJDcm93biIsIlN0YXIiLCJNYWlsIiwiQ2FsZW5kYXIiLCJBY3Rpdml0eSIsIlNlYXJjaCIsIkZpbHRlciIsIk1vcmVWZXJ0aWNhbCIsIkVkaXQiLCJUcmFzaDIiLCJFeWUiLCJSZWZyZXNoQ3ciLCJnbG9iYWwiLCJmZXRjaCIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJzaGFyZWRDb250ZXh0cyIsIm1vY2tSZXR1cm5WYWx1ZSIsInVzZXIiLCJpZCIsImVtYWlsIiwiaXNBdXRoZW50aWNhdGVkIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJvayIsImpzb24iLCJzdWNjZXNzIiwidXNlcnMiLCJuYW1lIiwicm9sZSIsImlzX2FjdGl2ZSIsImNyZWF0ZWRfYXQiLCJpdCIsInJlbmRlciIsIlVzZXJNYW5hZ2VtZW50UGFnZSIsIndhaXRGb3IiLCJleHBlY3QiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJzY3JlZW4iLCJnZXRCeVRleHQiLCJ0b0JlVHJ1dGh5Il0sIm1hcHBpbmdzIjoiQUFBQTs7O0NBR0M7QUFRREEsS0FBS0MsSUFBSSxDQUFDLDZCQUE2QjtJQUNyQyxNQUFNQyxTQUFTRixLQUFLRyxhQUFhLENBQUM7SUFDbEMsT0FBTztRQUNMLEdBQUdELE1BQU07UUFDVEUsU0FBU0osS0FBS0ssRUFBRTtRQUNoQkMsY0FBY04sS0FBS0ssRUFBRTtJQUN2QjtBQUNGO0FBSUFMLEtBQUtDLElBQUksQ0FBQyxnQkFBZ0IsSUFBTyxDQUFBO1FBQy9CTSxPQUFPLGtCQUFNLHFCQUFDQzswQkFBSzs7UUFDbkJDLFVBQVUsa0JBQU0scUJBQUNEOzBCQUFLOztRQUN0QkUsUUFBUSxrQkFBTSxxQkFBQ0Y7MEJBQUs7O1FBQ3BCRyxPQUFPLGtCQUFNLHFCQUFDSDswQkFBSzs7UUFDbkJJLE1BQU0sa0JBQU0scUJBQUNKOzBCQUFLOztRQUNsQkssTUFBTSxrQkFBTSxxQkFBQ0w7MEJBQUs7O1FBQ2xCTSxVQUFVLGtCQUFNLHFCQUFDTjswQkFBSzs7UUFDdEJPLFVBQVUsa0JBQU0scUJBQUNQOzBCQUFLOztRQUN0QlEsUUFBUSxrQkFBTSxxQkFBQ1I7MEJBQUs7O1FBQ3BCUyxRQUFRLGtCQUFNLHFCQUFDVDswQkFBSzs7UUFDcEJVLGNBQWMsa0JBQU0scUJBQUNWOzBCQUFLOztRQUMxQlcsTUFBTSxrQkFBTSxxQkFBQ1g7MEJBQUs7O1FBQ2xCWSxRQUFRLGtCQUFNLHFCQUFDWjswQkFBSzs7UUFDcEJhLEtBQUssa0JBQU0scUJBQUNiOzBCQUFLOztRQUNqQmMsV0FBVyxrQkFBTSxxQkFBQ2Q7MEJBQUs7O0lBQ3pCLENBQUE7Ozs7OzhEQWpDa0I7d0JBQ2lDO1FBQzVDOzZEQUN3Qjt3RUFDQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFXaENlLE9BQU9DLEtBQUssR0FBR3hCLEtBQUtLLEVBQUU7QUFvQnRCb0IsU0FBUyw2Q0FBNkM7SUFDcERDLFdBQVc7UUFDVDFCLEtBQUsyQixhQUFhO1FBRWpCQyxnQkFBZXhCLE9BQU8sQ0FBZXlCLGVBQWUsQ0FBQztZQUNwREMsTUFBTTtnQkFBRUMsSUFBSTtnQkFBS0MsT0FBTztZQUFvQjtRQUM5QztRQUVDSixnQkFBZXRCLFlBQVksQ0FBZXVCLGVBQWUsQ0FBQztZQUN6REksaUJBQWlCO1FBQ25CO1FBRUNWLE9BQU9DLEtBQUssQ0FBZVUsaUJBQWlCLENBQUM7WUFDNUNDLElBQUk7WUFDSkMsTUFBTSxVQUFhLENBQUE7b0JBQ2pCQyxTQUFTO29CQUNUQyxPQUFPO3dCQUNMOzRCQUNFUCxJQUFJOzRCQUNKQyxPQUFPOzRCQUNQTyxNQUFNOzRCQUNOQyxNQUFNOzRCQUNOQyxXQUFXOzRCQUNYQyxZQUFZO3dCQUNkO3FCQUNEO2dCQUNILENBQUE7UUFDRjtJQUNGO0lBRUFDLEdBQUcsK0JBQStCO1FBQ2hDQyxJQUFBQSxjQUFNLGdCQUFDLHFCQUFDQyxhQUFrQjtRQUUxQixNQUFNQyxJQUFBQSxlQUFPLEVBQUM7WUFDWkMsT0FBT3hCLE9BQU9DLEtBQUssRUFBRXdCLG9CQUFvQixDQUFDO1FBQzVDO0lBQ0Y7SUFFQUwsR0FBRyw0QkFBNEI7UUFDNUJwQixPQUFPQyxLQUFLLENBQWV5QixpQkFBaUIsQ0FBQyxJQUFJQyxNQUFNO1FBRXhETixJQUFBQSxjQUFNLGdCQUFDLHFCQUFDQyxhQUFrQjtRQUUxQixNQUFNQyxJQUFBQSxlQUFPLEVBQUM7WUFDWixpQ0FBaUM7WUFDakNDLE9BQU9JLGNBQU0sQ0FBQ0MsU0FBUyxDQUFDLE9BQU9DLFVBQVU7UUFDM0M7SUFDRjtBQUNGIn0=