{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/apps/website/jest.setup.js"],"sourcesContent":["import '@testing-library/jest-dom';\n\n// Set up environment variables before any module imports\n// This ensures supabase-client.ts and other modules have access to these values\nprocess.env.NEXT_PUBLIC_SUPABASE_URL =\n  process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://test.supabase.co';\nprocess.env.NEXT_PUBLIC_SUPABASE_ANON_KEY =\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || 'test-anon-key';\nprocess.env.SUPABASE_SERVICE_ROLE_KEY =\n  process.env.SUPABASE_SERVICE_ROLE_KEY || 'test-service-role-key';\n\n// Polyfill for Web APIs needed by Next.js in Node.js test environment\n// Next.js requires these globals to be available\nif (typeof global.Request === 'undefined') {\n  // Use Node.js 18+ built-in fetch API if available\n  if (typeof fetch !== 'undefined' && fetch.Request) {\n    global.Request = fetch.Request;\n    global.Response = fetch.Response;\n    global.Headers = fetch.Headers;\n  } else {\n    // Fallback: Create minimal polyfills\n    global.Headers = class Headers {\n      constructor(init = {}) {\n        this._headers = {};\n        if (init) {\n          Object.entries(init).forEach(([key, value]) => {\n            this._headers[key.toLowerCase()] = value;\n          });\n        }\n      }\n      get(name) {\n        return this._headers[name.toLowerCase()];\n      }\n      set(name, value) {\n        this._headers[name.toLowerCase()] = value;\n      }\n      has(name) {\n        return name.toLowerCase() in this._headers;\n      }\n      entries() {\n        return Object.entries(this._headers)[Symbol.iterator]();\n      }\n      *[Symbol.iterator]() {\n        for (const [key, value] of Object.entries(this._headers)) {\n          yield [key, value];\n        }\n      }\n    };\n\n    global.Request = class Request {\n      constructor(input, init = {}) {\n        this._url = typeof input === 'string' ? input : input?.url || '';\n        this._method = init.method || 'GET';\n        this._headers = new global.Headers(init.headers);\n        this._body = init.body;\n      }\n      get url() {\n        return this._url;\n      }\n      get method() {\n        return this._method;\n      }\n      get headers() {\n        return this._headers;\n      }\n      async json() {\n        return JSON.parse(this._body || '{}');\n      }\n    };\n\n    global.Response = class Response {\n      constructor(body, init = {}) {\n        this._body = body;\n        this._status = init.status || 200;\n        this._statusText = init.statusText || 'OK';\n        this._headers = new global.Headers(init.headers);\n        this._ok = this._status >= 200 && this._status < 300;\n      }\n      get status() {\n        return this._status;\n      }\n      get statusText() {\n        return this._statusText;\n      }\n      get headers() {\n        return this._headers;\n      }\n      get ok() {\n        return this._ok;\n      }\n      async json() {\n        if (typeof this._body === 'string') {\n          try {\n            return JSON.parse(this._body);\n          } catch {\n            return {};\n          }\n        }\n        // If body is already an object, return it\n        if (this._body && typeof this._body === 'object') {\n          return this._body;\n        }\n        return {};\n      }\n      async text() {\n        if (typeof this._body === 'string') {\n          return this._body;\n        }\n        return JSON.stringify(this._body || {});\n      }\n      static json(body, init = {}) {\n        const bodyString = JSON.stringify(body);\n        const headers = new global.Headers({\n          'Content-Type': 'application/json',\n          ...init.headers,\n        });\n        const response = new global.Response(bodyString, {\n          ...init,\n          headers,\n        });\n        // Ensure _body is set for NextResponse compatibility\n        response._body = bodyString;\n        return response;\n      }\n    };\n  }\n}\n"],"names":["process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","SUPABASE_SERVICE_ROLE_KEY","global","Request","fetch","Response","Headers","init","_headers","Object","entries","forEach","key","value","toLowerCase","get","name","set","has","Symbol","iterator","input","_url","url","_method","method","headers","_body","body","json","JSON","parse","_status","status","_statusText","statusText","_ok","ok","text","stringify","bodyString","response"],"mappings":";;;;QAAO;AAEP,yDAAyD;AACzD,gFAAgF;AAChFA,QAAQC,GAAG,CAACC,wBAAwB,GAClCF,QAAQC,GAAG,CAACC,wBAAwB,IAAI;AAC1CF,QAAQC,GAAG,CAACE,6BAA6B,GACvCH,QAAQC,GAAG,CAACE,6BAA6B,IAAI;AAC/CH,QAAQC,GAAG,CAACG,yBAAyB,GACnCJ,QAAQC,GAAG,CAACG,yBAAyB,IAAI;AAE3C,sEAAsE;AACtE,iDAAiD;AACjD,IAAI,OAAOC,OAAOC,OAAO,KAAK,aAAa;IACzC,kDAAkD;IAClD,IAAI,OAAOC,UAAU,eAAeA,MAAMD,OAAO,EAAE;QACjDD,OAAOC,OAAO,GAAGC,MAAMD,OAAO;QAC9BD,OAAOG,QAAQ,GAAGD,MAAMC,QAAQ;QAChCH,OAAOI,OAAO,GAAGF,MAAME,OAAO;IAChC,OAAO;QACL,qCAAqC;QACrCJ,OAAOI,OAAO,GAAG,MAAMA;YACrB,YAAYC,OAAO,CAAC,CAAC,CAAE;gBACrB,IAAI,CAACC,QAAQ,GAAG,CAAC;gBACjB,IAAID,MAAM;oBACRE,OAAOC,OAAO,CAACH,MAAMI,OAAO,CAAC,CAAC,CAACC,KAAKC,MAAM;wBACxC,IAAI,CAACL,QAAQ,CAACI,IAAIE,WAAW,GAAG,GAAGD;oBACrC;gBACF;YACF;YACAE,IAAIC,IAAI,EAAE;gBACR,OAAO,IAAI,CAACR,QAAQ,CAACQ,KAAKF,WAAW,GAAG;YAC1C;YACAG,IAAID,IAAI,EAAEH,KAAK,EAAE;gBACf,IAAI,CAACL,QAAQ,CAACQ,KAAKF,WAAW,GAAG,GAAGD;YACtC;YACAK,IAAIF,IAAI,EAAE;gBACR,OAAOA,KAAKF,WAAW,MAAM,IAAI,CAACN,QAAQ;YAC5C;YACAE,UAAU;gBACR,OAAOD,OAAOC,OAAO,CAAC,IAAI,CAACF,QAAQ,CAAC,CAACW,OAAOC,QAAQ,CAAC;YACvD;YACA,CAAC,CAACD,OAAOC,QAAQ,CAAC,GAAG;gBACnB,KAAK,MAAM,CAACR,KAAKC,MAAM,IAAIJ,OAAOC,OAAO,CAAC,IAAI,CAACF,QAAQ,EAAG;oBACxD,MAAM;wBAACI;wBAAKC;qBAAM;gBACpB;YACF;QACF;QAEAX,OAAOC,OAAO,GAAG,MAAMA;YACrB,YAAYkB,KAAK,EAAEd,OAAO,CAAC,CAAC,CAAE;gBAC5B,IAAI,CAACe,IAAI,GAAG,OAAOD,UAAU,WAAWA,QAAQA,OAAOE,OAAO;gBAC9D,IAAI,CAACC,OAAO,GAAGjB,KAAKkB,MAAM,IAAI;gBAC9B,IAAI,CAACjB,QAAQ,GAAG,IAAIN,OAAOI,OAAO,CAACC,KAAKmB,OAAO;gBAC/C,IAAI,CAACC,KAAK,GAAGpB,KAAKqB,IAAI;YACxB;YACA,IAAIL,MAAM;gBACR,OAAO,IAAI,CAACD,IAAI;YAClB;YACA,IAAIG,SAAS;gBACX,OAAO,IAAI,CAACD,OAAO;YACrB;YACA,IAAIE,UAAU;gBACZ,OAAO,IAAI,CAAClB,QAAQ;YACtB;YACA,MAAMqB,OAAO;gBACX,OAAOC,KAAKC,KAAK,CAAC,IAAI,CAACJ,KAAK,IAAI;YAClC;QACF;QAEAzB,OAAOG,QAAQ,GAAG,MAAMA;YACtB,YAAYuB,IAAI,EAAErB,OAAO,CAAC,CAAC,CAAE;gBAC3B,IAAI,CAACoB,KAAK,GAAGC;gBACb,IAAI,CAACI,OAAO,GAAGzB,KAAK0B,MAAM,IAAI;gBAC9B,IAAI,CAACC,WAAW,GAAG3B,KAAK4B,UAAU,IAAI;gBACtC,IAAI,CAAC3B,QAAQ,GAAG,IAAIN,OAAOI,OAAO,CAACC,KAAKmB,OAAO;gBAC/C,IAAI,CAACU,GAAG,GAAG,IAAI,CAACJ,OAAO,IAAI,OAAO,IAAI,CAACA,OAAO,GAAG;YACnD;YACA,IAAIC,SAAS;gBACX,OAAO,IAAI,CAACD,OAAO;YACrB;YACA,IAAIG,aAAa;gBACf,OAAO,IAAI,CAACD,WAAW;YACzB;YACA,IAAIR,UAAU;gBACZ,OAAO,IAAI,CAAClB,QAAQ;YACtB;YACA,IAAI6B,KAAK;gBACP,OAAO,IAAI,CAACD,GAAG;YACjB;YACA,MAAMP,OAAO;gBACX,IAAI,OAAO,IAAI,CAACF,KAAK,KAAK,UAAU;oBAClC,IAAI;wBACF,OAAOG,KAAKC,KAAK,CAAC,IAAI,CAACJ,KAAK;oBAC9B,EAAE,OAAM;wBACN,OAAO,CAAC;oBACV;gBACF;gBACA,0CAA0C;gBAC1C,IAAI,IAAI,CAACA,KAAK,IAAI,OAAO,IAAI,CAACA,KAAK,KAAK,UAAU;oBAChD,OAAO,IAAI,CAACA,KAAK;gBACnB;gBACA,OAAO,CAAC;YACV;YACA,MAAMW,OAAO;gBACX,IAAI,OAAO,IAAI,CAACX,KAAK,KAAK,UAAU;oBAClC,OAAO,IAAI,CAACA,KAAK;gBACnB;gBACA,OAAOG,KAAKS,SAAS,CAAC,IAAI,CAACZ,KAAK,IAAI,CAAC;YACvC;YACA,OAAOE,KAAKD,IAAI,EAAErB,OAAO,CAAC,CAAC,EAAE;gBAC3B,MAAMiC,aAAaV,KAAKS,SAAS,CAACX;gBAClC,MAAMF,UAAU,IAAIxB,OAAOI,OAAO,CAAC;oBACjC,gBAAgB;oBAChB,GAAGC,KAAKmB,OAAO;gBACjB;gBACA,MAAMe,WAAW,IAAIvC,OAAOG,QAAQ,CAACmC,YAAY;oBAC/C,GAAGjC,IAAI;oBACPmB;gBACF;gBACA,qDAAqD;gBACrDe,SAASd,KAAK,GAAGa;gBACjB,OAAOC;YACT;QACF;IACF;AACF"}