{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/apps/website/src/app/admin/users/page.integration.test.tsx"],"sourcesContent":["/**\n * Integration Tests for Admin User Management (A-IT-019)\n * Task: A-007 - Admin User Management\n */\n\nimport React from 'react';\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport '@testing-library/jest-dom';\nimport UserManagementPage from './page';\nimport * as sharedContexts from '@elzatona/shared-contexts';\n\njest.mock('@elzatona/shared-contexts', () => {\n  const actual = jest.requireActual('../../../../test-utils/mocks/shared-contexts');\n  return {\n    ...actual,\n    useAuth: jest.fn(),\n    useAdminAuth: jest.fn(),\n  };\n});\n\nglobal.fetch = jest.fn();\n\njest.mock('lucide-react', () => ({\n  Users: () => <span>üë•</span>,\n  UserPlus: () => <span>‚ûï</span>,\n  Shield: () => <span>üõ°Ô∏è</span>,\n  Crown: () => <span>üëë</span>,\n  Star: () => <span>‚≠ê</span>,\n  Mail: () => <span>üìß</span>,\n  Calendar: () => <span>üìÖ</span>,\n  Activity: () => <span>üìä</span>,\n  Search: () => <span>üîç</span>,\n  Filter: () => <span>üîΩ</span>,\n  MoreVertical: () => <span>‚ãÆ</span>,\n  Edit: () => <span>‚úèÔ∏è</span>,\n  Trash2: () => <span>üóëÔ∏è</span>,\n  Eye: () => <span>üëÅÔ∏è</span>,\n  RefreshCw: () => <span>üîÑ</span>,\n}));\n\ndescribe('A-IT-019: User Management API Integration', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    (sharedContexts.useAuth as jest.Mock).mockReturnValue({\n      user: { id: '1', email: 'admin@example.com' },\n    });\n    \n    (sharedContexts.useAdminAuth as jest.Mock).mockReturnValue({\n      isAuthenticated: true,\n    });\n    \n    (global.fetch as jest.Mock).mockResolvedValue({\n      ok: true,\n      json: async () => ({\n        success: true,\n        users: [\n          {\n            id: '1',\n            email: 'user@example.com',\n            name: 'Test User',\n            role: 'user',\n            is_active: true,\n            created_at: '2024-01-01',\n          },\n        ],\n      }),\n    });\n  });\n\n  it('should fetch users from API', async () => {\n    render(<UserManagementPage />);\n    \n    await waitFor(() => {\n      expect(global.fetch).toHaveBeenCalledWith('/api/users');\n    });\n  });\n\n  it('should handle API errors', async () => {\n    (global.fetch as jest.Mock).mockRejectedValue(new Error('API Error'));\n    \n    render(<UserManagementPage />);\n    \n    await waitFor(() => {\n      // Should handle error gracefully\n      expect(screen.getByText(/.*/)).toBeTruthy();\n    });\n  });\n});\n"],"names":["jest","mock","actual","requireActual","useAuth","fn","useAdminAuth","Users","span","UserPlus","Shield","Crown","Star","Mail","Calendar","Activity","Search","Filter","MoreVertical","Edit","Trash2","Eye","RefreshCw","global","fetch","describe","beforeEach","clearAllMocks","sharedContexts","mockReturnValue","user","id","email","isAuthenticated","mockResolvedValue","ok","json","success","users","name","role","is_active","created_at","it","render","UserManagementPage","waitFor","expect","toHaveBeenCalledWith","mockRejectedValue","Error","screen","getByText","toBeTruthy"],"mappings":"AAAA;;;CAGC;AAQDA,KAAKC,IAAI,CAAC,6BAA6B;IACrC,MAAMC,SAASF,KAAKG,aAAa,CAAC;IAClC,OAAO;QACL,GAAGD,MAAM;QACTE,SAASJ,KAAKK,EAAE;QAChBC,cAAcN,KAAKK,EAAE;IACvB;AACF;AAIAL,KAAKC,IAAI,CAAC,gBAAgB,IAAO,CAAA;QAC/BM,OAAO,kBAAM,qBAACC;0BAAK;;QACnBC,UAAU,kBAAM,qBAACD;0BAAK;;QACtBE,QAAQ,kBAAM,qBAACF;0BAAK;;QACpBG,OAAO,kBAAM,qBAACH;0BAAK;;QACnBI,MAAM,kBAAM,qBAACJ;0BAAK;;QAClBK,MAAM,kBAAM,qBAACL;0BAAK;;QAClBM,UAAU,kBAAM,qBAACN;0BAAK;;QACtBO,UAAU,kBAAM,qBAACP;0BAAK;;QACtBQ,QAAQ,kBAAM,qBAACR;0BAAK;;QACpBS,QAAQ,kBAAM,qBAACT;0BAAK;;QACpBU,cAAc,kBAAM,qBAACV;0BAAK;;QAC1BW,MAAM,kBAAM,qBAACX;0BAAK;;QAClBY,QAAQ,kBAAM,qBAACZ;0BAAK;;QACpBa,KAAK,kBAAM,qBAACb;0BAAK;;QACjBc,WAAW,kBAAM,qBAACd;0BAAK;;IACzB,CAAA;;;;;8DAjCkB;wBACiC;QAC5C;6DACwB;wEACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWhCe,OAAOC,KAAK,GAAGxB,KAAKK,EAAE;AAoBtBoB,SAAS,6CAA6C;IACpDC,WAAW;QACT1B,KAAK2B,aAAa;QAEjBC,gBAAexB,OAAO,CAAeyB,eAAe,CAAC;YACpDC,MAAM;gBAAEC,IAAI;gBAAKC,OAAO;YAAoB;QAC9C;QAECJ,gBAAetB,YAAY,CAAeuB,eAAe,CAAC;YACzDI,iBAAiB;QACnB;QAECV,OAAOC,KAAK,CAAeU,iBAAiB,CAAC;YAC5CC,IAAI;YACJC,MAAM,UAAa,CAAA;oBACjBC,SAAS;oBACTC,OAAO;wBACL;4BACEP,IAAI;4BACJC,OAAO;4BACPO,MAAM;4BACNC,MAAM;4BACNC,WAAW;4BACXC,YAAY;wBACd;qBACD;gBACH,CAAA;QACF;IACF;IAEAC,GAAG,+BAA+B;QAChCC,IAAAA,cAAM,gBAAC,qBAACC,aAAkB;QAE1B,MAAMC,IAAAA,eAAO,EAAC;YACZC,OAAOxB,OAAOC,KAAK,EAAEwB,oBAAoB,CAAC;QAC5C;IACF;IAEAL,GAAG,4BAA4B;QAC5BpB,OAAOC,KAAK,CAAeyB,iBAAiB,CAAC,IAAIC,MAAM;QAExDN,IAAAA,cAAM,gBAAC,qBAACC,aAAkB;QAE1B,MAAMC,IAAAA,eAAO,EAAC;YACZ,iCAAiC;YACjCC,OAAOI,cAAM,CAACC,SAAS,CAAC,OAAOC,UAAU;QAC3C;IACF;AACF"}