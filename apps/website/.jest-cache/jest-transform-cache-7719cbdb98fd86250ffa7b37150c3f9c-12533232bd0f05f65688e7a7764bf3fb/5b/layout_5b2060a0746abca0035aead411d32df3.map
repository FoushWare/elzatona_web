{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/apps/website/src/app/admin/layout.tsx"],"sourcesContent":["'use client';\n\nimport React, { ReactNode } from 'react';\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\nconst supabase = createClient(supabaseUrl, supabaseServiceRoleKey);\n\nimport { AdminAuthProvider, useAdminAuth } from '@elzatona/shared-contexts';\nimport {\n  AdminNavbar,\n  NotificationContainer,\n  FirestoreErrorBoundary,\n} from '@elzatona/shared-components';\nimport { usePathname } from 'next/navigation';\n// ThemeProvider is already provided by root layout\nimport '../globals.css';\n\ninterface AdminLayoutProps {\n  children: React.ReactNode;\n}\n\nfunction AdminLayoutContent({ children }: AdminLayoutProps) {\n  const { isAuthenticated, isLoading } = useAdminAuth();\n  const pathname = usePathname();\n\n  // Skip authentication check for login page and admin root page\n  const isLoginPage = pathname === '/admin/login';\n  const isAdminRootPage = pathname === '/admin';\n\n  // TEMPORARY: Skip authentication for development/testing\n  const isDevelopment = process.env['NODE_ENV'] === 'development';\n  const skipAuthForTesting =\n    isDevelopment &&\n    (pathname?.includes('/admin/content/questions') ||\n      pathname?.includes('/admin/enhanced-structure') ||\n      pathname?.includes('/admin/content-management') ||\n      pathname?.includes('/admin/dashboard'));\n\n  // For login page and admin root page, render immediately without waiting for auth check\n  if (isLoginPage || isAdminRootPage) {\n    return <>{children}</>;\n  }\n\n  // For testing pages, render with navbar but skip auth check\n  if (skipAuthForTesting) {\n    return (\n      <div className='min-h-screen bg-gray-50 dark:bg-gray-900'>\n        <AdminNavbar />\n        <main className='pt-16'>{children}</main>\n        <NotificationContainer />\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className='min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center'>\n        <div className='text-center'>\n          <div className='animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4'></div>\n          <p className='text-gray-600 dark:text-gray-400'>\n            Loading admin panel...\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Check authentication for all other admin routes\n  if (!isAuthenticated) {\n    return null; // Will redirect to login via AdminAuthProvider\n  }\n\n  return (\n    <div className='min-h-screen bg-gray-50 dark:bg-gray-900'>\n      <AdminNavbar />\n      <main className='pt-16'>\n        <FirestoreErrorBoundary>{children}</FirestoreErrorBoundary>\n      </main>\n      <NotificationContainer />\n    </div>\n  );\n}\n\nexport default function AdminLayout({ children }: AdminLayoutProps) {\n  // TEMPORARY: Skip AdminAuthProvider for testing\n  const pathname = usePathname();\n  const isDevelopment = process.env['NODE_ENV'] === 'development';\n  const skipAuthForTesting =\n    isDevelopment &&\n    (pathname?.includes('/admin/content/questions') ||\n      pathname?.includes('/admin/enhanced-structure') ||\n      pathname?.includes('/admin/content-management') ||\n      pathname?.includes('/admin/dashboard'));\n\n  if (skipAuthForTesting) {\n    return (\n      <AdminAuthProvider>\n        <div className='min-h-screen bg-gray-50 dark:bg-gray-900'>\n          <AdminNavbar />\n          <main className='pt-16'>{children}</main>\n          <NotificationContainer />\n        </div>\n      </AdminAuthProvider>\n    );\n  }\n\n  return (\n    <AdminAuthProvider>\n      <AdminLayoutContent>{children}</AdminLayoutContent>\n    </AdminAuthProvider>\n  );\n}\n"],"names":["AdminLayout","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseServiceRoleKey","SUPABASE_SERVICE_ROLE_KEY","supabase","createClient","AdminLayoutContent","children","isAuthenticated","isLoading","useAdminAuth","pathname","usePathname","isLoginPage","isAdminRootPage","isDevelopment","skipAuthForTesting","includes","div","className","AdminNavbar","main","NotificationContainer","p","FirestoreErrorBoundary","AdminAuthProvider"],"mappings":"AAAA;;;;;+BAqFA;;;eAAwBA;;;;8DAnFS;4BACJ;gCAMmB;kCAKzC;4BACqB;QAErB;;;;;;AAZP,MAAMC,cAAcC,QAAQC,GAAG,CAACC,wBAAwB;AACxD,MAAMC,yBAAyBH,QAAQC,GAAG,CAACG,yBAAyB;AACpE,MAAMC,WAAWC,IAAAA,wBAAY,EAACP,aAAaI;AAgB3C,SAASI,mBAAmB,EAAEC,QAAQ,EAAoB;IACxD,MAAM,EAAEC,eAAe,EAAEC,SAAS,EAAE,GAAGC,IAAAA,4BAAY;IACnD,MAAMC,WAAWC,IAAAA,uBAAW;IAE5B,+DAA+D;IAC/D,MAAMC,cAAcF,aAAa;IACjC,MAAMG,kBAAkBH,aAAa;IAErC,yDAAyD;IACzD,MAAMI,gBAAgBhB,QAAQC,GAAG,CAAC,WAAW,KAAK;IAClD,MAAMgB,qBACJD,iBACCJ,CAAAA,UAAUM,SAAS,+BAClBN,UAAUM,SAAS,gCACnBN,UAAUM,SAAS,gCACnBN,UAAUM,SAAS,mBAAkB;IAEzC,wFAAwF;IACxF,IAAIJ,eAAeC,iBAAiB;QAClC,qBAAO;sBAAGP;;IACZ;IAEA,4DAA4D;IAC5D,IAAIS,oBAAoB;QACtB,qBACE,sBAACE;YAAIC,WAAU;;8BACb,qBAACC,6BAAW;8BACZ,qBAACC;oBAAKF,WAAU;8BAASZ;;8BACzB,qBAACe,uCAAqB;;;IAG5B;IAEA,IAAIb,WAAW;QACb,qBACE,qBAACS;YAAIC,WAAU;sBACb,cAAA,sBAACD;gBAAIC,WAAU;;kCACb,qBAACD;wBAAIC,WAAU;;kCACf,qBAACI;wBAAEJ,WAAU;kCAAmC;;;;;IAMxD;IAEA,kDAAkD;IAClD,IAAI,CAACX,iBAAiB;QACpB,OAAO,MAAM,+CAA+C;IAC9D;IAEA,qBACE,sBAACU;QAAIC,WAAU;;0BACb,qBAACC,6BAAW;0BACZ,qBAACC;gBAAKF,WAAU;0BACd,cAAA,qBAACK,wCAAsB;8BAAEjB;;;0BAE3B,qBAACe,uCAAqB;;;AAG5B;AAEe,SAASzB,YAAY,EAAEU,QAAQ,EAAoB;IAChE,gDAAgD;IAChD,MAAMI,WAAWC,IAAAA,uBAAW;IAC5B,MAAMG,gBAAgBhB,QAAQC,GAAG,CAAC,WAAW,KAAK;IAClD,MAAMgB,qBACJD,iBACCJ,CAAAA,UAAUM,SAAS,+BAClBN,UAAUM,SAAS,gCACnBN,UAAUM,SAAS,gCACnBN,UAAUM,SAAS,mBAAkB;IAEzC,IAAID,oBAAoB;QACtB,qBACE,qBAACS,iCAAiB;sBAChB,cAAA,sBAACP;gBAAIC,WAAU;;kCACb,qBAACC,6BAAW;kCACZ,qBAACC;wBAAKF,WAAU;kCAASZ;;kCACzB,qBAACe,uCAAqB;;;;IAI9B;IAEA,qBACE,qBAACG,iCAAiB;kBAChB,cAAA,qBAACnB;sBAAoBC;;;AAG3B"}