e2ca784ff68e0bf7b18747aac3b08be2
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return AdminLayout;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _supabasejs = require("@supabase/supabase-js");
const _sharedcontexts = require("../../../../../libs/shared-contexts/src");
const _sharedcomponents = require("../../../../../libs/shared-components/src");
const _navigation = require("next/navigation");
require("../globals.css");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseServiceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
const supabase = (0, _supabasejs.createClient)(supabaseUrl, supabaseServiceRoleKey);
function AdminLayoutContent({ children }) {
    const { isAuthenticated, isLoading } = (0, _sharedcontexts.useAdminAuth)();
    const pathname = (0, _navigation.usePathname)();
    // Skip authentication check for login page and admin root page
    const isLoginPage = pathname === '/admin/login';
    const isAdminRootPage = pathname === '/admin';
    // TEMPORARY: Skip authentication for development/testing
    const isDevelopment = process.env['NODE_ENV'] === 'development';
    const skipAuthForTesting = isDevelopment && (pathname?.includes('/admin/content/questions') || pathname?.includes('/admin/enhanced-structure') || pathname?.includes('/admin/content-management') || pathname?.includes('/admin/dashboard'));
    // For login page and admin root page, render immediately without waiting for auth check
    if (isLoginPage || isAdminRootPage) {
        return /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
            children: children
        });
    }
    // For testing pages, render with navbar but skip auth check
    if (skipAuthForTesting) {
        return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            className: "min-h-screen bg-gray-50 dark:bg-gray-900",
            children: [
                /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcomponents.AdminNavbar, {}),
                /*#__PURE__*/ (0, _jsxruntime.jsx)("main", {
                    className: "pt-16",
                    children: children
                }),
                /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcomponents.NotificationContainer, {})
            ]
        });
    }
    if (isLoading) {
        return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
            className: "min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",
            children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                className: "text-center",
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        className: "animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                        className: "text-gray-600 dark:text-gray-400",
                        children: "Loading admin panel..."
                    })
                ]
            })
        });
    }
    // Check authentication for all other admin routes
    if (!isAuthenticated) {
        return null; // Will redirect to login via AdminAuthProvider
    }
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        className: "min-h-screen bg-gray-50 dark:bg-gray-900",
        children: [
            /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcomponents.AdminNavbar, {}),
            /*#__PURE__*/ (0, _jsxruntime.jsx)("main", {
                className: "pt-16",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcomponents.FirestoreErrorBoundary, {
                    children: children
                })
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcomponents.NotificationContainer, {})
        ]
    });
}
function AdminLayout({ children }) {
    // TEMPORARY: Skip AdminAuthProvider for testing
    const pathname = (0, _navigation.usePathname)();
    const isDevelopment = process.env['NODE_ENV'] === 'development';
    const skipAuthForTesting = isDevelopment && (pathname?.includes('/admin/content/questions') || pathname?.includes('/admin/enhanced-structure') || pathname?.includes('/admin/content-management') || pathname?.includes('/admin/dashboard'));
    if (skipAuthForTesting) {
        return /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcontexts.AdminAuthProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                className: "min-h-screen bg-gray-50 dark:bg-gray-900",
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcomponents.AdminNavbar, {}),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("main", {
                        className: "pt-16",
                        children: children
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcomponents.NotificationContainer, {})
                ]
            })
        });
    }
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcontexts.AdminAuthProvider, {
        children: /*#__PURE__*/ (0, _jsxruntime.jsx)(AdminLayoutContent, {
            children: children
        })
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hLmZvdWFkL1NpZGVQcm9qZWN0cy9FbHphdG9uYS1hbGwvRWx6YXRvbmEtd2ViL2FwcHMvd2Vic2l0ZS9zcmMvYXBwL2FkbWluL2xheW91dC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBjbGllbnQnO1xuXG5pbXBvcnQgUmVhY3QsIHsgUmVhY3ROb2RlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhO1xuY29uc3Qgc3VwYWJhc2VTZXJ2aWNlUm9sZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkhO1xuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZVJvbGVLZXkpO1xuXG5pbXBvcnQgeyBBZG1pbkF1dGhQcm92aWRlciwgdXNlQWRtaW5BdXRoIH0gZnJvbSAnQGVsemF0b25hL3NoYXJlZC1jb250ZXh0cyc7XG5pbXBvcnQge1xuICBBZG1pbk5hdmJhcixcbiAgTm90aWZpY2F0aW9uQ29udGFpbmVyLFxuICBGaXJlc3RvcmVFcnJvckJvdW5kYXJ5LFxufSBmcm9tICdAZWx6YXRvbmEvc2hhcmVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IHsgdXNlUGF0aG5hbWUgfSBmcm9tICduZXh0L25hdmlnYXRpb24nO1xuLy8gVGhlbWVQcm92aWRlciBpcyBhbHJlYWR5IHByb3ZpZGVkIGJ5IHJvb3QgbGF5b3V0XG5pbXBvcnQgJy4uL2dsb2JhbHMuY3NzJztcblxuaW50ZXJmYWNlIEFkbWluTGF5b3V0UHJvcHMge1xuICBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlO1xufVxuXG5mdW5jdGlvbiBBZG1pbkxheW91dENvbnRlbnQoeyBjaGlsZHJlbiB9OiBBZG1pbkxheW91dFByb3BzKSB7XG4gIGNvbnN0IHsgaXNBdXRoZW50aWNhdGVkLCBpc0xvYWRpbmcgfSA9IHVzZUFkbWluQXV0aCgpO1xuICBjb25zdCBwYXRobmFtZSA9IHVzZVBhdGhuYW1lKCk7XG5cbiAgLy8gU2tpcCBhdXRoZW50aWNhdGlvbiBjaGVjayBmb3IgbG9naW4gcGFnZSBhbmQgYWRtaW4gcm9vdCBwYWdlXG4gIGNvbnN0IGlzTG9naW5QYWdlID0gcGF0aG5hbWUgPT09ICcvYWRtaW4vbG9naW4nO1xuICBjb25zdCBpc0FkbWluUm9vdFBhZ2UgPSBwYXRobmFtZSA9PT0gJy9hZG1pbic7XG5cbiAgLy8gVEVNUE9SQVJZOiBTa2lwIGF1dGhlbnRpY2F0aW9uIGZvciBkZXZlbG9wbWVudC90ZXN0aW5nXG4gIGNvbnN0IGlzRGV2ZWxvcG1lbnQgPSBwcm9jZXNzLmVudlsnTk9ERV9FTlYnXSA9PT0gJ2RldmVsb3BtZW50JztcbiAgY29uc3Qgc2tpcEF1dGhGb3JUZXN0aW5nID1cbiAgICBpc0RldmVsb3BtZW50ICYmXG4gICAgKHBhdGhuYW1lPy5pbmNsdWRlcygnL2FkbWluL2NvbnRlbnQvcXVlc3Rpb25zJykgfHxcbiAgICAgIHBhdGhuYW1lPy5pbmNsdWRlcygnL2FkbWluL2VuaGFuY2VkLXN0cnVjdHVyZScpIHx8XG4gICAgICBwYXRobmFtZT8uaW5jbHVkZXMoJy9hZG1pbi9jb250ZW50LW1hbmFnZW1lbnQnKSB8fFxuICAgICAgcGF0aG5hbWU/LmluY2x1ZGVzKCcvYWRtaW4vZGFzaGJvYXJkJykpO1xuXG4gIC8vIEZvciBsb2dpbiBwYWdlIGFuZCBhZG1pbiByb290IHBhZ2UsIHJlbmRlciBpbW1lZGlhdGVseSB3aXRob3V0IHdhaXRpbmcgZm9yIGF1dGggY2hlY2tcbiAgaWYgKGlzTG9naW5QYWdlIHx8IGlzQWRtaW5Sb290UGFnZSkge1xuICAgIHJldHVybiA8PntjaGlsZHJlbn08Lz47XG4gIH1cblxuICAvLyBGb3IgdGVzdGluZyBwYWdlcywgcmVuZGVyIHdpdGggbmF2YmFyIGJ1dCBza2lwIGF1dGggY2hlY2tcbiAgaWYgKHNraXBBdXRoRm9yVGVzdGluZykge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nbWluLWgtc2NyZWVuIGJnLWdyYXktNTAgZGFyazpiZy1ncmF5LTkwMCc+XG4gICAgICAgIDxBZG1pbk5hdmJhciAvPlxuICAgICAgICA8bWFpbiBjbGFzc05hbWU9J3B0LTE2Jz57Y2hpbGRyZW59PC9tYWluPlxuICAgICAgICA8Tm90aWZpY2F0aW9uQ29udGFpbmVyIC8+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgaWYgKGlzTG9hZGluZykge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nbWluLWgtc2NyZWVuIGJnLWdyYXktNTAgZGFyazpiZy1ncmF5LTkwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlcic+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0ZXh0LWNlbnRlcic+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2FuaW1hdGUtc3BpbiByb3VuZGVkLWZ1bGwgaC0xMiB3LTEyIGJvcmRlci1iLTIgYm9yZGVyLXJlZC02MDAgbXgtYXV0byBtYi00Jz48L2Rpdj5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9J3RleHQtZ3JheS02MDAgZGFyazp0ZXh0LWdyYXktNDAwJz5cbiAgICAgICAgICAgIExvYWRpbmcgYWRtaW4gcGFuZWwuLi5cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uIGZvciBhbGwgb3RoZXIgYWRtaW4gcm91dGVzXG4gIGlmICghaXNBdXRoZW50aWNhdGVkKSB7XG4gICAgcmV0dXJuIG51bGw7IC8vIFdpbGwgcmVkaXJlY3QgdG8gbG9naW4gdmlhIEFkbWluQXV0aFByb3ZpZGVyXG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPSdtaW4taC1zY3JlZW4gYmctZ3JheS01MCBkYXJrOmJnLWdyYXktOTAwJz5cbiAgICAgIDxBZG1pbk5hdmJhciAvPlxuICAgICAgPG1haW4gY2xhc3NOYW1lPSdwdC0xNic+XG4gICAgICAgIDxGaXJlc3RvcmVFcnJvckJvdW5kYXJ5PntjaGlsZHJlbn08L0ZpcmVzdG9yZUVycm9yQm91bmRhcnk+XG4gICAgICA8L21haW4+XG4gICAgICA8Tm90aWZpY2F0aW9uQ29udGFpbmVyIC8+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEFkbWluTGF5b3V0KHsgY2hpbGRyZW4gfTogQWRtaW5MYXlvdXRQcm9wcykge1xuICAvLyBURU1QT1JBUlk6IFNraXAgQWRtaW5BdXRoUHJvdmlkZXIgZm9yIHRlc3RpbmdcbiAgY29uc3QgcGF0aG5hbWUgPSB1c2VQYXRobmFtZSgpO1xuICBjb25zdCBpc0RldmVsb3BtZW50ID0gcHJvY2Vzcy5lbnZbJ05PREVfRU5WJ10gPT09ICdkZXZlbG9wbWVudCc7XG4gIGNvbnN0IHNraXBBdXRoRm9yVGVzdGluZyA9XG4gICAgaXNEZXZlbG9wbWVudCAmJlxuICAgIChwYXRobmFtZT8uaW5jbHVkZXMoJy9hZG1pbi9jb250ZW50L3F1ZXN0aW9ucycpIHx8XG4gICAgICBwYXRobmFtZT8uaW5jbHVkZXMoJy9hZG1pbi9lbmhhbmNlZC1zdHJ1Y3R1cmUnKSB8fFxuICAgICAgcGF0aG5hbWU/LmluY2x1ZGVzKCcvYWRtaW4vY29udGVudC1tYW5hZ2VtZW50JykgfHxcbiAgICAgIHBhdGhuYW1lPy5pbmNsdWRlcygnL2FkbWluL2Rhc2hib2FyZCcpKTtcblxuICBpZiAoc2tpcEF1dGhGb3JUZXN0aW5nKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxBZG1pbkF1dGhQcm92aWRlcj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J21pbi1oLXNjcmVlbiBiZy1ncmF5LTUwIGRhcms6YmctZ3JheS05MDAnPlxuICAgICAgICAgIDxBZG1pbk5hdmJhciAvPlxuICAgICAgICAgIDxtYWluIGNsYXNzTmFtZT0ncHQtMTYnPntjaGlsZHJlbn08L21haW4+XG4gICAgICAgICAgPE5vdGlmaWNhdGlvbkNvbnRhaW5lciAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvQWRtaW5BdXRoUHJvdmlkZXI+XG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPEFkbWluQXV0aFByb3ZpZGVyPlxuICAgICAgPEFkbWluTGF5b3V0Q29udGVudD57Y2hpbGRyZW59PC9BZG1pbkxheW91dENvbnRlbnQ+XG4gICAgPC9BZG1pbkF1dGhQcm92aWRlcj5cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJBZG1pbkxheW91dCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlU2VydmljZVJvbGVLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwic3VwYWJhc2UiLCJjcmVhdGVDbGllbnQiLCJBZG1pbkxheW91dENvbnRlbnQiLCJjaGlsZHJlbiIsImlzQXV0aGVudGljYXRlZCIsImlzTG9hZGluZyIsInVzZUFkbWluQXV0aCIsInBhdGhuYW1lIiwidXNlUGF0aG5hbWUiLCJpc0xvZ2luUGFnZSIsImlzQWRtaW5Sb290UGFnZSIsImlzRGV2ZWxvcG1lbnQiLCJza2lwQXV0aEZvclRlc3RpbmciLCJpbmNsdWRlcyIsImRpdiIsImNsYXNzTmFtZSIsIkFkbWluTmF2YmFyIiwibWFpbiIsIk5vdGlmaWNhdGlvbkNvbnRhaW5lciIsInAiLCJGaXJlc3RvcmVFcnJvckJvdW5kYXJ5IiwiQWRtaW5BdXRoUHJvdmlkZXIiXSwibWFwcGluZ3MiOiJBQUFBOzs7OzsrQkFxRkE7OztlQUF3QkE7Ozs7OERBbkZTOzRCQUNKO2dDQU1tQjtrQ0FLekM7NEJBQ3FCO1FBRXJCOzs7Ozs7QUFaUCxNQUFNQyxjQUFjQyxRQUFRQyxHQUFHLENBQUNDLHdCQUF3QjtBQUN4RCxNQUFNQyx5QkFBeUJILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCO0FBQ3BFLE1BQU1DLFdBQVdDLElBQUFBLHdCQUFZLEVBQUNQLGFBQWFJO0FBZ0IzQyxTQUFTSSxtQkFBbUIsRUFBRUMsUUFBUSxFQUFvQjtJQUN4RCxNQUFNLEVBQUVDLGVBQWUsRUFBRUMsU0FBUyxFQUFFLEdBQUdDLElBQUFBLDRCQUFZO0lBQ25ELE1BQU1DLFdBQVdDLElBQUFBLHVCQUFXO0lBRTVCLCtEQUErRDtJQUMvRCxNQUFNQyxjQUFjRixhQUFhO0lBQ2pDLE1BQU1HLGtCQUFrQkgsYUFBYTtJQUVyQyx5REFBeUQ7SUFDekQsTUFBTUksZ0JBQWdCaEIsUUFBUUMsR0FBRyxDQUFDLFdBQVcsS0FBSztJQUNsRCxNQUFNZ0IscUJBQ0pELGlCQUNDSixDQUFBQSxVQUFVTSxTQUFTLCtCQUNsQk4sVUFBVU0sU0FBUyxnQ0FDbkJOLFVBQVVNLFNBQVMsZ0NBQ25CTixVQUFVTSxTQUFTLG1CQUFrQjtJQUV6Qyx3RkFBd0Y7SUFDeEYsSUFBSUosZUFBZUMsaUJBQWlCO1FBQ2xDLHFCQUFPO3NCQUFHUDs7SUFDWjtJQUVBLDREQUE0RDtJQUM1RCxJQUFJUyxvQkFBb0I7UUFDdEIscUJBQ0Usc0JBQUNFO1lBQUlDLFdBQVU7OzhCQUNiLHFCQUFDQyw2QkFBVzs4QkFDWixxQkFBQ0M7b0JBQUtGLFdBQVU7OEJBQVNaOzs4QkFDekIscUJBQUNlLHVDQUFxQjs7O0lBRzVCO0lBRUEsSUFBSWIsV0FBVztRQUNiLHFCQUNFLHFCQUFDUztZQUFJQyxXQUFVO3NCQUNiLGNBQUEsc0JBQUNEO2dCQUFJQyxXQUFVOztrQ0FDYixxQkFBQ0Q7d0JBQUlDLFdBQVU7O2tDQUNmLHFCQUFDSTt3QkFBRUosV0FBVTtrQ0FBbUM7Ozs7O0lBTXhEO0lBRUEsa0RBQWtEO0lBQ2xELElBQUksQ0FBQ1gsaUJBQWlCO1FBQ3BCLE9BQU8sTUFBTSwrQ0FBK0M7SUFDOUQ7SUFFQSxxQkFDRSxzQkFBQ1U7UUFBSUMsV0FBVTs7MEJBQ2IscUJBQUNDLDZCQUFXOzBCQUNaLHFCQUFDQztnQkFBS0YsV0FBVTswQkFDZCxjQUFBLHFCQUFDSyx3Q0FBc0I7OEJBQUVqQjs7OzBCQUUzQixxQkFBQ2UsdUNBQXFCOzs7QUFHNUI7QUFFZSxTQUFTekIsWUFBWSxFQUFFVSxRQUFRLEVBQW9CO0lBQ2hFLGdEQUFnRDtJQUNoRCxNQUFNSSxXQUFXQyxJQUFBQSx1QkFBVztJQUM1QixNQUFNRyxnQkFBZ0JoQixRQUFRQyxHQUFHLENBQUMsV0FBVyxLQUFLO0lBQ2xELE1BQU1nQixxQkFDSkQsaUJBQ0NKLENBQUFBLFVBQVVNLFNBQVMsK0JBQ2xCTixVQUFVTSxTQUFTLGdDQUNuQk4sVUFBVU0sU0FBUyxnQ0FDbkJOLFVBQVVNLFNBQVMsbUJBQWtCO0lBRXpDLElBQUlELG9CQUFvQjtRQUN0QixxQkFDRSxxQkFBQ1MsaUNBQWlCO3NCQUNoQixjQUFBLHNCQUFDUDtnQkFBSUMsV0FBVTs7a0NBQ2IscUJBQUNDLDZCQUFXO2tDQUNaLHFCQUFDQzt3QkFBS0YsV0FBVTtrQ0FBU1o7O2tDQUN6QixxQkFBQ2UsdUNBQXFCOzs7O0lBSTlCO0lBRUEscUJBQ0UscUJBQUNHLGlDQUFpQjtrQkFDaEIsY0FBQSxxQkFBQ25CO3NCQUFvQkM7OztBQUczQiJ9