{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/libs/shared-hooks/src/lib/useLearningPaths.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\n\nexport interface LearningPath {\n  id: string;\n  name: string;\n  description: string;\n  question_count: number;\n  icon: string;\n  color: string;\n  order: number;\n  is_active: boolean;\n  created_at: string;\n  updated_at: string;\n  difficulty?: 'beginner' | 'intermediate' | 'advanced'; // optional\n  estimatedTime?: number; // in minutes - optional\n  category?: string; // optional\n  sectors?: Array<{\n    id: string;\n    name: string;\n    question_count: number;\n  }>;\n}\n\ninterface UseLearningPathsReturn {\n  learningPaths: LearningPath[];\n  isLoading: boolean;\n  error: string | null;\n  refetch: () => void;\n}\n\nexport function useLearningPaths(): UseLearningPathsReturn {\n  console.log('ðŸš€ useLearningPaths hook called');\n  const [learningPaths, setLearningPaths] = useState<LearningPath[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchLearningPaths = useCallback(async () => {\n    try {\n      console.log('ðŸ”„ Fetching learning paths...');\n      setIsLoading(true);\n      setError(null);\n\n      // Fallback to existing plans endpoint since learning_paths table is not present\n      const response = await fetch('/api/plans', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      console.log('ðŸ“¡ API response status:', response.status);\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      console.log('ðŸ“Š API response data:', data);\n\n      // Map plans to LearningPath shape minimally\n      if (Array.isArray(data.plans)) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const mapped = data.plans.map((p: any) => ({\n          id: p.id,\n          name: p.name || 'Plan',\n          description: p.title || '',\n          question_count: 0,\n          icon: 'Target',\n          color: 'indigo',\n          order: 0,\n          is_active: true,\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString(),\n          sectors: [],\n        }));\n        console.log('âœ… Learning plans mapped:', mapped.length);\n        setLearningPaths(mapped);\n      } else if (data.success && Array.isArray(data.data)) {\n        // Support original learning-paths response shape if added later\n        console.log('âœ… Learning paths loaded:', data.data.length);\n        setLearningPaths(data.data);\n      } else {\n        throw new Error(data.error || 'Invalid response format');\n      }\n    } catch (err) {\n      console.error('âŒ Error fetching learning paths:', err);\n      const errorMessage =\n        err instanceof Error ? err.message : 'Failed to fetch learning paths';\n      setError(errorMessage);\n      setLearningPaths([]);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const refetch = useCallback(() => {\n    fetchLearningPaths();\n  }, [fetchLearningPaths]);\n\n  useEffect(() => {\n    // Only run on client side\n    if (typeof window !== 'undefined') {\n      fetchLearningPaths();\n    }\n  }, [fetchLearningPaths]);\n\n  return {\n    learningPaths,\n    isLoading,\n    error,\n    refetch,\n  };\n}\n"],"names":["useLearningPaths","console","log","learningPaths","setLearningPaths","useState","isLoading","setIsLoading","error","setError","fetchLearningPaths","useCallback","response","fetch","method","headers","status","ok","Error","statusText","data","json","Array","isArray","plans","mapped","map","p","id","name","description","title","question_count","icon","color","order","is_active","created_at","Date","toISOString","updated_at","sectors","length","success","err","errorMessage","message","refetch","useEffect","window"],"mappings":"AAAA;;;;;+BAgCgBA;;;eAAAA;;;uBA9BiC;AA8B1C,SAASA;IACdC,QAAQC,GAAG,CAAC;IACZ,MAAM,CAACC,eAAeC,iBAAiB,GAAGC,IAAAA,eAAQ,EAAiB,EAAE;IACrE,MAAM,CAACC,WAAWC,aAAa,GAAGF,IAAAA,eAAQ,EAAC;IAC3C,MAAM,CAACG,OAAOC,SAAS,GAAGJ,IAAAA,eAAQ,EAAgB;IAElD,MAAMK,qBAAqBC,IAAAA,kBAAW,EAAC;QACrC,IAAI;YACFV,QAAQC,GAAG,CAAC;YACZK,aAAa;YACbE,SAAS;YAET,gFAAgF;YAChF,MAAMG,WAAW,MAAMC,MAAM,cAAc;gBACzCC,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;gBAClB;YACF;YAEAd,QAAQC,GAAG,CAAC,2BAA2BU,SAASI,MAAM;YAEtD,IAAI,CAACJ,SAASK,EAAE,EAAE;gBAChB,MAAM,IAAIC,MAAM,CAAC,KAAK,EAAEN,SAASI,MAAM,CAAC,EAAE,EAAEJ,SAASO,UAAU,EAAE;YACnE;YAEA,MAAMC,OAAO,MAAMR,SAASS,IAAI;YAChCpB,QAAQC,GAAG,CAAC,yBAAyBkB;YAErC,4CAA4C;YAC5C,IAAIE,MAAMC,OAAO,CAACH,KAAKI,KAAK,GAAG;gBAC7B,8DAA8D;gBAC9D,MAAMC,SAASL,KAAKI,KAAK,CAACE,GAAG,CAAC,CAACC,IAAY,CAAA;wBACzCC,IAAID,EAAEC,EAAE;wBACRC,MAAMF,EAAEE,IAAI,IAAI;wBAChBC,aAAaH,EAAEI,KAAK,IAAI;wBACxBC,gBAAgB;wBAChBC,MAAM;wBACNC,OAAO;wBACPC,OAAO;wBACPC,WAAW;wBACXC,YAAY,IAAIC,OAAOC,WAAW;wBAClCC,YAAY,IAAIF,OAAOC,WAAW;wBAClCE,SAAS,EAAE;oBACb,CAAA;gBACAxC,QAAQC,GAAG,CAAC,4BAA4BuB,OAAOiB,MAAM;gBACrDtC,iBAAiBqB;YACnB,OAAO,IAAIL,KAAKuB,OAAO,IAAIrB,MAAMC,OAAO,CAACH,KAAKA,IAAI,GAAG;gBACnD,gEAAgE;gBAChEnB,QAAQC,GAAG,CAAC,4BAA4BkB,KAAKA,IAAI,CAACsB,MAAM;gBACxDtC,iBAAiBgB,KAAKA,IAAI;YAC5B,OAAO;gBACL,MAAM,IAAIF,MAAME,KAAKZ,KAAK,IAAI;YAChC;QACF,EAAE,OAAOoC,KAAK;YACZ3C,QAAQO,KAAK,CAAC,oCAAoCoC;YAClD,MAAMC,eACJD,eAAe1B,QAAQ0B,IAAIE,OAAO,GAAG;YACvCrC,SAASoC;YACTzC,iBAAiB,EAAE;QACrB,SAAU;YACRG,aAAa;QACf;IACF,GAAG,EAAE;IAEL,MAAMwC,UAAUpC,IAAAA,kBAAW,EAAC;QAC1BD;IACF,GAAG;QAACA;KAAmB;IAEvBsC,IAAAA,gBAAS,EAAC;QACR,0BAA0B;QAC1B,IAAI,OAAOC,WAAW,aAAa;YACjCvC;QACF;IACF,GAAG;QAACA;KAAmB;IAEvB,OAAO;QACLP;QACAG;QACAE;QACAuC;IACF;AACF"}