f790c55018d53a31d826564f2374e61d
/**
 * Admin Login UI Tests
 *
 * Tests for the admin login page component to ensure:
 * - Form rendering and validation
 * - User interactions
 * - Error handling
 * - Loading states
 * - Responsive design
 */ // Set up environment variables before any imports
"use strict";
// Mock Supabase before any imports that use it
jest.mock('@supabase/supabase-js', ()=>({
        createClient: jest.fn(()=>({
                from: jest.fn(()=>({
                        select: jest.fn(()=>({
                                eq: jest.fn(()=>({
                                        single: jest.fn().mockResolvedValue({
                                            data: null,
                                            error: null
                                        })
                                    }))
                            }))
                    })),
                auth: {
                    onAuthStateChange: jest.fn(()=>({
                            data: {
                                subscription: null
                            },
                            error: null
                        })),
                    getSession: jest.fn().mockResolvedValue({
                        data: {
                            session: null
                        },
                        error: null
                    }),
                    getUser: jest.fn().mockResolvedValue({
                        data: {
                            user: null
                        },
                        error: null
                    })
                }
            }))
    }));
// Mock nuqs before any imports
jest.mock('nuqs', ()=>({
        useQueryState: jest.fn(()=>[
                null,
                jest.fn()
            ]),
        useQueryStates: jest.fn(()=>[
                {},
                jest.fn()
            ]),
        parseAsString: jest.fn(),
        parseAsInteger: jest.fn(),
        createSearchParamsCache: jest.fn()
    }));
// Mock @tanstack/react-query
jest.mock('@tanstack/react-query', ()=>{
    // eslint-disable-next-line @typescript-eslint/no-require-imports
    const React = require('react');
    return {
        QueryClientProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        QueryClient: jest.fn(()=>({
                invalidateQueries: jest.fn(),
                setQueryData: jest.fn(),
                getQueryData: jest.fn()
            })),
        useQueryClient: jest.fn(()=>({
                invalidateQueries: jest.fn(),
                setQueryData: jest.fn(),
                getQueryData: jest.fn()
            })),
        useQuery: jest.fn(()=>({
                data: null,
                isLoading: false,
                error: null
            })),
        useMutation: jest.fn(()=>({
                mutate: jest.fn(),
                mutateAsync: jest.fn(),
                isLoading: false,
                error: null
            }))
    };
});
// Mock Next.js router
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn(),
        usePathname: jest.fn(()=>'/admin/login')
    }));
// Mock the actual AdminAuthContext file
jest.mock('../../libs/shared-contexts/src/lib/AdminAuthContext', ()=>{
    // eslint-disable-next-line @typescript-eslint/no-require-imports
    const React = require('react');
    const mockFn = jest.fn(()=>({
            isAuthenticated: false,
            isLoading: false,
            login: jest.fn(),
            logout: jest.fn(),
            user: null
        }));
    return {
        AdminAuthProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        useAdminAuth: mockFn
    };
});
// Mock the actual ThemeContext file
jest.mock('../../libs/shared-contexts/src/lib/ThemeContext', ()=>({
        ThemeProvider: ({ children })=>children,
        useTheme: jest.fn(()=>({
                isDarkMode: false,
                toggleDarkMode: jest.fn(),
                setDarkMode: jest.fn(),
                isLoaded: true
            }))
    }));
jest.mock('@elzatona/shared-contexts', ()=>{
    // eslint-disable-next-line @typescript-eslint/no-require-imports
    const React = require('react');
    return {
        AdminAuthProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        useAdminAuth: mockUseAdminAuthFn,
        ThemeProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        useTheme: jest.fn(()=>({
                isDarkMode: false,
                toggleDarkMode: jest.fn()
            }))
    };
});
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _react1 = require("@testing-library/react");
const _navigation = require("next/navigation");
const _page = /*#__PURE__*/ _interop_require_default(require("../../apps/website/src/app/admin/login/page"));
const _sharedcontexts = require("../../libs/shared-contexts/src");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
process.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co';
process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test-anon-key';
process.env.SUPABASE_SERVICE_ROLE_KEY = 'test-service-role-key';
// Also mock the package entry point
// Create a mock function that can be configured per test
const mockUseAdminAuthFn = jest.fn();
// Mock fetch for API calls
global.fetch = jest.fn();
// MockAdminAuth interface removed - not used in tests
describe('Admin Login Page', ()=>{
    const mockPush = jest.fn();
    const mockUseRouter = _navigation.useRouter;
    const mockLogin = jest.fn();
    beforeEach(()=>{
        jest.clearAllMocks();
        // Reset mock admin auth function to return default values
        // Use mockReturnValue to ensure consistent object reference
        mockUseAdminAuthFn.mockReturnValue({
            isAuthenticated: false,
            isLoading: false,
            login: mockLogin,
            logout: jest.fn(),
            user: null
        });
        mockUseRouter.mockReturnValue({
            push: mockPush,
            replace: jest.fn(),
            prefetch: jest.fn(),
            back: jest.fn(),
            forward: jest.fn(),
            refresh: jest.fn()
        });
    });
    afterEach(()=>{
        jest.restoreAllMocks();
    });
    describe('Page Rendering', ()=>{
        it('should render login form with all required elements', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcontexts.AdminAuthProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            expect(_react1.screen.getByText('Admin Login')).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/password/i)).toBeInTheDocument();
            expect(_react1.screen.getByRole('button', {
                name: /sign in/i
            })).toBeInTheDocument();
        });
        it('should render admin navbar', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            expect(_react1.screen.getByText('Admin Access Portal')).toBeInTheDocument();
            expect(_react1.screen.getByText('Secure Authentication Required')).toBeInTheDocument();
        });
        it('should show loading state when authentication is in progress', ()=>{
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: true,
                login: mockLogin,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            expect(_react1.screen.getByText('Loading...')).toBeInTheDocument();
        });
        it('should render login form when not authenticated', ()=>{
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: false,
                login: mockLogin,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            // Component should render the login form when not authenticated
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/password/i)).toBeInTheDocument();
        });
    });
    describe('Form Validation', ()=>{
        it('should use HTML5 validation for empty fields', async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            // HTML5 validation - check required attribute
            expect(emailInput).toHaveAttribute('required');
            expect(passwordInput).toHaveAttribute('required');
        });
        it('should use HTML5 email validation', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            // HTML5 email validation
            expect(emailInput).toHaveAttribute('type', 'email');
        });
        it('should allow form input changes', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'test@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            expect(emailInput).toHaveValue('test@example.com');
            expect(passwordInput).toHaveValue('password123');
        });
    });
    describe('Form Submission', ()=>{
        it('should call login function with correct credentials', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: true
            });
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            const { container } = (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = container.querySelector('form');
            // Verify the mock is set up correctly
            expect(mockUseAdminAuthFn).toHaveBeenCalled();
            const mockResult = mockUseAdminAuthFn.mock.results[0]?.value;
            expect(mockResult?.login).toBe(loginMock);
            await (0, _react1.act)(async ()=>{
                _react1.fireEvent.change(emailInput, {
                    target: {
                        value: 'admin@example.com'
                    }
                });
                _react1.fireEvent.change(passwordInput, {
                    target: {
                        value: 'password123'
                    }
                });
                if (form) {
                    _react1.fireEvent.submit(form);
                }
            });
            await (0, _react1.waitFor)(()=>{
                expect(loginMock).toHaveBeenCalledWith('admin@example.com', 'password123');
            }, {
                timeout: 5000
            });
        });
        it('should show loading state during login', async ()=>{
            const loginMock = jest.fn().mockImplementation(()=>new Promise((resolve)=>setTimeout(resolve, 100)));
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const loginButton = _react1.screen.getByRole('button', {
                name: /sign in/i
            });
            const form = emailInput.closest('form');
            await (0, _react1.act)(async ()=>{
                _react1.fireEvent.change(emailInput, {
                    target: {
                        value: 'admin@example.com'
                    }
                });
                _react1.fireEvent.change(passwordInput, {
                    target: {
                        value: 'password123'
                    }
                });
                if (form) {
                    _react1.fireEvent.submit(form);
                }
            });
            // Check loading state immediately after submission
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('Signing In...')).toBeInTheDocument();
                expect(loginButton).toBeDisabled();
            }, {
                timeout: 5000
            });
        });
        it('should show error message on login failure', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: false,
                error: 'Invalid credentials'
            });
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = emailInput.closest('form');
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'wrongpassword'
                }
            });
            if (form) {
                _react1.fireEvent.submit(form);
            }
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('Invalid credentials')).toBeInTheDocument();
            }, {
                timeout: 5000
            });
        });
        it('should handle network errors gracefully', async ()=>{
            const loginMock = jest.fn().mockRejectedValue(new Error('Network error'));
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = emailInput.closest('form');
            await (0, _react1.act)(async ()=>{
                _react1.fireEvent.change(emailInput, {
                    target: {
                        value: 'admin@example.com'
                    }
                });
                _react1.fireEvent.change(passwordInput, {
                    target: {
                        value: 'password123'
                    }
                });
                if (form) {
                    _react1.fireEvent.submit(form);
                }
            });
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('An unexpected error occurred')).toBeInTheDocument();
            }, {
                timeout: 5000
            });
        });
    });
    describe('User Interactions', ()=>{
        it('should have password field with password type', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            expect(passwordInput).toHaveAttribute('type', 'password');
        });
        it('should submit form on Enter key press', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: true
            });
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            await (0, _react1.act)(async ()=>{
                _react1.fireEvent.change(emailInput, {
                    target: {
                        value: 'admin@example.com'
                    }
                });
                _react1.fireEvent.change(passwordInput, {
                    target: {
                        value: 'password123'
                    }
                });
                _react1.fireEvent.keyDown(passwordInput, {
                    key: 'Enter',
                    code: 'Enter',
                    charCode: 13
                });
            });
            await (0, _react1.waitFor)(()=>{
                expect(loginMock).toHaveBeenCalledWith('admin@example.com', 'password123');
            }, {
                timeout: 5000
            });
        });
        it('should allow form field input', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            expect(emailInput).toHaveValue('admin@example.com');
            expect(passwordInput).toHaveValue('password123');
        });
    });
    describe('Accessibility', ()=>{
        it('should have proper ARIA labels', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/password/i)).toBeInTheDocument();
            expect(_react1.screen.getByRole('button', {
                name: /sign in/i
            })).toBeInTheDocument();
        });
        it('should be keyboard navigable', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const loginButton = _react1.screen.getByRole('button', {
                name: /sign in/i
            });
            // Check that inputs are focusable
            emailInput.focus();
            expect(emailInput).toHaveFocus();
            // Check that password input is focusable
            passwordInput.focus();
            expect(passwordInput).toHaveFocus();
            // Check that button is focusable
            loginButton.focus();
            expect(loginButton).toHaveFocus();
        });
        it('should display error messages when login fails', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: false,
                error: 'Invalid credentials'
            });
            mockUseAdminAuthFn.mockReturnValue({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = emailInput.closest('form');
            await (0, _react1.act)(async ()=>{
                _react1.fireEvent.change(emailInput, {
                    target: {
                        value: 'admin@example.com'
                    }
                });
                _react1.fireEvent.change(passwordInput, {
                    target: {
                        value: 'wrongpassword'
                    }
                });
                if (form) {
                    _react1.fireEvent.submit(form);
                }
            });
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('Invalid credentials')).toBeInTheDocument();
            }, {
                timeout: 5000
            });
        });
    });
    describe('Responsive Design', ()=>{
        it('should render correctly on mobile viewport', ()=>{
            // Mock mobile viewport
            Object.defineProperty(window, 'innerWidth', {
                writable: true,
                configurable: true,
                value: 375
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            // Check that the page renders without errors
            expect(_react1.screen.getByText('Admin Login')).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
        });
        it('should render correctly on desktop viewport', ()=>{
            // Mock desktop viewport
            Object.defineProperty(window, 'innerWidth', {
                writable: true,
                configurable: true,
                value: 1024
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            // Check that the page renders without errors
            expect(_react1.screen.getByText('Admin Login')).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
        });
    });
    describe('Security Features', ()=>{
        it('should not log sensitive information', ()=>{
            const consoleSpy = jest.spyOn(console, 'log').mockImplementation();
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'secretpassword123'
                }
            });
            // Check that password is not logged
            expect(consoleSpy).not.toHaveBeenCalledWith(expect.stringContaining('secretpassword123'));
            consoleSpy.mockRestore();
        });
        it('should prevent XSS attacks in form inputs', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const maliciousInput = '<script>alert("xss")</script>';
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: maliciousInput
                }
            });
            // The input should be sanitized and not execute the script
            expect(emailInput).toHaveValue(maliciousInput);
            expect(_react1.screen.queryByText('xss')).not.toBeInTheDocument();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hLmZvdWFkL1NpZGVQcm9qZWN0cy9FbHphdG9uYS1hbGwvRWx6YXRvbmEtd2ViL3Rlc3RzL2FkbWluL2FkbWluLWxvZ2luLXVpLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQWRtaW4gTG9naW4gVUkgVGVzdHNcbiAqXG4gKiBUZXN0cyBmb3IgdGhlIGFkbWluIGxvZ2luIHBhZ2UgY29tcG9uZW50IHRvIGVuc3VyZTpcbiAqIC0gRm9ybSByZW5kZXJpbmcgYW5kIHZhbGlkYXRpb25cbiAqIC0gVXNlciBpbnRlcmFjdGlvbnNcbiAqIC0gRXJyb3IgaGFuZGxpbmdcbiAqIC0gTG9hZGluZyBzdGF0ZXNcbiAqIC0gUmVzcG9uc2l2ZSBkZXNpZ25cbiAqL1xuXG4vLyBTZXQgdXAgZW52aXJvbm1lbnQgdmFyaWFibGVzIGJlZm9yZSBhbnkgaW1wb3J0c1xucHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMID0gJ2h0dHBzOi8vdGVzdC5zdXBhYmFzZS5jbyc7XG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSA9ICd0ZXN0LWFub24ta2V5JztcbnByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgPSAndGVzdC1zZXJ2aWNlLXJvbGUta2V5JztcblxuLy8gTW9jayBTdXBhYmFzZSBiZWZvcmUgYW55IGltcG9ydHMgdGhhdCB1c2UgaXRcbmplc3QubW9jaygnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJywgKCkgPT4gKHtcbiAgY3JlYXRlQ2xpZW50OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgZnJvbTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgIGVxOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoeyBkYXRhOiBudWxsLCBlcnJvcjogbnVsbCB9KSxcbiAgICAgICAgfSkpLFxuICAgICAgfSkpLFxuICAgIH0pKSxcbiAgICBhdXRoOiB7XG4gICAgICBvbkF1dGhTdGF0ZUNoYW5nZTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICBkYXRhOiB7IHN1YnNjcmlwdGlvbjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pKSxcbiAgICAgIGdldFNlc3Npb246IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGRhdGE6IHsgc2Vzc2lvbjogbnVsbCB9LCBlcnJvcjogbnVsbCB9KSxcbiAgICAgIGdldFVzZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGRhdGE6IHsgdXNlcjogbnVsbCB9LCBlcnJvcjogbnVsbCB9KSxcbiAgICB9LFxuICB9KSksXG59KSk7XG5cbi8vIE1vY2sgbnVxcyBiZWZvcmUgYW55IGltcG9ydHNcbmplc3QubW9jaygnbnVxcycsICgpID0+ICh7XG4gIHVzZVF1ZXJ5U3RhdGU6IGplc3QuZm4oKCkgPT4gW251bGwsIGplc3QuZm4oKV0pLFxuICB1c2VRdWVyeVN0YXRlczogamVzdC5mbigoKSA9PiBbe30sIGplc3QuZm4oKV0pLFxuICBwYXJzZUFzU3RyaW5nOiBqZXN0LmZuKCksXG4gIHBhcnNlQXNJbnRlZ2VyOiBqZXN0LmZuKCksXG4gIGNyZWF0ZVNlYXJjaFBhcmFtc0NhY2hlOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5XG5qZXN0Lm1vY2soJ0B0YW5zdGFjay9yZWFjdC1xdWVyeScsICgpID0+IHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHNcbiAgY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuICByZXR1cm4ge1xuICAgIFF1ZXJ5Q2xpZW50UHJvdmlkZXI6ICh7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZSB9KSA9PiAoXG4gICAgICA8PntjaGlsZHJlbn08Lz5cbiAgICApLFxuICAgIFF1ZXJ5Q2xpZW50OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICBpbnZhbGlkYXRlUXVlcmllczogamVzdC5mbigpLFxuICAgICAgc2V0UXVlcnlEYXRhOiBqZXN0LmZuKCksXG4gICAgICBnZXRRdWVyeURhdGE6IGplc3QuZm4oKSxcbiAgICB9KSksXG4gICAgdXNlUXVlcnlDbGllbnQ6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgIGludmFsaWRhdGVRdWVyaWVzOiBqZXN0LmZuKCksXG4gICAgICBzZXRRdWVyeURhdGE6IGplc3QuZm4oKSxcbiAgICAgIGdldFF1ZXJ5RGF0YTogamVzdC5mbigpLFxuICAgIH0pKSxcbiAgICB1c2VRdWVyeTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICB9KSksXG4gICAgdXNlTXV0YXRpb246IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgIG11dGF0ZTogamVzdC5mbigpLFxuICAgICAgbXV0YXRlQXN5bmM6IGplc3QuZm4oKSxcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICB9KSksXG4gIH07XG59KTtcblxuLy8gTW9jayBOZXh0LmpzIHJvdXRlclxuamVzdC5tb2NrKCduZXh0L25hdmlnYXRpb24nLCAoKSA9PiAoe1xuICB1c2VSb3V0ZXI6IGplc3QuZm4oKSxcbiAgdXNlUGF0aG5hbWU6IGplc3QuZm4oKCkgPT4gJy9hZG1pbi9sb2dpbicpLFxufSkpO1xuXG4vLyBNb2NrIHRoZSBhY3R1YWwgQWRtaW5BdXRoQ29udGV4dCBmaWxlXG5qZXN0Lm1vY2soJy4uLy4uL2xpYnMvc2hhcmVkLWNvbnRleHRzL3NyYy9saWIvQWRtaW5BdXRoQ29udGV4dCcsICgpID0+IHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHNcbiAgY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuICBjb25zdCBtb2NrRm4gPSBqZXN0LmZuKCgpID0+ICh7XG4gICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgIGxvZ2luOiBqZXN0LmZuKCksXG4gICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgdXNlcjogbnVsbCxcbiAgfSkpO1xuICByZXR1cm4ge1xuICAgIEFkbWluQXV0aFByb3ZpZGVyOiAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4gKFxuICAgICAgPD57Y2hpbGRyZW59PC8+XG4gICAgKSxcbiAgICB1c2VBZG1pbkF1dGg6IG1vY2tGbixcbiAgfTtcbn0pO1xuXG4vLyBNb2NrIHRoZSBhY3R1YWwgVGhlbWVDb250ZXh0IGZpbGVcbmplc3QubW9jaygnLi4vLi4vbGlicy9zaGFyZWQtY29udGV4dHMvc3JjL2xpYi9UaGVtZUNvbnRleHQnLCAoKSA9PiAoe1xuICBUaGVtZVByb3ZpZGVyOiAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4gY2hpbGRyZW4sXG4gIHVzZVRoZW1lOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgaXNEYXJrTW9kZTogZmFsc2UsXG4gICAgdG9nZ2xlRGFya01vZGU6IGplc3QuZm4oKSxcbiAgICBzZXREYXJrTW9kZTogamVzdC5mbigpLFxuICAgIGlzTG9hZGVkOiB0cnVlLFxuICB9KSksXG59KSk7XG5cbi8vIEFsc28gbW9jayB0aGUgcGFja2FnZSBlbnRyeSBwb2ludFxuLy8gQ3JlYXRlIGEgbW9jayBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjb25maWd1cmVkIHBlciB0ZXN0XG5jb25zdCBtb2NrVXNlQWRtaW5BdXRoRm4gPSBqZXN0LmZuKCk7XG5cbmplc3QubW9jaygnQGVsemF0b25hL3NoYXJlZC1jb250ZXh0cycsICgpID0+IHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHNcbiAgY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuICByZXR1cm4ge1xuICAgIEFkbWluQXV0aFByb3ZpZGVyOiAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4gKFxuICAgICAgPD57Y2hpbGRyZW59PC8+XG4gICAgKSxcbiAgICB1c2VBZG1pbkF1dGg6IG1vY2tVc2VBZG1pbkF1dGhGbixcbiAgICBUaGVtZVByb3ZpZGVyOiAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4gKFxuICAgICAgPD57Y2hpbGRyZW59PC8+XG4gICAgKSxcbiAgICB1c2VUaGVtZTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgaXNEYXJrTW9kZTogZmFsc2UsXG4gICAgICB0b2dnbGVEYXJrTW9kZTogamVzdC5mbigpLFxuICAgIH0pKSxcbiAgfTtcbn0pO1xuXG4vLyBNb2NrIGZldGNoIGZvciBBUEkgY2FsbHNcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKTtcblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IsIGFjdCB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHVzZXJFdmVudCBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3VzZXItZXZlbnQnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJztcbmltcG9ydCBBZG1pbkxvZ2luUGFnZSBmcm9tICdAL2FwcC9hZG1pbi9sb2dpbi9wYWdlJztcbmltcG9ydCB7IEFkbWluQXV0aFByb3ZpZGVyIH0gZnJvbSAnQGVsemF0b25hL3NoYXJlZC1jb250ZXh0cyc7XG5cbi8vIFR5cGUgZGVmaW5pdGlvbnMgZm9yIG1vY2tzXG5pbnRlcmZhY2UgTW9ja1JvdXRlciB7XG4gIHB1c2g6IGplc3QuTW9ja2VkRnVuY3Rpb248KHVybDogc3RyaW5nKSA9PiB2b2lkPjtcbiAgcmVwbGFjZTogamVzdC5Nb2NrZWRGdW5jdGlvbjwodXJsOiBzdHJpbmcpID0+IHZvaWQ+O1xuICBwcmVmZXRjaDogamVzdC5Nb2NrZWRGdW5jdGlvbjwodXJsOiBzdHJpbmcpID0+IHZvaWQ+O1xuICBiYWNrOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPCgpID0+IHZvaWQ+O1xuICBmb3J3YXJkOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPCgpID0+IHZvaWQ+O1xuICByZWZyZXNoOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPCgpID0+IHZvaWQ+O1xufVxuXG4vLyBNb2NrQWRtaW5BdXRoIGludGVyZmFjZSByZW1vdmVkIC0gbm90IHVzZWQgaW4gdGVzdHNcblxuZGVzY3JpYmUoJ0FkbWluIExvZ2luIFBhZ2UnLCAoKSA9PiB7XG4gIGNvbnN0IG1vY2tQdXNoID0gamVzdC5mbigpO1xuICBjb25zdCBtb2NrVXNlUm91dGVyID0gdXNlUm91dGVyIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIHVzZVJvdXRlcj47XG4gIGNvbnN0IG1vY2tMb2dpbiA9IGplc3QuZm4oKTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAvLyBSZXNldCBtb2NrIGFkbWluIGF1dGggZnVuY3Rpb24gdG8gcmV0dXJuIGRlZmF1bHQgdmFsdWVzXG4gICAgLy8gVXNlIG1vY2tSZXR1cm5WYWx1ZSB0byBlbnN1cmUgY29uc2lzdGVudCBvYmplY3QgcmVmZXJlbmNlXG4gICAgbW9ja1VzZUFkbWluQXV0aEZuLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgIGxvZ2luOiBtb2NrTG9naW4sXG4gICAgICBsb2dvdXQ6IGplc3QuZm4oKSxcbiAgICAgIHVzZXI6IG51bGwsXG4gICAgfSk7XG4gICAgbW9ja1VzZVJvdXRlci5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgcHVzaDogbW9ja1B1c2gsXG4gICAgICByZXBsYWNlOiBqZXN0LmZuKCksXG4gICAgICBwcmVmZXRjaDogamVzdC5mbigpLFxuICAgICAgYmFjazogamVzdC5mbigpLFxuICAgICAgZm9yd2FyZDogamVzdC5mbigpLFxuICAgICAgcmVmcmVzaDogamVzdC5mbigpLFxuICAgIH0gYXMgTW9ja1JvdXRlcik7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BhZ2UgUmVuZGVyaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVuZGVyIGxvZ2luIGZvcm0gd2l0aCBhbGwgcmVxdWlyZWQgZWxlbWVudHMnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkF1dGhQcm92aWRlcj5cbiAgICAgICAgICA8QWRtaW5Mb2dpblBhZ2UgLz5cbiAgICAgICAgPC9BZG1pbkF1dGhQcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdBZG1pbiBMb2dpbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9wYXNzd29yZC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc2lnbiBpbi9pIH0pXG4gICAgICApLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlbmRlciBhZG1pbiBuYXZiYXInLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FkbWluIEFjY2VzcyBQb3J0YWwnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWN1cmUgQXV0aGVudGljYXRpb24gUmVxdWlyZWQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBsb2FkaW5nIHN0YXRlIHdoZW4gYXV0aGVudGljYXRpb24gaXMgaW4gcHJvZ3Jlc3MnLCAoKSA9PiB7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiB0cnVlLFxuICAgICAgICBsb2dpbjogbW9ja0xvZ2luLFxuICAgICAgICBsb2dvdXQ6IGplc3QuZm4oKSxcbiAgICAgICAgdXNlcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0xvYWRpbmcuLi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVuZGVyIGxvZ2luIGZvcm0gd2hlbiBub3QgYXV0aGVudGljYXRlZCcsICgpID0+IHtcbiAgICAgIG1vY2tVc2VBZG1pbkF1dGhGbi5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgICBsb2dpbjogbW9ja0xvZ2luLFxuICAgICAgICBsb2dvdXQ6IGplc3QuZm4oKSxcbiAgICAgICAgdXNlcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgLy8gQ29tcG9uZW50IHNob3VsZCByZW5kZXIgdGhlIGxvZ2luIGZvcm0gd2hlbiBub3QgYXV0aGVudGljYXRlZFxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9wYXNzd29yZC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Zvcm0gVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVzZSBIVE1MNSB2YWxpZGF0aW9uIGZvciBlbXB0eSBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAgIC8vIEhUTUw1IHZhbGlkYXRpb24gLSBjaGVjayByZXF1aXJlZCBhdHRyaWJ1dGVcbiAgICAgIGV4cGVjdChlbWFpbElucHV0KS50b0hhdmVBdHRyaWJ1dGUoJ3JlcXVpcmVkJyk7XG4gICAgICBleHBlY3QocGFzc3dvcmRJbnB1dCkudG9IYXZlQXR0cmlidXRlKCdyZXF1aXJlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgSFRNTDUgZW1haWwgdmFsaWRhdGlvbicsICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXG4gICAgICAvLyBIVE1MNSBlbWFpbCB2YWxpZGF0aW9uXG4gICAgICBleHBlY3QoZW1haWxJbnB1dCkudG9IYXZlQXR0cmlidXRlKCd0eXBlJywgJ2VtYWlsJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGZvcm0gaW5wdXQgY2hhbmdlcycsICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAndGVzdEBleGFtcGxlLmNvbScgfSB9KTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UocGFzc3dvcmRJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdwYXNzd29yZDEyMycgfSB9KTtcblxuICAgICAgZXhwZWN0KGVtYWlsSW5wdXQpLnRvSGF2ZVZhbHVlKCd0ZXN0QGV4YW1wbGUuY29tJyk7XG4gICAgICBleHBlY3QocGFzc3dvcmRJbnB1dCkudG9IYXZlVmFsdWUoJ3Bhc3N3b3JkMTIzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGb3JtIFN1Ym1pc3Npb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjYWxsIGxvZ2luIGZ1bmN0aW9uIHdpdGggY29ycmVjdCBjcmVkZW50aWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgbG9naW46IGxvZ2luTW9jayxcbiAgICAgICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgICAgIHVzZXI6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgeyBjb250YWluZXIgfSA9IHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuICAgICAgY29uc3QgZm9ybSA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdmb3JtJyk7XG5cbiAgICAgIC8vIFZlcmlmeSB0aGUgbW9jayBpcyBzZXQgdXAgY29ycmVjdGx5XG4gICAgICBleHBlY3QobW9ja1VzZUFkbWluQXV0aEZuKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBjb25zdCBtb2NrUmVzdWx0ID0gbW9ja1VzZUFkbWluQXV0aEZuLm1vY2sucmVzdWx0c1swXT8udmFsdWU7XG4gICAgICBleHBlY3QobW9ja1Jlc3VsdD8ubG9naW4pLnRvQmUobG9naW5Nb2NrKTtcblxuICAgICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShlbWFpbElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ2FkbWluQGV4YW1wbGUuY29tJyB9IH0pO1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGFzc3dvcmQxMjMnIH0gfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZm9ybSkge1xuICAgICAgICAgIGZpcmVFdmVudC5zdWJtaXQoZm9ybSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGxvZ2luTW9jaykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgJ2FkbWluQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAncGFzc3dvcmQxMjMnXG4gICAgICAgICk7XG4gICAgICB9LCB7IHRpbWVvdXQ6IDUwMDAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNob3cgbG9hZGluZyBzdGF0ZSBkdXJpbmcgbG9naW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsb2dpbk1vY2sgPSBqZXN0XG4gICAgICAgIC5mbigpXG4gICAgICAgIC5tb2NrSW1wbGVtZW50YXRpb24oXG4gICAgICAgICAgKCkgPT4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpXG4gICAgICAgICk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgbG9naW46IGxvZ2luTW9jayxcbiAgICAgICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgICAgIHVzZXI6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG4gICAgICBjb25zdCBsb2dpbkJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3NpZ24gaW4vaSB9KTtcbiAgICAgIGNvbnN0IGZvcm0gPSBlbWFpbElucHV0LmNsb3Nlc3QoJ2Zvcm0nKTtcblxuICAgICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShlbWFpbElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ2FkbWluQGV4YW1wbGUuY29tJyB9IH0pO1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGFzc3dvcmQxMjMnIH0gfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZm9ybSkge1xuICAgICAgICAgIGZpcmVFdmVudC5zdWJtaXQoZm9ybSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayBsb2FkaW5nIHN0YXRlIGltbWVkaWF0ZWx5IGFmdGVyIHN1Ym1pc3Npb25cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2lnbmluZyBJbi4uLicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBleHBlY3QobG9naW5CdXR0b24pLnRvQmVEaXNhYmxlZCgpO1xuICAgICAgfSwgeyB0aW1lb3V0OiA1MDAwIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IGVycm9yIG1lc3NhZ2Ugb24gbG9naW4gZmFpbHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3RcbiAgICAgICAgLmZuKClcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBjcmVkZW50aWFscycgfSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgbG9naW46IGxvZ2luTW9jayxcbiAgICAgICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgICAgIHVzZXI6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG4gICAgICBjb25zdCBmb3JtID0gZW1haWxJbnB1dC5jbG9zZXN0KCdmb3JtJyk7XG5cbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZW1haWxJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdhZG1pbkBleGFtcGxlLmNvbScgfSB9KTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UocGFzc3dvcmRJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICd3cm9uZ3Bhc3N3b3JkJyB9IH0pO1xuICAgICAgXG4gICAgICBpZiAoZm9ybSkge1xuICAgICAgICBmaXJlRXZlbnQuc3VibWl0KGZvcm0pO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0ludmFsaWQgY3JlZGVudGlhbHMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0sIHsgdGltZW91dDogNTAwMCB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG5ldHdvcmsgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBsb2dpbk1vY2sgPSBqZXN0LmZuKCkubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpO1xuICAgICAgbW9ja1VzZUFkbWluQXV0aEZuLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgIGxvZ2luOiBsb2dpbk1vY2ssXG4gICAgICAgIGxvZ291dDogamVzdC5mbigpLFxuICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuICAgICAgY29uc3QgZm9ybSA9IGVtYWlsSW5wdXQuY2xvc2VzdCgnZm9ybScpO1xuXG4gICAgICBhd2FpdCBhY3QoYXN5bmMgKCkgPT4ge1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSk7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2UocGFzc3dvcmRJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdwYXNzd29yZDEyMycgfSB9KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgICAgZmlyZUV2ZW50LnN1Ym1pdChmb3JtKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QoXG4gICAgICAgICAgc2NyZWVuLmdldEJ5VGV4dCgnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCcpXG4gICAgICAgICkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0sIHsgdGltZW91dDogNTAwMCB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1VzZXIgSW50ZXJhY3Rpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSBwYXNzd29yZCBmaWVsZCB3aXRoIHBhc3N3b3JkIHR5cGUnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG5cbiAgICAgIGV4cGVjdChwYXNzd29yZElucHV0KS50b0hhdmVBdHRyaWJ1dGUoJ3R5cGUnLCAncGFzc3dvcmQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3VibWl0IGZvcm0gb24gRW50ZXIga2V5IHByZXNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbG9naW5Nb2NrID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICAgIG1vY2tVc2VBZG1pbkF1dGhGbi5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgICBsb2dpbjogbG9naW5Nb2NrLFxuICAgICAgICBsb2dvdXQ6IGplc3QuZm4oKSxcbiAgICAgICAgdXNlcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSk7XG4gICAgICBjb25zdCBwYXNzd29yZElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9wYXNzd29yZC9pKTtcblxuICAgICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShlbWFpbElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ2FkbWluQGV4YW1wbGUuY29tJyB9IH0pO1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGFzc3dvcmQxMjMnIH0gfSk7XG4gICAgICAgIGZpcmVFdmVudC5rZXlEb3duKHBhc3N3b3JkSW5wdXQsIHsga2V5OiAnRW50ZXInLCBjb2RlOiAnRW50ZXInLCBjaGFyQ29kZTogMTMgfSk7XG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChsb2dpbk1vY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdhZG1pbkBleGFtcGxlLmNvbScsXG4gICAgICAgICAgJ3Bhc3N3b3JkMTIzJ1xuICAgICAgICApO1xuICAgICAgfSwgeyB0aW1lb3V0OiA1MDAwIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBmb3JtIGZpZWxkIGlucHV0JywgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG5cbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZW1haWxJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdhZG1pbkBleGFtcGxlLmNvbScgfSB9KTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UocGFzc3dvcmRJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdwYXNzd29yZDEyMycgfSB9KTtcblxuICAgICAgZXhwZWN0KGVtYWlsSW5wdXQpLnRvSGF2ZVZhbHVlKCdhZG1pbkBleGFtcGxlLmNvbScpO1xuICAgICAgZXhwZWN0KHBhc3N3b3JkSW5wdXQpLnRvSGF2ZVZhbHVlKCdwYXNzd29yZDEyMycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWNjZXNzaWJpbGl0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIEFSSUEgbGFiZWxzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3NpZ24gaW4vaSB9KVxuICAgICAgKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBiZSBrZXlib2FyZCBuYXZpZ2FibGUnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSk7XG4gICAgICBjb25zdCBwYXNzd29yZElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9wYXNzd29yZC9pKTtcbiAgICAgIGNvbnN0IGxvZ2luQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc2lnbiBpbi9pIH0pO1xuXG4gICAgICAvLyBDaGVjayB0aGF0IGlucHV0cyBhcmUgZm9jdXNhYmxlXG4gICAgICBlbWFpbElucHV0LmZvY3VzKCk7XG4gICAgICBleHBlY3QoZW1haWxJbnB1dCkudG9IYXZlRm9jdXMoKTtcblxuICAgICAgLy8gQ2hlY2sgdGhhdCBwYXNzd29yZCBpbnB1dCBpcyBmb2N1c2FibGVcbiAgICAgIHBhc3N3b3JkSW5wdXQuZm9jdXMoKTtcbiAgICAgIGV4cGVjdChwYXNzd29yZElucHV0KS50b0hhdmVGb2N1cygpO1xuXG4gICAgICAvLyBDaGVjayB0aGF0IGJ1dHRvbiBpcyBmb2N1c2FibGVcbiAgICAgIGxvZ2luQnV0dG9uLmZvY3VzKCk7XG4gICAgICBleHBlY3QobG9naW5CdXR0b24pLnRvSGF2ZUZvY3VzKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgZXJyb3IgbWVzc2FnZXMgd2hlbiBsb2dpbiBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3RcbiAgICAgICAgLmZuKClcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBjcmVkZW50aWFscycgfSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgbG9naW46IGxvZ2luTW9jayxcbiAgICAgICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgICAgIHVzZXI6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG4gICAgICBjb25zdCBmb3JtID0gZW1haWxJbnB1dC5jbG9zZXN0KCdmb3JtJyk7XG5cbiAgICAgIGF3YWl0IGFjdChhc3luYyAoKSA9PiB7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZW1haWxJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdhZG1pbkBleGFtcGxlLmNvbScgfSB9KTtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShwYXNzd29yZElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ3dyb25ncGFzc3dvcmQnIH0gfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZm9ybSkge1xuICAgICAgICAgIGZpcmVFdmVudC5zdWJtaXQoZm9ybSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0ludmFsaWQgY3JlZGVudGlhbHMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0sIHsgdGltZW91dDogNTAwMCB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jlc3BvbnNpdmUgRGVzaWduJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVuZGVyIGNvcnJlY3RseSBvbiBtb2JpbGUgdmlld3BvcnQnLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIG1vYmlsZSB2aWV3cG9ydFxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ2lubmVyV2lkdGgnLCB7XG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiAzNzUsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIC8vIENoZWNrIHRoYXQgdGhlIHBhZ2UgcmVuZGVycyB3aXRob3V0IGVycm9yc1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FkbWluIExvZ2luJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVuZGVyIGNvcnJlY3RseSBvbiBkZXNrdG9wIHZpZXdwb3J0JywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBkZXNrdG9wIHZpZXdwb3J0XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnaW5uZXJXaWR0aCcsIHtcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IDEwMjQsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIC8vIENoZWNrIHRoYXQgdGhlIHBhZ2UgcmVuZGVycyB3aXRob3V0IGVycm9yc1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FkbWluIExvZ2luJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NlY3VyaXR5IEZlYXR1cmVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbm90IGxvZyBzZW5zaXRpdmUgaW5mb3JtYXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25zb2xlU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnbG9nJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHtcbiAgICAgICAgdGFyZ2V0OiB7IHZhbHVlOiAnc2VjcmV0cGFzc3dvcmQxMjMnIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gQ2hlY2sgdGhhdCBwYXNzd29yZCBpcyBub3QgbG9nZ2VkXG4gICAgICBleHBlY3QoY29uc29sZVNweSkubm90LnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnc2VjcmV0cGFzc3dvcmQxMjMnKVxuICAgICAgKTtcblxuICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IFhTUyBhdHRhY2tzIGluIGZvcm0gaW5wdXRzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgbWFsaWNpb3VzSW5wdXQgPSAnPHNjcmlwdD5hbGVydChcInhzc1wiKTwvc2NyaXB0Pic7XG5cbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZW1haWxJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6IG1hbGljaW91c0lucHV0IH0gfSk7XG5cbiAgICAgIC8vIFRoZSBpbnB1dCBzaG91bGQgYmUgc2FuaXRpemVkIGFuZCBub3QgZXhlY3V0ZSB0aGUgc2NyaXB0XG4gICAgICBleHBlY3QoZW1haWxJbnB1dCkudG9IYXZlVmFsdWUobWFsaWNpb3VzSW5wdXQpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgneHNzJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwiY3JlYXRlQ2xpZW50IiwiZm4iLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImRhdGEiLCJlcnJvciIsImF1dGgiLCJvbkF1dGhTdGF0ZUNoYW5nZSIsInN1YnNjcmlwdGlvbiIsImdldFNlc3Npb24iLCJzZXNzaW9uIiwiZ2V0VXNlciIsInVzZXIiLCJ1c2VRdWVyeVN0YXRlIiwidXNlUXVlcnlTdGF0ZXMiLCJwYXJzZUFzU3RyaW5nIiwicGFyc2VBc0ludGVnZXIiLCJjcmVhdGVTZWFyY2hQYXJhbXNDYWNoZSIsIlJlYWN0IiwicmVxdWlyZSIsIlF1ZXJ5Q2xpZW50UHJvdmlkZXIiLCJjaGlsZHJlbiIsIlF1ZXJ5Q2xpZW50IiwiaW52YWxpZGF0ZVF1ZXJpZXMiLCJzZXRRdWVyeURhdGEiLCJnZXRRdWVyeURhdGEiLCJ1c2VRdWVyeUNsaWVudCIsInVzZVF1ZXJ5IiwiaXNMb2FkaW5nIiwidXNlTXV0YXRpb24iLCJtdXRhdGUiLCJtdXRhdGVBc3luYyIsInVzZVJvdXRlciIsInVzZVBhdGhuYW1lIiwibW9ja0ZuIiwiaXNBdXRoZW50aWNhdGVkIiwibG9naW4iLCJsb2dvdXQiLCJBZG1pbkF1dGhQcm92aWRlciIsInVzZUFkbWluQXV0aCIsIlRoZW1lUHJvdmlkZXIiLCJ1c2VUaGVtZSIsImlzRGFya01vZGUiLCJ0b2dnbGVEYXJrTW9kZSIsInNldERhcmtNb2RlIiwiaXNMb2FkZWQiLCJtb2NrVXNlQWRtaW5BdXRoRm4iLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiZ2xvYmFsIiwiZmV0Y2giLCJkZXNjcmliZSIsIm1vY2tQdXNoIiwibW9ja1VzZVJvdXRlciIsIm1vY2tMb2dpbiIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja1JldHVyblZhbHVlIiwicHVzaCIsInJlcGxhY2UiLCJwcmVmZXRjaCIsImJhY2siLCJmb3J3YXJkIiwicmVmcmVzaCIsImFmdGVyRWFjaCIsInJlc3RvcmVBbGxNb2NrcyIsIml0IiwicmVuZGVyIiwiQWRtaW5Mb2dpblBhZ2UiLCJleHBlY3QiLCJzY3JlZW4iLCJnZXRCeVRleHQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsImdldEJ5TGFiZWxUZXh0IiwiZ2V0QnlSb2xlIiwibmFtZSIsImVtYWlsSW5wdXQiLCJwYXNzd29yZElucHV0IiwidG9IYXZlQXR0cmlidXRlIiwiZmlyZUV2ZW50IiwiY2hhbmdlIiwidGFyZ2V0IiwidmFsdWUiLCJ0b0hhdmVWYWx1ZSIsImxvZ2luTW9jayIsInN1Y2Nlc3MiLCJjb250YWluZXIiLCJmb3JtIiwicXVlcnlTZWxlY3RvciIsInRvSGF2ZUJlZW5DYWxsZWQiLCJtb2NrUmVzdWx0IiwicmVzdWx0cyIsInRvQmUiLCJhY3QiLCJzdWJtaXQiLCJ3YWl0Rm9yIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJ0aW1lb3V0IiwibW9ja0ltcGxlbWVudGF0aW9uIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwibG9naW5CdXR0b24iLCJjbG9zZXN0IiwidG9CZURpc2FibGVkIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciIsImtleURvd24iLCJrZXkiLCJjb2RlIiwiY2hhckNvZGUiLCJmb2N1cyIsInRvSGF2ZUZvY3VzIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ3aW5kb3ciLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsImNvbnNvbGVTcHkiLCJzcHlPbiIsImNvbnNvbGUiLCJub3QiLCJzdHJpbmdDb250YWluaW5nIiwibW9ja1Jlc3RvcmUiLCJtYWxpY2lvdXNJbnB1dCIsInF1ZXJ5QnlUZXh0Il0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7O0NBU0MsR0FFRCxrREFBa0Q7O0FBS2xELCtDQUErQztBQUMvQ0EsS0FBS0MsSUFBSSxDQUFDLHlCQUF5QixJQUFPLENBQUE7UUFDeENDLGNBQWNGLEtBQUtHLEVBQUUsQ0FBQyxJQUFPLENBQUE7Z0JBQzNCQyxNQUFNSixLQUFLRyxFQUFFLENBQUMsSUFBTyxDQUFBO3dCQUNuQkUsUUFBUUwsS0FBS0csRUFBRSxDQUFDLElBQU8sQ0FBQTtnQ0FDckJHLElBQUlOLEtBQUtHLEVBQUUsQ0FBQyxJQUFPLENBQUE7d0NBQ2pCSSxRQUFRUCxLQUFLRyxFQUFFLEdBQUdLLGlCQUFpQixDQUFDOzRDQUFFQyxNQUFNOzRDQUFNQyxPQUFPO3dDQUFLO29DQUNoRSxDQUFBOzRCQUNGLENBQUE7b0JBQ0YsQ0FBQTtnQkFDQUMsTUFBTTtvQkFDSkMsbUJBQW1CWixLQUFLRyxFQUFFLENBQUMsSUFBTyxDQUFBOzRCQUNoQ00sTUFBTTtnQ0FBRUksY0FBYzs0QkFBSzs0QkFDM0JILE9BQU87d0JBQ1QsQ0FBQTtvQkFDQUksWUFBWWQsS0FBS0csRUFBRSxHQUFHSyxpQkFBaUIsQ0FBQzt3QkFBRUMsTUFBTTs0QkFBRU0sU0FBUzt3QkFBSzt3QkFBR0wsT0FBTztvQkFBSztvQkFDL0VNLFNBQVNoQixLQUFLRyxFQUFFLEdBQUdLLGlC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