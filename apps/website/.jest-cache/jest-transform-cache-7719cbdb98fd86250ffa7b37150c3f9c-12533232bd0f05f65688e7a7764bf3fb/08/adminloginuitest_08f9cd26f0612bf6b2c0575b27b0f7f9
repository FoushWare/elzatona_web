09e99c2e80adf6379a522550d2aa1b00
/**
 * Admin Login UI Tests
 *
 * Tests for the admin login page component to ensure:
 * - Form rendering and validation
 * - User interactions
 * - Error handling
 * - Loading states
 * - Responsive design
 */ // Set up environment variables before any imports
"use strict";
// Mock Supabase before any imports that use it
jest.mock('@supabase/supabase-js', ()=>({
        createClient: jest.fn(()=>({
                from: jest.fn(()=>({
                        select: jest.fn(()=>({
                                eq: jest.fn(()=>({
                                        single: jest.fn().mockResolvedValue({
                                            data: null,
                                            error: null
                                        })
                                    }))
                            }))
                    })),
                auth: {
                    onAuthStateChange: jest.fn(()=>({
                            data: {
                                subscription: null
                            },
                            error: null
                        })),
                    getSession: jest.fn().mockResolvedValue({
                        data: {
                            session: null
                        },
                        error: null
                    }),
                    getUser: jest.fn().mockResolvedValue({
                        data: {
                            user: null
                        },
                        error: null
                    })
                }
            }))
    }));
// Mock nuqs before any imports
jest.mock('nuqs', ()=>({
        useQueryState: jest.fn(()=>[
                null,
                jest.fn()
            ]),
        useQueryStates: jest.fn(()=>[
                {},
                jest.fn()
            ]),
        parseAsString: jest.fn(),
        parseAsInteger: jest.fn(),
        createSearchParamsCache: jest.fn()
    }));
// Mock @tanstack/react-query
jest.mock('@tanstack/react-query', ()=>{
    // eslint-disable-next-line @typescript-eslint/no-require-imports
    const React = require('react');
    return {
        QueryClientProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        QueryClient: jest.fn(()=>({
                invalidateQueries: jest.fn(),
                setQueryData: jest.fn(),
                getQueryData: jest.fn()
            })),
        useQueryClient: jest.fn(()=>({
                invalidateQueries: jest.fn(),
                setQueryData: jest.fn(),
                getQueryData: jest.fn()
            })),
        useQuery: jest.fn(()=>({
                data: null,
                isLoading: false,
                error: null
            })),
        useMutation: jest.fn(()=>({
                mutate: jest.fn(),
                mutateAsync: jest.fn(),
                isLoading: false,
                error: null
            }))
    };
});
// Mock Next.js router
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn(),
        usePathname: jest.fn(()=>'/admin/login')
    }));
// Mock the actual AdminAuthContext file
jest.mock('../../libs/shared-contexts/src/lib/AdminAuthContext', ()=>{
    // eslint-disable-next-line @typescript-eslint/no-require-imports
    const React = require('react');
    const mockFn = jest.fn(()=>({
            isAuthenticated: false,
            isLoading: false,
            login: jest.fn(),
            logout: jest.fn(),
            user: null
        }));
    return {
        AdminAuthProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        useAdminAuth: mockFn
    };
});
// Mock the actual ThemeContext file
jest.mock('../../libs/shared-contexts/src/lib/ThemeContext', ()=>({
        ThemeProvider: ({ children })=>children,
        useTheme: jest.fn(()=>({
                isDarkMode: false,
                toggleDarkMode: jest.fn(),
                setDarkMode: jest.fn(),
                isLoaded: true
            }))
    }));
jest.mock('@elzatona/shared-contexts', ()=>{
    // eslint-disable-next-line @typescript-eslint/no-require-imports
    const React = require('react');
    return {
        AdminAuthProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        useAdminAuth: mockUseAdminAuthFn,
        ThemeProvider: ({ children })=>/*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: children
            }),
        useTheme: jest.fn(()=>({
                isDarkMode: false,
                toggleDarkMode: jest.fn()
            }))
    };
});
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _react1 = require("@testing-library/react");
const _navigation = require("next/navigation");
const _page = /*#__PURE__*/ _interop_require_default(require("../../apps/website/src/app/admin/login/page"));
const _sharedcontexts = require("../../libs/shared-contexts/src");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
process.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co';
process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test-anon-key';
process.env.SUPABASE_SERVICE_ROLE_KEY = 'test-service-role-key';
// Also mock the package entry point
// Create a mock function that can be configured per test
const mockUseAdminAuthFn = jest.fn(()=>({
        isAuthenticated: false,
        isLoading: false,
        login: jest.fn(),
        logout: jest.fn(),
        user: null
    }));
// Mock fetch for API calls
global.fetch = jest.fn();
// MockAdminAuth interface removed - not used in tests
describe('Admin Login Page', ()=>{
    const mockPush = jest.fn();
    const mockUseRouter = _navigation.useRouter;
    const mockLogin = jest.fn();
    beforeEach(()=>{
        jest.clearAllMocks();
        // Reset mock admin auth function to return default values
        mockUseAdminAuthFn.mockReturnValue({
            isAuthenticated: false,
            isLoading: false,
            login: mockLogin,
            logout: jest.fn(),
            user: null
        });
        mockUseRouter.mockReturnValue({
            push: mockPush,
            replace: jest.fn(),
            prefetch: jest.fn(),
            back: jest.fn(),
            forward: jest.fn(),
            refresh: jest.fn()
        });
    });
    afterEach(()=>{
        jest.restoreAllMocks();
    });
    describe('Page Rendering', ()=>{
        it('should render login form with all required elements', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_sharedcontexts.AdminAuthProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            expect(_react1.screen.getByText('Admin Login')).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/password/i)).toBeInTheDocument();
            expect(_react1.screen.getByRole('button', {
                name: /sign in/i
            })).toBeInTheDocument();
        });
        it('should render admin navbar', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            expect(_react1.screen.getByText('Admin Access Portal')).toBeInTheDocument();
            expect(_react1.screen.getByText('Secure Authentication Required')).toBeInTheDocument();
        });
        it('should show loading state when authentication is in progress', ()=>{
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: false,
                isLoading: true,
                login: mockLogin,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            expect(_react1.screen.getByText('Loading...')).toBeInTheDocument();
        });
        it('should redirect authenticated users to dashboard', ()=>{
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: true,
                isLoading: false,
                login: mockLogin,
                logout: jest.fn(),
                user: {
                    id: '1',
                    email: 'admin@example.com',
                    name: 'Admin',
                    role: 'super_admin'
                }
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            // Component doesn't redirect directly - it relies on AdminAuthProvider
            // Just verify the component renders without the login form
            expect(_react1.screen.queryByLabelText(/email/i)).not.toBeInTheDocument();
        });
    });
    describe('Form Validation', ()=>{
        it('should use HTML5 validation for empty fields', async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            // HTML5 validation - check required attribute
            expect(emailInput).toHaveAttribute('required');
            expect(passwordInput).toHaveAttribute('required');
        });
        it('should use HTML5 email validation', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            // HTML5 email validation
            expect(emailInput).toHaveAttribute('type', 'email');
        });
        it('should allow form input changes', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'test@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            expect(emailInput).toHaveValue('test@example.com');
            expect(passwordInput).toHaveValue('password123');
        });
    });
    describe('Form Submission', ()=>{
        it('should call login function with correct credentials', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: true
            });
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = emailInput.closest('form');
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            if (form) {
                _react1.fireEvent.submit(form);
            }
            await (0, _react1.waitFor)(()=>{
                expect(loginMock).toHaveBeenCalledWith('admin@example.com', 'password123');
            });
        });
        it('should show loading state during login', async ()=>{
            const loginMock = jest.fn().mockImplementation(()=>new Promise((resolve)=>setTimeout(resolve, 100)));
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const loginButton = _react1.screen.getByRole('button', {
                name: /sign in/i
            });
            const form = emailInput.closest('form');
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            if (form) {
                _react1.fireEvent.submit(form);
            }
            // Check loading state immediately after submission
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('Signing In...')).toBeInTheDocument();
                expect(loginButton).toBeDisabled();
            });
        });
        it('should show error message on login failure', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: false,
                error: 'Invalid credentials'
            });
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = emailInput.closest('form');
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'wrongpassword'
                }
            });
            if (form) {
                _react1.fireEvent.submit(form);
            }
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('Invalid credentials')).toBeInTheDocument();
            }, {
                timeout: 3000
            });
        });
        it('should handle network errors gracefully', async ()=>{
            const loginMock = jest.fn().mockRejectedValue(new Error('Network error'));
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = emailInput.closest('form');
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            if (form) {
                _react1.fireEvent.submit(form);
            }
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('An unexpected error occurred')).toBeInTheDocument();
            }, {
                timeout: 3000
            });
        });
    });
    describe('User Interactions', ()=>{
        it('should have password field with password type', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            expect(passwordInput).toHaveAttribute('type', 'password');
        });
        it('should submit form on Enter key press', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: true
            });
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            _react1.fireEvent.keyPress(passwordInput, {
                key: 'Enter',
                code: 'Enter',
                charCode: 13
            });
            await (0, _react1.waitFor)(()=>{
                expect(loginMock).toHaveBeenCalledWith('admin@example.com', 'password123');
            }, {
                timeout: 3000
            });
        });
        it('should allow form field input', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'password123'
                }
            });
            expect(emailInput).toHaveValue('admin@example.com');
            expect(passwordInput).toHaveValue('password123');
        });
    });
    describe('Accessibility', ()=>{
        it('should have proper ARIA labels', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/password/i)).toBeInTheDocument();
            expect(_react1.screen.getByRole('button', {
                name: /sign in/i
            })).toBeInTheDocument();
        });
        it('should be keyboard navigable', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const loginButton = _react1.screen.getByRole('button', {
                name: /sign in/i
            });
            // Check that inputs are focusable
            emailInput.focus();
            expect(emailInput).toHaveFocus();
            // Check that password input is focusable
            passwordInput.focus();
            expect(passwordInput).toHaveFocus();
            // Check that button is focusable
            loginButton.focus();
            expect(loginButton).toHaveFocus();
        });
        it('should display error messages when login fails', async ()=>{
            const loginMock = jest.fn().mockResolvedValue({
                success: false,
                error: 'Invalid credentials'
            });
            mockUseAdminAuthFn.mockReturnValueOnce({
                isAuthenticated: false,
                isLoading: false,
                login: loginMock,
                logout: jest.fn(),
                user: null
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            const form = emailInput.closest('form');
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'wrongpassword'
                }
            });
            if (form) {
                _react1.fireEvent.submit(form);
            }
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText('Invalid credentials')).toBeInTheDocument();
            }, {
                timeout: 3000
            });
        });
    });
    describe('Responsive Design', ()=>{
        it('should render correctly on mobile viewport', ()=>{
            // Mock mobile viewport
            Object.defineProperty(window, 'innerWidth', {
                writable: true,
                configurable: true,
                value: 375
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            // Check that the page renders without errors
            expect(_react1.screen.getByText('Admin Login')).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
        });
        it('should render correctly on desktop viewport', ()=>{
            // Mock desktop viewport
            Object.defineProperty(window, 'innerWidth', {
                writable: true,
                configurable: true,
                value: 1024
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            // Check that the page renders without errors
            expect(_react1.screen.getByText('Admin Login')).toBeInTheDocument();
            expect(_react1.screen.getByLabelText(/email/i)).toBeInTheDocument();
        });
    });
    describe('Security Features', ()=>{
        it('should not log sensitive information', ()=>{
            const consoleSpy = jest.spyOn(console, 'log').mockImplementation();
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const passwordInput = _react1.screen.getByLabelText(/password/i);
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: 'admin@example.com'
                }
            });
            _react1.fireEvent.change(passwordInput, {
                target: {
                    value: 'secretpassword123'
                }
            });
            // Check that password is not logged
            expect(consoleSpy).not.toHaveBeenCalledWith(expect.stringContaining('secretpassword123'));
            consoleSpy.mockRestore();
        });
        it('should prevent XSS attacks in form inputs', ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            const emailInput = _react1.screen.getByLabelText(/email/i);
            const maliciousInput = '<script>alert("xss")</script>';
            _react1.fireEvent.change(emailInput, {
                target: {
                    value: maliciousInput
                }
            });
            // The input should be sanitized and not execute the script
            expect(emailInput).toHaveValue(maliciousInput);
            expect(_react1.screen.queryByText('xss')).not.toBeInTheDocument();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9hLmZvdWFkL1NpZGVQcm9qZWN0cy9FbHphdG9uYS1hbGwvRWx6YXRvbmEtd2ViL3Rlc3RzL2FkbWluL2FkbWluLWxvZ2luLXVpLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQWRtaW4gTG9naW4gVUkgVGVzdHNcbiAqXG4gKiBUZXN0cyBmb3IgdGhlIGFkbWluIGxvZ2luIHBhZ2UgY29tcG9uZW50IHRvIGVuc3VyZTpcbiAqIC0gRm9ybSByZW5kZXJpbmcgYW5kIHZhbGlkYXRpb25cbiAqIC0gVXNlciBpbnRlcmFjdGlvbnNcbiAqIC0gRXJyb3IgaGFuZGxpbmdcbiAqIC0gTG9hZGluZyBzdGF0ZXNcbiAqIC0gUmVzcG9uc2l2ZSBkZXNpZ25cbiAqL1xuXG4vLyBTZXQgdXAgZW52aXJvbm1lbnQgdmFyaWFibGVzIGJlZm9yZSBhbnkgaW1wb3J0c1xucHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMID0gJ2h0dHBzOi8vdGVzdC5zdXBhYmFzZS5jbyc7XG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSA9ICd0ZXN0LWFub24ta2V5JztcbnByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgPSAndGVzdC1zZXJ2aWNlLXJvbGUta2V5JztcblxuLy8gTW9jayBTdXBhYmFzZSBiZWZvcmUgYW55IGltcG9ydHMgdGhhdCB1c2UgaXRcbmplc3QubW9jaygnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJywgKCkgPT4gKHtcbiAgY3JlYXRlQ2xpZW50OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgZnJvbTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgIGVxOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoeyBkYXRhOiBudWxsLCBlcnJvcjogbnVsbCB9KSxcbiAgICAgICAgfSkpLFxuICAgICAgfSkpLFxuICAgIH0pKSxcbiAgICBhdXRoOiB7XG4gICAgICBvbkF1dGhTdGF0ZUNoYW5nZTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICBkYXRhOiB7IHN1YnNjcmlwdGlvbjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pKSxcbiAgICAgIGdldFNlc3Npb246IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGRhdGE6IHsgc2Vzc2lvbjogbnVsbCB9LCBlcnJvcjogbnVsbCB9KSxcbiAgICAgIGdldFVzZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IGRhdGE6IHsgdXNlcjogbnVsbCB9LCBlcnJvcjogbnVsbCB9KSxcbiAgICB9LFxuICB9KSksXG59KSk7XG5cbi8vIE1vY2sgbnVxcyBiZWZvcmUgYW55IGltcG9ydHNcbmplc3QubW9jaygnbnVxcycsICgpID0+ICh7XG4gIHVzZVF1ZXJ5U3RhdGU6IGplc3QuZm4oKCkgPT4gW251bGwsIGplc3QuZm4oKV0pLFxuICB1c2VRdWVyeVN0YXRlczogamVzdC5mbigoKSA9PiBbe30sIGplc3QuZm4oKV0pLFxuICBwYXJzZUFzU3RyaW5nOiBqZXN0LmZuKCksXG4gIHBhcnNlQXNJbnRlZ2VyOiBqZXN0LmZuKCksXG4gIGNyZWF0ZVNlYXJjaFBhcmFtc0NhY2hlOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5XG5qZXN0Lm1vY2soJ0B0YW5zdGFjay9yZWFjdC1xdWVyeScsICgpID0+IHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHNcbiAgY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuICByZXR1cm4ge1xuICAgIFF1ZXJ5Q2xpZW50UHJvdmlkZXI6ICh7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZSB9KSA9PiAoXG4gICAgICA8PntjaGlsZHJlbn08Lz5cbiAgICApLFxuICAgIFF1ZXJ5Q2xpZW50OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICBpbnZhbGlkYXRlUXVlcmllczogamVzdC5mbigpLFxuICAgICAgc2V0UXVlcnlEYXRhOiBqZXN0LmZuKCksXG4gICAgICBnZXRRdWVyeURhdGE6IGplc3QuZm4oKSxcbiAgICB9KSksXG4gICAgdXNlUXVlcnlDbGllbnQ6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgIGludmFsaWRhdGVRdWVyaWVzOiBqZXN0LmZuKCksXG4gICAgICBzZXRRdWVyeURhdGE6IGplc3QuZm4oKSxcbiAgICAgIGdldFF1ZXJ5RGF0YTogamVzdC5mbigpLFxuICAgIH0pKSxcbiAgICB1c2VRdWVyeTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICB9KSksXG4gICAgdXNlTXV0YXRpb246IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgIG11dGF0ZTogamVzdC5mbigpLFxuICAgICAgbXV0YXRlQXN5bmM6IGplc3QuZm4oKSxcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICB9KSksXG4gIH07XG59KTtcblxuLy8gTW9jayBOZXh0LmpzIHJvdXRlclxuamVzdC5tb2NrKCduZXh0L25hdmlnYXRpb24nLCAoKSA9PiAoe1xuICB1c2VSb3V0ZXI6IGplc3QuZm4oKSxcbiAgdXNlUGF0aG5hbWU6IGplc3QuZm4oKCkgPT4gJy9hZG1pbi9sb2dpbicpLFxufSkpO1xuXG4vLyBNb2NrIHRoZSBhY3R1YWwgQWRtaW5BdXRoQ29udGV4dCBmaWxlXG5qZXN0Lm1vY2soJy4uLy4uL2xpYnMvc2hhcmVkLWNvbnRleHRzL3NyYy9saWIvQWRtaW5BdXRoQ29udGV4dCcsICgpID0+IHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHNcbiAgY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuICBjb25zdCBtb2NrRm4gPSBqZXN0LmZuKCgpID0+ICh7XG4gICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgIGxvZ2luOiBqZXN0LmZuKCksXG4gICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgdXNlcjogbnVsbCxcbiAgfSkpO1xuICByZXR1cm4ge1xuICAgIEFkbWluQXV0aFByb3ZpZGVyOiAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4gKFxuICAgICAgPD57Y2hpbGRyZW59PC8+XG4gICAgKSxcbiAgICB1c2VBZG1pbkF1dGg6IG1vY2tGbixcbiAgfTtcbn0pO1xuXG4vLyBNb2NrIHRoZSBhY3R1YWwgVGhlbWVDb250ZXh0IGZpbGVcbmplc3QubW9jaygnLi4vLi4vbGlicy9zaGFyZWQtY29udGV4dHMvc3JjL2xpYi9UaGVtZUNvbnRleHQnLCAoKSA9PiAoe1xuICBUaGVtZVByb3ZpZGVyOiAoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkgPT4gY2hpbGRyZW4sXG4gIHVzZVRoZW1lOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgaXNEYXJrTW9kZTogZmFsc2UsXG4gICAgdG9nZ2xlRGFya01vZGU6IGplc3QuZm4oKSxcbiAgICBzZXREYXJrTW9kZTogamVzdC5mbigpLFxuICAgIGlzTG9hZGVkOiB0cnVlLFxuICB9KSksXG59KSk7XG5cbi8vIEFsc28gbW9jayB0aGUgcGFja2FnZSBlbnRyeSBwb2ludFxuLy8gQ3JlYXRlIGEgbW9jayBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjb25maWd1cmVkIHBlciB0ZXN0XG5jb25zdCBtb2NrVXNlQWRtaW5BdXRoRm4gPSBqZXN0LmZuKCgpID0+ICh7XG4gIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gIGlzTG9hZGluZzogZmFsc2UsXG4gIGxvZ2luOiBqZXN0LmZuKCksXG4gIGxvZ291dDogamVzdC5mbigpLFxuICB1c2VyOiBudWxsLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0BlbHphdG9uYS9zaGFyZWQtY29udGV4dHMnLCAoKSA9PiB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzXG4gIGNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcbiAgcmV0dXJuIHtcbiAgICBBZG1pbkF1dGhQcm92aWRlcjogKHsgY2hpbGRyZW4gfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0pID0+IChcbiAgICAgIDw+e2NoaWxkcmVufTwvPlxuICAgICksXG4gICAgdXNlQWRtaW5BdXRoOiBtb2NrVXNlQWRtaW5BdXRoRm4sXG4gICAgVGhlbWVQcm92aWRlcjogKHsgY2hpbGRyZW4gfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlIH0pID0+IChcbiAgICAgIDw+e2NoaWxkcmVufTwvPlxuICAgICksXG4gICAgdXNlVGhlbWU6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgIGlzRGFya01vZGU6IGZhbHNlLFxuICAgICAgdG9nZ2xlRGFya01vZGU6IGplc3QuZm4oKSxcbiAgICB9KSksXG4gIH07XG59KTtcblxuLy8gTW9jayBmZXRjaCBmb3IgQVBJIGNhbGxzXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L25hdmlnYXRpb24nO1xuaW1wb3J0IEFkbWluTG9naW5QYWdlIGZyb20gJ0AvYXBwL2FkbWluL2xvZ2luL3BhZ2UnO1xuaW1wb3J0IHsgQWRtaW5BdXRoUHJvdmlkZXIgfSBmcm9tICdAZWx6YXRvbmEvc2hhcmVkLWNvbnRleHRzJztcblxuLy8gVHlwZSBkZWZpbml0aW9ucyBmb3IgbW9ja3NcbmludGVyZmFjZSBNb2NrUm91dGVyIHtcbiAgcHVzaDogamVzdC5Nb2NrZWRGdW5jdGlvbjwodXJsOiBzdHJpbmcpID0+IHZvaWQ+O1xuICByZXBsYWNlOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPCh1cmw6IHN0cmluZykgPT4gdm9pZD47XG4gIHByZWZldGNoOiBqZXN0Lk1vY2tlZEZ1bmN0aW9uPCh1cmw6IHN0cmluZykgPT4gdm9pZD47XG4gIGJhY2s6IGplc3QuTW9ja2VkRnVuY3Rpb248KCkgPT4gdm9pZD47XG4gIGZvcndhcmQ6IGplc3QuTW9ja2VkRnVuY3Rpb248KCkgPT4gdm9pZD47XG4gIHJlZnJlc2g6IGplc3QuTW9ja2VkRnVuY3Rpb248KCkgPT4gdm9pZD47XG59XG5cbi8vIE1vY2tBZG1pbkF1dGggaW50ZXJmYWNlIHJlbW92ZWQgLSBub3QgdXNlZCBpbiB0ZXN0c1xuXG5kZXNjcmliZSgnQWRtaW4gTG9naW4gUGFnZScsICgpID0+IHtcbiAgY29uc3QgbW9ja1B1c2ggPSBqZXN0LmZuKCk7XG4gIGNvbnN0IG1vY2tVc2VSb3V0ZXIgPSB1c2VSb3V0ZXIgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgdXNlUm91dGVyPjtcbiAgY29uc3QgbW9ja0xvZ2luID0gamVzdC5mbigpO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIC8vIFJlc2V0IG1vY2sgYWRtaW4gYXV0aCBmdW5jdGlvbiB0byByZXR1cm4gZGVmYXVsdCB2YWx1ZXNcbiAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgbG9naW46IG1vY2tMb2dpbixcbiAgICAgIGxvZ291dDogamVzdC5mbigpLFxuICAgICAgdXNlcjogbnVsbCxcbiAgICB9KTtcbiAgICBtb2NrVXNlUm91dGVyLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBwdXNoOiBtb2NrUHVzaCxcbiAgICAgIHJlcGxhY2U6IGplc3QuZm4oKSxcbiAgICAgIHByZWZldGNoOiBqZXN0LmZuKCksXG4gICAgICBiYWNrOiBqZXN0LmZuKCksXG4gICAgICBmb3J3YXJkOiBqZXN0LmZuKCksXG4gICAgICByZWZyZXNoOiBqZXN0LmZuKCksXG4gICAgfSBhcyBNb2NrUm91dGVyKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LnJlc3RvcmVBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGFnZSBSZW5kZXJpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgbG9naW4gZm9ybSB3aXRoIGFsbCByZXF1aXJlZCBlbGVtZW50cycsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluQXV0aFByb3ZpZGVyPlxuICAgICAgICAgIDxBZG1pbkxvZ2luUGFnZSAvPlxuICAgICAgICA8L0FkbWluQXV0aFByb3ZpZGVyPlxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FkbWluIExvZ2luJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9zaWduIGluL2kgfSlcbiAgICAgICkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVuZGVyIGFkbWluIG5hdmJhcicsICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRtaW4gQWNjZXNzIFBvcnRhbCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlY3VyZSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IGxvYWRpbmcgc3RhdGUgd2hlbiBhdXRoZW50aWNhdGlvbiBpcyBpbiBwcm9ncmVzcycsICgpID0+IHtcbiAgICAgIG1vY2tVc2VBZG1pbkF1dGhGbi5tb2NrUmV0dXJuVmFsdWVPbmNlKHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiB0cnVlLFxuICAgICAgICBsb2dpbjogbW9ja0xvZ2luLFxuICAgICAgICBsb2dvdXQ6IGplc3QuZm4oKSxcbiAgICAgICAgdXNlcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0xvYWRpbmcuLi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVkaXJlY3QgYXV0aGVudGljYXRlZCB1c2VycyB0byBkYXNoYm9hcmQnLCAoKSA9PiB7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlT25jZSh7XG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogdHJ1ZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgbG9naW46IG1vY2tMb2dpbixcbiAgICAgICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogJzEnLFxuICAgICAgICAgIGVtYWlsOiAnYWRtaW5AZXhhbXBsZS5jb20nLFxuICAgICAgICAgIG5hbWU6ICdBZG1pbicsXG4gICAgICAgICAgcm9sZTogJ3N1cGVyX2FkbWluJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgLy8gQ29tcG9uZW50IGRvZXNuJ3QgcmVkaXJlY3QgZGlyZWN0bHkgLSBpdCByZWxpZXMgb24gQWRtaW5BdXRoUHJvdmlkZXJcbiAgICAgIC8vIEp1c3QgdmVyaWZ5IHRoZSBjb21wb25lbnQgcmVuZGVycyB3aXRob3V0IHRoZSBsb2dpbiBmb3JtXG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL2VtYWlsL2kpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Zvcm0gVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVzZSBIVE1MNSB2YWxpZGF0aW9uIGZvciBlbXB0eSBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAgIC8vIEhUTUw1IHZhbGlkYXRpb24gLSBjaGVjayByZXF1aXJlZCBhdHRyaWJ1dGVcbiAgICAgIGV4cGVjdChlbWFpbElucHV0KS50b0hhdmVBdHRyaWJ1dGUoJ3JlcXVpcmVkJyk7XG4gICAgICBleHBlY3QocGFzc3dvcmRJbnB1dCkudG9IYXZlQXR0cmlidXRlKCdyZXF1aXJlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgSFRNTDUgZW1haWwgdmFsaWRhdGlvbicsICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXG4gICAgICAvLyBIVE1MNSBlbWFpbCB2YWxpZGF0aW9uXG4gICAgICBleHBlY3QoZW1haWxJbnB1dCkudG9IYXZlQXR0cmlidXRlKCd0eXBlJywgJ2VtYWlsJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGZvcm0gaW5wdXQgY2hhbmdlcycsICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAndGVzdEBleGFtcGxlLmNvbScgfSB9KTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UocGFzc3dvcmRJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdwYXNzd29yZDEyMycgfSB9KTtcblxuICAgICAgZXhwZWN0KGVtYWlsSW5wdXQpLnRvSGF2ZVZhbHVlKCd0ZXN0QGV4YW1wbGUuY29tJyk7XG4gICAgICBleHBlY3QocGFzc3dvcmRJbnB1dCkudG9IYXZlVmFsdWUoJ3Bhc3N3b3JkMTIzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGb3JtIFN1Ym1pc3Npb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjYWxsIGxvZ2luIGZ1bmN0aW9uIHdpdGggY29ycmVjdCBjcmVkZW50aWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlT25jZSh7XG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgIGxvZ2luOiBsb2dpbk1vY2ssXG4gICAgICAgIGxvZ291dDogamVzdC5mbigpLFxuICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuICAgICAgY29uc3QgZm9ybSA9IGVtYWlsSW5wdXQuY2xvc2VzdCgnZm9ybScpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGFzc3dvcmQxMjMnIH0gfSk7XG4gICAgICBpZiAoZm9ybSkge1xuICAgICAgICBmaXJlRXZlbnQuc3VibWl0KGZvcm0pO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGxvZ2luTW9jaykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgJ2FkbWluQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAncGFzc3dvcmQxMjMnXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBsb2FkaW5nIHN0YXRlIGR1cmluZyBsb2dpbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3RcbiAgICAgICAgLmZuKClcbiAgICAgICAgLm1vY2tJbXBsZW1lbnRhdGlvbihcbiAgICAgICAgICAoKSA9PiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSlcbiAgICAgICAgKTtcbiAgICAgIG1vY2tVc2VBZG1pbkF1dGhGbi5tb2NrUmV0dXJuVmFsdWVPbmNlKHtcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgbG9naW46IGxvZ2luTW9jayxcbiAgICAgICAgbG9nb3V0OiBqZXN0LmZuKCksXG4gICAgICAgIHVzZXI6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG4gICAgICBjb25zdCBsb2dpbkJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3NpZ24gaW4vaSB9KTtcbiAgICAgIGNvbnN0IGZvcm0gPSBlbWFpbElucHV0LmNsb3Nlc3QoJ2Zvcm0nKTtcblxuICAgICAgZmlyZUV2ZW50LmNoYW5nZShlbWFpbElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ2FkbWluQGV4YW1wbGUuY29tJyB9IH0pO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShwYXNzd29yZElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ3Bhc3N3b3JkMTIzJyB9IH0pO1xuICAgICAgaWYgKGZvcm0pIHtcbiAgICAgICAgZmlyZUV2ZW50LnN1Ym1pdChmb3JtKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgbG9hZGluZyBzdGF0ZSBpbW1lZGlhdGVseSBhZnRlciBzdWJtaXNzaW9uXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NpZ25pbmcgSW4uLi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgZXhwZWN0KGxvZ2luQnV0dG9uKS50b0JlRGlzYWJsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IGVycm9yIG1lc3NhZ2Ugb24gbG9naW4gZmFpbHVyZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3RcbiAgICAgICAgLmZuKClcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBjcmVkZW50aWFscycgfSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlT25jZSh7XG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgIGxvZ2luOiBsb2dpbk1vY2ssXG4gICAgICAgIGxvZ291dDogamVzdC5mbigpLFxuICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuICAgICAgY29uc3QgZm9ybSA9IGVtYWlsSW5wdXQuY2xvc2VzdCgnZm9ybScpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnd3JvbmdwYXNzd29yZCcgfSB9KTtcbiAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgIGZpcmVFdmVudC5zdWJtaXQoZm9ybSk7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnSW52YWxpZCBjcmVkZW50aWFscycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSwgeyB0aW1lb3V0OiAzMDAwIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3QuZm4oKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlT25jZSh7XG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgIGxvZ2luOiBsb2dpbk1vY2ssXG4gICAgICAgIGxvZ291dDogamVzdC5mbigpLFxuICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuICAgICAgY29uc3QgZm9ybSA9IGVtYWlsSW5wdXQuY2xvc2VzdCgnZm9ybScpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGFzc3dvcmQxMjMnIH0gfSk7XG4gICAgICBpZiAoZm9ybSkge1xuICAgICAgICBmaXJlRXZlbnQuc3VibWl0KGZvcm0pO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KFxuICAgICAgICAgIHNjcmVlbi5nZXRCeVRleHQoJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQnKVxuICAgICAgICApLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVc2VyIEludGVyYWN0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgcGFzc3dvcmQgZmllbGQgd2l0aCBwYXNzd29yZCB0eXBlJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuXG4gICAgICBleHBlY3QocGFzc3dvcmRJbnB1dCkudG9IYXZlQXR0cmlidXRlKCd0eXBlJywgJ3Bhc3N3b3JkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1Ym1pdCBmb3JtIG9uIEVudGVyIGtleSBwcmVzcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlT25jZSh7XG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgIGxvZ2luOiBsb2dpbk1vY2ssXG4gICAgICAgIGxvZ291dDogamVzdC5mbigpLFxuICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGFzc3dvcmQxMjMnIH0gfSk7XG4gICAgICBmaXJlRXZlbnQua2V5UHJlc3MocGFzc3dvcmRJbnB1dCwgeyBrZXk6ICdFbnRlcicsIGNvZGU6ICdFbnRlcicsIGNoYXJDb2RlOiAxMyB9KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChsb2dpbk1vY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdhZG1pbkBleGFtcGxlLmNvbScsXG4gICAgICAgICAgJ3Bhc3N3b3JkMTIzJ1xuICAgICAgICApO1xuICAgICAgfSwgeyB0aW1lb3V0OiAzMDAwIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBmb3JtIGZpZWxkIGlucHV0JywgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG5cbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZW1haWxJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdhZG1pbkBleGFtcGxlLmNvbScgfSB9KTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UocGFzc3dvcmRJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdwYXNzd29yZDEyMycgfSB9KTtcblxuICAgICAgZXhwZWN0KGVtYWlsSW5wdXQpLnRvSGF2ZVZhbHVlKCdhZG1pbkBleGFtcGxlLmNvbScpO1xuICAgICAgZXhwZWN0KHBhc3N3b3JkSW5wdXQpLnRvSGF2ZVZhbHVlKCdwYXNzd29yZDEyMycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWNjZXNzaWJpbGl0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIEFSSUEgbGFiZWxzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3NpZ24gaW4vaSB9KVxuICAgICAgKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBiZSBrZXlib2FyZCBuYXZpZ2FibGUnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSk7XG4gICAgICBjb25zdCBwYXNzd29yZElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9wYXNzd29yZC9pKTtcbiAgICAgIGNvbnN0IGxvZ2luQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc2lnbiBpbi9pIH0pO1xuXG4gICAgICAvLyBDaGVjayB0aGF0IGlucHV0cyBhcmUgZm9jdXNhYmxlXG4gICAgICBlbWFpbElucHV0LmZvY3VzKCk7XG4gICAgICBleHBlY3QoZW1haWxJbnB1dCkudG9IYXZlRm9jdXMoKTtcblxuICAgICAgLy8gQ2hlY2sgdGhhdCBwYXNzd29yZCBpbnB1dCBpcyBmb2N1c2FibGVcbiAgICAgIHBhc3N3b3JkSW5wdXQuZm9jdXMoKTtcbiAgICAgIGV4cGVjdChwYXNzd29yZElucHV0KS50b0hhdmVGb2N1cygpO1xuXG4gICAgICAvLyBDaGVjayB0aGF0IGJ1dHRvbiBpcyBmb2N1c2FibGVcbiAgICAgIGxvZ2luQnV0dG9uLmZvY3VzKCk7XG4gICAgICBleHBlY3QobG9naW5CdXR0b24pLnRvSGF2ZUZvY3VzKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgZXJyb3IgbWVzc2FnZXMgd2hlbiBsb2dpbiBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxvZ2luTW9jayA9IGplc3RcbiAgICAgICAgLmZuKClcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBjcmVkZW50aWFscycgfSk7XG4gICAgICBtb2NrVXNlQWRtaW5BdXRoRm4ubW9ja1JldHVyblZhbHVlT25jZSh7XG4gICAgICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICAgIGxvZ2luOiBsb2dpbk1vY2ssXG4gICAgICAgIGxvZ291dDogamVzdC5mbigpLFxuICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8QWRtaW5Mb2dpblBhZ2UgLz4pO1xuXG4gICAgICBjb25zdCBlbWFpbElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9lbWFpbC9pKTtcbiAgICAgIGNvbnN0IHBhc3N3b3JkSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Bhc3N3b3JkL2kpO1xuICAgICAgY29uc3QgZm9ybSA9IGVtYWlsSW5wdXQuY2xvc2VzdCgnZm9ybScpO1xuXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHBhc3N3b3JkSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnd3JvbmdwYXNzd29yZCcgfSB9KTtcbiAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgIGZpcmVFdmVudC5zdWJtaXQoZm9ybSk7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnSW52YWxpZCBjcmVkZW50aWFscycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSwgeyB0aW1lb3V0OiAzMDAwIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmVzcG9uc2l2ZSBEZXNpZ24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgY29ycmVjdGx5IG9uIG1vYmlsZSB2aWV3cG9ydCcsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgbW9iaWxlIHZpZXdwb3J0XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnaW5uZXJXaWR0aCcsIHtcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IDM3NSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgLy8gQ2hlY2sgdGhhdCB0aGUgcGFnZSByZW5kZXJzIHdpdGhvdXQgZXJyb3JzXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRtaW4gTG9naW4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgY29ycmVjdGx5IG9uIGRlc2t0b3Agdmlld3BvcnQnLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGRlc2t0b3Agdmlld3BvcnRcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdpbm5lcldpZHRoJywge1xuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZTogMTAyNCxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgLy8gQ2hlY2sgdGhhdCB0aGUgcGFnZSByZW5kZXJzIHdpdGhvdXQgZXJyb3JzXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRtaW4gTG9naW4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VjdXJpdHkgRmVhdHVyZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBub3QgbG9nIHNlbnNpdGl2ZSBpbmZvcm1hdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdsb2cnKS5tb2NrSW1wbGVtZW50YXRpb24oKTtcblxuICAgICAgcmVuZGVyKDxBZG1pbkxvZ2luUGFnZSAvPik7XG5cbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2VtYWlsL2kpO1xuICAgICAgY29uc3QgcGFzc3dvcmRJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcGFzc3dvcmQvaSk7XG5cbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZW1haWxJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdhZG1pbkBleGFtcGxlLmNvbScgfSB9KTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UocGFzc3dvcmRJbnB1dCwge1xuICAgICAgICB0YXJnZXQ6IHsgdmFsdWU6ICdzZWNyZXRwYXNzd29yZDEyMycgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGVjayB0aGF0IHBhc3N3b3JkIGlzIG5vdCBsb2dnZWRcbiAgICAgIGV4cGVjdChjb25zb2xlU3B5KS5ub3QudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdzZWNyZXRwYXNzd29yZDEyMycpXG4gICAgICApO1xuXG4gICAgICBjb25zb2xlU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgWFNTIGF0dGFja3MgaW4gZm9ybSBpbnB1dHMnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFkbWluTG9naW5QYWdlIC8+KTtcblxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZW1haWwvaSk7XG4gICAgICBjb25zdCBtYWxpY2lvdXNJbnB1dCA9ICc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+JztcblxuICAgICAgZmlyZUV2ZW50LmNoYW5nZShlbWFpbElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogbWFsaWNpb3VzSW5wdXQgfSB9KTtcblxuICAgICAgLy8gVGhlIGlucHV0IHNob3VsZCBiZSBzYW5pdGl6ZWQgYW5kIG5vdCBleGVjdXRlIHRoZSBzY3JpcHRcbiAgICAgIGV4cGVjdChlbWFpbElucHV0KS50b0hhdmVWYWx1ZShtYWxpY2lvdXNJbnB1dCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KCd4c3MnKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJjcmVhdGVDbGllbnQiLCJmbiIsImZyb20iLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsIm1vY2tSZXNvbHZlZFZhbHVlIiwiZGF0YSIsImVycm9yIiwiYXV0aCIsIm9uQXV0aFN0YXRlQ2hhbmdlIiwic3Vic2NyaXB0aW9uIiwiZ2V0U2Vzc2lvbiIsInNlc3Npb24iLCJnZXRVc2VyIiwidXNlciIsInVzZVF1ZXJ5U3RhdGUiLCJ1c2VRdWVyeVN0YXRlcyIsInBhcnNlQXNTdHJpbmciLCJwYXJzZUFzSW50ZWdlciIsImNyZWF0ZVNlYXJjaFBhcmFtc0NhY2hlIiwiUmVhY3QiLCJyZXF1aXJlIiwiUXVlcnlDbGllbnRQcm92aWRlciIsImNoaWxkcmVuIiwiUXVlcnlDbGllbnQiLCJpbnZhbGlkYXRlUXVlcmllcyIsInNldFF1ZXJ5RGF0YSIsImdldFF1ZXJ5RGF0YSIsInVzZVF1ZXJ5Q2xpZW50IiwidXNlUXVlcnkiLCJpc0xvYWRpbmciLCJ1c2VNdXRhdGlvbiIsIm11dGF0ZSIsIm11dGF0ZUFzeW5jIiwidXNlUm91dGVyIiwidXNlUGF0aG5hbWUiLCJtb2NrRm4iLCJpc0F1dGhlbnRpY2F0ZWQiLCJsb2dpbiIsImxvZ291dCIsIkFkbWluQXV0aFByb3ZpZGVyIiwidXNlQWRtaW5BdXRoIiwiVGhlbWVQcm92aWRlciIsInVzZVRoZW1lIiwiaXNEYXJrTW9kZSIsInRvZ2dsZURhcmtNb2RlIiwic2V0RGFya01vZGUiLCJpc0xvYWRlZCIsIm1vY2tVc2VBZG1pbkF1dGhGbiIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJnbG9iYWwiLCJmZXRjaCIsImRlc2NyaWJlIiwibW9ja1B1c2giLCJtb2NrVXNlUm91dGVyIiwibW9ja0xvZ2luIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmV0dXJuVmFsdWUiLCJwdXNoIiwicmVwbGFjZSIsInByZWZldGNoIiwiYmFjayIsImZvcndhcmQiLCJyZWZyZXNoIiwiYWZ0ZXJFYWNoIiwicmVzdG9yZUFsbE1vY2tzIiwiaXQiLCJyZW5kZXIiLCJBZG1pbkxvZ2luUGFnZSIsImV4cGVjdCIsInNjcmVlbiIsImdldEJ5VGV4dCIsInRvQmVJblRoZURvY3VtZW50IiwiZ2V0QnlMYWJlbFRleHQiLCJnZXRCeVJvbGUiLCJuYW1lIiwibW9ja1JldHVyblZhbHVlT25jZSIsImlkIiwiZW1haWwiLCJyb2xlIiwicXVlcnlCeUxhYmVsVGV4dCIsIm5vdCIsImVtYWlsSW5wdXQiLCJwYXNzd29yZElucHV0IiwidG9IYXZlQXR0cmlidXRlIiwiZmlyZUV2ZW50IiwiY2hhbmdlIiwidGFyZ2V0IiwidmFsdWUiLCJ0b0hhdmVWYWx1ZSIsImxvZ2luTW9jayIsInN1Y2Nlc3MiLCJmb3JtIiwiY2xvc2VzdCIsInN1Ym1pdCIsIndhaXRGb3IiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImxvZ2luQnV0dG9uIiwidG9CZURpc2FibGVkIiwidGltZW91dCIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJrZXlQcmVzcyIsImtleSIsImNvZGUiLCJjaGFyQ29kZSIsImZvY3VzIiwidG9IYXZlRm9jdXMiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsIndpbmRvdyIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwiY29uc29sZVNweSIsInNweU9uIiwiY29uc29sZSIsInN0cmluZ0NvbnRhaW5pbmciLCJtb2NrUmVzdG9yZSIsIm1hbGljaW91c0lucHV0IiwicXVlcnlCeVRleHQiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Q0FTQyxHQUVELGtEQUFrRDs7QUFLbEQsK0NBQStDO0FBQy9DQSxLQUFLQyxJQUFJLENBQUMseUJBQXlCLElBQU8sQ0FBQTtRQUN4Q0MsY0FBY0YsS0FBS0csRUFBRSxDQUFDLElBQU8sQ0FBQTtnQkFDM0JDLE1B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