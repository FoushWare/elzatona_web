{"version":3,"sources":["/Users/a.fouad/SideProjects/Elzatona-all/Elzatona-web/libs/shared-hooks/src/lib/useSectorProgress.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\n\nexport interface SectorProgress {\n  sectorId: string;\n  pathId: string;\n  isCompleted: boolean;\n  score: number;\n  completedAt: string;\n  timeSpent: number; // in minutes\n}\n\ninterface UseSectorProgressReturn {\n  progress: Record<string, SectorProgress>;\n  getSectorProgress: (sectorId: string) => SectorProgress | null;\n  getPathProgress: (pathId: string) => SectorProgress[];\n  saveProgress: (progress: SectorProgress) => void;\n  clearProgress: () => void;\n}\n\nconst STORAGE_KEY = 'sector-progress';\n\nexport function useSectorProgress(): UseSectorProgressReturn {\n  const [progress, setProgress] = useState<Record<string, SectorProgress>>({});\n\n  // Load progress from localStorage on mount\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem(STORAGE_KEY);\n      if (stored) {\n        const parsedProgress = JSON.parse(stored);\n        setProgress(parsedProgress);\n      }\n    } catch (error) {\n      console.error('Failed to load sector progress from localStorage:', error);\n      setProgress({});\n    }\n  }, []);\n\n  const getSectorProgress = useCallback(\n    (sectorId: string): SectorProgress | null => {\n      return progress[sectorId] || null;\n    },\n    [progress]\n  );\n\n  const getPathProgress = useCallback(\n    (pathId: string): SectorProgress[] => {\n      return Object.values(progress).filter(p => p.pathId === pathId);\n    },\n    [progress]\n  );\n\n  const saveProgress = useCallback((newProgress: SectorProgress) => {\n    try {\n      setProgress(prev => {\n        const updatedProgress = {\n          ...prev,\n          [newProgress.sectorId]: newProgress,\n        };\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedProgress));\n        return updatedProgress;\n      });\n    } catch (error) {\n      console.error('Failed to save sector progress to localStorage:', error);\n    }\n  }, []);\n\n  const clearProgress = useCallback(() => {\n    try {\n      setProgress({});\n      localStorage.removeItem(STORAGE_KEY);\n    } catch (error) {\n      console.error(\n        'Failed to clear sector progress from localStorage:',\n        error\n      );\n    }\n  }, []);\n\n  return {\n    progress,\n    getSectorProgress,\n    getPathProgress,\n    saveProgress,\n    clearProgress,\n  };\n}\n"],"names":["useSectorProgress","STORAGE_KEY","progress","setProgress","useState","useEffect","stored","localStorage","getItem","parsedProgress","JSON","parse","error","console","getSectorProgress","useCallback","sectorId","getPathProgress","pathId","Object","values","filter","p","saveProgress","newProgress","prev","updatedProgress","setItem","stringify","clearProgress","removeItem"],"mappings":"AAAA;;;;;+BAuBgBA;;;eAAAA;;;uBArBiC;AAmBjD,MAAMC,cAAc;AAEb,SAASD;IACd,MAAM,CAACE,UAAUC,YAAY,GAAGC,IAAAA,eAAQ,EAAiC,CAAC;IAE1E,2CAA2C;IAC3CC,IAAAA,gBAAS,EAAC;QACR,IAAI;YACF,MAAMC,SAASC,aAAaC,OAAO,CAACP;YACpC,IAAIK,QAAQ;gBACV,MAAMG,iBAAiBC,KAAKC,KAAK,CAACL;gBAClCH,YAAYM;YACd;QACF,EAAE,OAAOG,OAAO;YACdC,QAAQD,KAAK,CAAC,qDAAqDA;YACnET,YAAY,CAAC;QACf;IACF,GAAG,EAAE;IAEL,MAAMW,oBAAoBC,IAAAA,kBAAW,EACnC,CAACC;QACC,OAAOd,QAAQ,CAACc,SAAS,IAAI;IAC/B,GACA;QAACd;KAAS;IAGZ,MAAMe,kBAAkBF,IAAAA,kBAAW,EACjC,CAACG;QACC,OAAOC,OAAOC,MAAM,CAAClB,UAAUmB,MAAM,CAACC,CAAAA,IAAKA,EAAEJ,MAAM,KAAKA;IAC1D,GACA;QAAChB;KAAS;IAGZ,MAAMqB,eAAeR,IAAAA,kBAAW,EAAC,CAACS;QAChC,IAAI;YACFrB,YAAYsB,CAAAA;gBACV,MAAMC,kBAAkB;oBACtB,GAAGD,IAAI;oBACP,CAACD,YAAYR,QAAQ,CAAC,EAAEQ;gBAC1B;gBACAjB,aAAaoB,OAAO,CAAC1B,aAAaS,KAAKkB,SAAS,CAACF;gBACjD,OAAOA;YACT;QACF,EAAE,OAAOd,OAAO;YACdC,QAAQD,KAAK,CAAC,mDAAmDA;QACnE;IACF,GAAG,EAAE;IAEL,MAAMiB,gBAAgBd,IAAAA,kBAAW,EAAC;QAChC,IAAI;YACFZ,YAAY,CAAC;YACbI,aAAauB,UAAU,CAAC7B;QAC1B,EAAE,OAAOW,OAAO;YACdC,QAAQD,KAAK,CACX,sDACAA;QAEJ;IACF,GAAG,EAAE;IAEL,OAAO;QACLV;QACAY;QACAG;QACAM;QACAM;IACF;AACF"}