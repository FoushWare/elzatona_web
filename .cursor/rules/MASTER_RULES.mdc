---
description: MASTER RULES - Single source of truth for all development rules with STRICT enforcement. MUST be reviewed before ANY code changes.
globs: **/*
alwaysApply: true
priority: 1
---

# üö® MASTER RULES - MANDATORY PRE-ACTION CHECKLIST

**‚ö†Ô∏è CRITICAL: Review this file BEFORE making ANY code changes, commits, or modifications.**

This is the single source of truth combining all cursor rules with STRICT enforcement. All rules are MANDATORY unless explicitly overridden by the user.

---

## üìã MANDATORY PRE-ACTION CHECKLIST

**Before ANY code modification, you MUST:**

- [ ] **Security Check:** Verify no secrets will be hardcoded (use `process.env` only)
- [ ] **Test Plan:** Identify all affected test files (unit, integration, E2E, snapshot)
- [ ] **Quality Gate:** Ensure code meets quality standards (linting, type safety)
- [ ] **Documentation:** Check if markdown files are needed (only if explicitly requested)
- [ ] **Import Verification:** Verify all imports use correct paths (@elzatona/components, @elzatona/hooks, etc.)

**If ANY checklist item fails, STOP and fix before proceeding.**

---

## üîí SECURITY RULES (STRICT - NON-NEGOTIABLE)

### **Secret Management - MANDATORY**

- ‚ùå **NEVER:** Hardcode API keys, tokens, passwords, or any secrets in code
- ‚úÖ **ALWAYS:** Use environment variables (`process.env.VARIABLE_NAME`)
- ‚úÖ **ALWAYS:** Add secrets to `.env.local` (never commit this file)
- ‚úÖ **ALWAYS:** Use `.env.example` for documentation (with placeholders only)

**Violation = BLOCKED ACTION. Fix immediately before proceeding.**

### **Secret Detection**

- ‚úÖ Pre-push hook automatically scans for secrets
- ‚úÖ GitHub automatically scans all commits
- ‚úÖ **NEVER skip secret scanning** unless known false positive
- ‚úÖ **If secrets found:** Fix immediately, don't push

### **Git Hooks - MANDATORY**

- ‚ùå **NEVER:** Use `--no-verify` to skip hooks
- ‚ùå **NEVER:** Use `SKIP_SECRET_SCAN=true` unless emergency
- ‚úÖ **ALWAYS:** Let hooks run - they protect the repository
- ‚úÖ **ALWAYS:** Fix issues before pushing

**Reference:** [security.mdc](mdc:.cursor/rules/security.mdc) for complete security pipeline details.

---

## ‚úÖ QUALITY RULES (STRICT - MANDATORY)

### **Test Updates - MANDATORY CHECKLIST**

**EVERY code change (feature, bug fix, refactor) REQUIRES:**

1. **Identify affected test files**
   - Unit tests (`*.test.tsx`, `*.test.ts`)
   - Integration tests (`*.integration.test.tsx`)
   - E2E tests (`*.spec.ts`, `*.spec.tsx`)
   - Snapshot tests (`__snapshots__/*.snap`)

2. **Update Unit Tests**
   - Update existing tests if component/function changed
   - Add new tests for new functionality
   - Remove/update obsolete tests
   - Verify: `npm run test:unit`

3. **Update Integration Tests**
   - Update if API/flow changed
   - Add new tests for new flows
   - Verify: `npm run test:integration`

4. **Update E2E Tests**
   - Update if user flow changed
   - Add new tests for new user flows
   - Verify: `npm run test:e2e`

5. **Update Snapshot Tests** ‚ö†Ô∏è **REQUIRED FOR UI CHANGES**
   - Update if UI/structure changed: `npm run test:unit -- --updateSnapshot`
   - Review snapshot changes carefully
   - Add new snapshots for new components/pages
   - Verify: `npm run test:unit`

6. **Final Verification**
   - Run ALL tests: `npm run test:unit && npm run test:integration && npm run test:e2e`
   - All tests pass ‚úÖ
   - All snapshots up to date ‚úÖ

**Violation = INCOMPLETE WORK. Complete test updates before marking done.**

**Reference:** [testing-automatic-updates.mdc](mdc:.cursor/rules/testing-automatic-updates.mdc) for complete testing guidelines.

---

## üìù CODE STANDARDS (STRICT ENFORCEMENT)

### **Development Principles**

- ‚úÖ **Provide incremental improvements** rather than massive rewrites
- ‚úÖ **Use modular, single-responsibility functions**
- ‚úÖ **Add helpful comments & logs** (with emojis where useful)
- ‚úÖ **Ensure clear variable names** and readable code
- ‚úÖ **Always provide loading/progress states** for UX
- ‚úÖ **Implement graceful error handling**
- ‚úÖ **Ensure responsive and accessible design**

### **React Development**

- ‚úÖ **Use functional components** with hooks
- ‚úÖ **Implement proper error boundaries**
- ‚úÖ **Follow React best practices** and patterns
- ‚úÖ **Ensure proper cleanup** in useEffect hooks

### **TypeScript Standards**

- ‚úÖ **No `any` types** without explicit `eslint-disable` and justification
- ‚úÖ **Proper type definitions** for all interfaces and types
- ‚úÖ **Exhaustive dependencies** in useEffect hooks (or explicit disable with reason)
- ‚úÖ **No unused variables** (or explicit disable with reason)

**Reference:** [cursor_rules.mdc](mdc:.cursor/rules/cursor_rules.mdc) and [enhanced_cursor_rules.mdc](mdc:.cursor/rules/enhanced_cursor_rules.mdc) for complete code standards.

---

## üìö DOCUMENTATION RULES

### **Markdown File Creation - STRICT**

- ‚ùå **NEVER:** Create markdown files automatically
- ‚ùå **NEVER:** Create documentation files during code changes
- ‚ùå **NEVER:** Generate README files, guides, or docs without explicit instruction
- ‚úÖ **ONLY:** Create markdown files when user explicitly requests
- ‚úÖ **USE:** `Markdown/` directory for any necessary documentation
- ‚úÖ **REFERENCE:** Existing documentation in `Markdown/` instead of creating new

**Exception:** Cursor rule files (`.cursor/rules/*.mdc`) can be created when explicitly requested.

**Reference:** [no-markdown-creation.mdc](mdc:.cursor/rules/no-markdown-creation.mdc) for complete guidelines.

---

## üîÑ DEVELOPMENT WORKFLOW

### **Version Control**

- ‚úÖ **Use clear version numbering** in code comments (`// v1.1`)
- ‚úÖ **Document changes between versions**
- ‚úÖ **Maintain backward compatibility** when possible
- ‚úÖ **Track feature additions** and modifications
- ‚úÖ **Document breaking changes** clearly

### **Context Management**

- ‚úÖ **If reaching 70‚Äì80% of context limit:** Auto-generate summary artifact
- ‚úÖ **Maintain clear project status** throughout development
- ‚úÖ **Document architectural decisions** and their rationale
- ‚úÖ **Create handoff notes** for future developers

### **Task Management**

- ‚úÖ **Use Taskmaster** for project management when appropriate
- ‚úÖ **Follow task workflow** from [dev_workflow.mdc](mdc:.cursor/rules/taskmaster/dev_workflow.mdc)
- ‚úÖ **Update task status** as work progresses
- ‚úÖ **Break down complex tasks** into manageable subtasks

**Reference:** [taskmaster/dev_workflow.mdc](mdc:.cursor/rules/taskmaster/dev_workflow.mdc) for complete workflow.

---

## üèóÔ∏è PROJECT STRUCTURE RULES

### **Import Paths - MANDATORY**

**Use correct import paths (after refactoring):**

- ‚úÖ `@elzatona/components` (not `@elzatona/shared-components`)
- ‚úÖ `@elzatona/hooks` (not `@elzatona/shared-hooks`)
- ‚úÖ `@elzatona/types` (not `@elzatona/shared-types`)
- ‚úÖ `@elzatona/contexts` (not `@elzatona/shared-contexts`)
- ‚úÖ `@elzatona/utilities` (not `@elzatona/utils`)

### **File Organization**

- ‚úÖ **Apps:** `apps/website/`, `apps/admin/`
  - `pages/` - Page components
  - `components/` - App-specific components
  - `network/routes/` - API routes
  - `network/data/` - Mock/seed data
  - `utilities/` - App-specific utilities

- ‚úÖ **Libs:** `libs/components/`, `libs/hooks/`, `libs/types/`, `libs/contexts/`, `libs/utilities/`
  - Shared code across apps
  - Scripts in `libs/utilities/scripts/`

- ‚úÖ **Tests:** Next to components/files they test
  - `Component.tsx` ‚Üí `Component.test.tsx` (same directory)

- ‚úÖ **Documentation:** `Markdown/` directory (root level)

---

## üö´ PROHIBITED ACTIONS

### **NEVER Do These (Unless Explicitly Overridden):**

1. ‚ùå Hardcode secrets in code
2. ‚ùå Skip test updates for code changes
3. ‚ùå Create markdown files automatically
4. ‚ùå Use `any` types without justification
5. ‚ùå Skip git hooks (`--no-verify`)
6. ‚ùå Push code with failing tests
7. ‚ùå Push code with linting errors
8. ‚ùå Push code with type errors
9. ‚ùå Create files in wrong directories
10. ‚ùå Use old import paths (shared-components, shared-hooks, etc.)

---

## ‚úÖ REQUIRED ACTIONS

### **ALWAYS Do These:**

1. ‚úÖ Review this MASTER_RULES file before code changes
2. ‚úÖ Complete security checklist (no secrets)
3. ‚úÖ Complete test update checklist
4. ‚úÖ Verify all tests pass before committing
5. ‚úÖ Verify linting passes before committing
6. ‚úÖ Verify type checking passes before committing
7. ‚úÖ Use correct import paths
8. ‚úÖ Follow code standards
9. ‚úÖ Update tests when code changes
10. ‚úÖ Ask user before creating markdown files

---

## üìñ REFERENCE RULES

For detailed information, refer to specific rule files:

- **Security:** [security.mdc](mdc:.cursor/rules/security.mdc)
- **Testing:** [testing-automatic-updates.mdc](mdc:.cursor/rules/testing-automatic-updates.mdc)
- **Code Standards:** [cursor_rules.mdc](mdc:.cursor/rules/cursor_rules.mdc), [enhanced_cursor_rules.mdc](mdc:.cursor/rules/enhanced_cursor_rules.mdc)
- **Documentation:** [no-markdown-creation.mdc](mdc:.cursor/rules/no-markdown-creation.mdc)
- **Workflow:** [taskmaster/dev_workflow.mdc](mdc:.cursor/rules/taskmaster/dev_workflow.mdc)
- **Self-Improvement:** [self_improve.mdc](mdc:.cursor/rules/self_improve.mdc)

---

## üéØ ENFORCEMENT LEVEL

- **Security Rules:** MANDATORY - violations block actions
- **Quality Rules:** MANDATORY - test updates required
- **Code Standards:** STRICT - no exceptions without explicit approval
- **Documentation Rules:** STRICT - no automatic creation
- **Workflow Rules:** Best practices - follow when applicable

**Agent MUST review this file before any code modification.**

---

**Remember:** When in doubt, refer to this MASTER_RULES file. It is the single source of truth for all development rules.
